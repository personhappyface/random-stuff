!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=i(1),o=n(r),s=i(65),a=n(s);window._PCWidget=o.default,a.default.start()},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=i(4),a=(r(s),i(3)),l=(r(a),i(53)),c=(r(l),i(54)),u=n(c),h=i(63),d=n(h),p=i(55),g=r(p),f=i(100),m=r(f),v=function(t){t.pureServerUrl=t.pureServerUrl||"https://www.purechat.com";var e,i={test:!1,widgetId:t.widgetId||t.c,connectionSettings:t,isWidget:t.isWidget||t.f,isOperator:void 0!=t.d&&t.d,pureServerUrl:t.pureServerUrl,renderInto:(0,o.$)("body")};window._pcDisableAvailabilityPings=t.DisableAvailabilityPings||t.IPIsBanned,e=i.test?new u.TestDataController(i):new u.PCDataController(o.$.extend(t,i));var n=!1,r="";if("undefined"!=typeof Prototype)try{var s=Prototype.Version.split(/\./g);s.length>0&&(n=!(parseInt(s[0])>=2)&&!(parseInt(s[1])>=7))}catch(t){r=t}n&&(r="PureChat widgets are not compatible with Prototype.js versions < 1.7. Default widget behavior will popout into a new window"),r.length>0&&"undefined"!=typeof console&&null!==console&&console.log(r);var a={test:!1,pureServerUrl:t.pureServerUrl,widgetId:t.widgetId||t.c,isWidget:t.isWidget||t.f,isOperator:void 0!=t.d&&t.d,renderInto:(0,o.$)("body"),dataController:e,usePrototypeFallback:n};a=o.$.extend(t,a);var l=new d.PureChatController(new g.default.WidgetSettings(a));return new m.default({settings:l.options}),l};e.default=v},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.$=e.backbone=void 0;var r=i(3),o=n(r);i(6);var s=i(7),a=(n(s),window.location.hostname),l=/purechat\.(com|me)$/.test(a)?window.pc$||window.$:window.pc$,c=o.default.noConflict();window.JSON3.noConflict(),e.backbone=c,e.$=l},function(t,e,i){var n,r;(function(o){!function(s){var a="object"==typeof self&&self.self===self&&self||"object"==typeof o&&o.global===o&&o;n=[i(4),i(5),e],r=function(t,e,i){a.Backbone=s(a,i,t,e)}.apply(e,n),!(void 0!==r&&(t.exports=r))}(function(t,e,i,n){var r=t.Backbone,o=Array.prototype.slice;e.VERSION="1.3.3",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,n){switch(t){case 1:return function(){return i[e](this[n])};case 2:return function(t){return i[e](this[n],t)};case 3:return function(t,r){return i[e](this[n],l(t,this),r)};case 4:return function(t,r,o){return i[e](this[n],l(t,this),r,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[n]),i[e].apply(i,t)}}},a=function(t,e,n){i.each(e,function(e,r){i[r]&&(t.prototype[r]=s(e,r,n))})},l=function(t,e){return i.isFunction(t)?t:i.isObject(t)&&!e._isModel(t)?c(t):i.isString(t)?function(e){return e.get(t)}:t},c=function(t){var e=i.matches(t);return function(t){return e(t.attributes)}},u=e.Events={},h=/\s+/,d=function(t,e,n,r,o){var s,a=0;if(n&&"object"==typeof n){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=i.keys(n);a<s.length;a++)e=d(t,e,s[a],n[s[a]],o)}else if(n&&h.test(n))for(s=n.split(h);a<s.length;a++)e=t(e,s[a],r,o);else e=t(e,n,r,o);return e};u.on=function(t,e,i){return p(this,t,e,i)};var p=function(t,e,i,n,r){if(t._events=d(g,t._events||{},e,i,{context:n,ctx:t,listening:r}),r){var o=t._listeners||(t._listeners={});o[r.id]=r}return t};u.listenTo=function(t,e,n){if(!t)return this;var r=t._listenId||(t._listenId=i.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=i.uniqueId("l"));s=o[r]={obj:t,objId:r,id:a,listeningTo:o,count:0}}return p(t,e,n,this,s),this};var g=function(t,e,i,n){if(i){var r=t[e]||(t[e]=[]),o=n.context,s=n.ctx,a=n.listening;a&&a.count++,r.push({callback:i,context:o,ctx:o||s,listening:a})}return t};u.off=function(t,e,i){return this._events?(this._events=d(f,this._events,t,e,{context:i,listeners:this._listeners}),this):this},u.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:i.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(e,n,this)}return this};var f=function(t,e,n,r){if(t){var o,s=0,a=r.context,l=r.listeners;if(e||n||a){for(var c=e?[e]:i.keys(t);s<c.length;s++){e=c[s];var u=t[e];if(!u)break;for(var h=[],d=0;d<u.length;d++){var p=u[d];n&&n!==p.callback&&n!==p.callback._callback||a&&a!==p.context?h.push(p):(o=p.listening,o&&0===--o.count&&(delete l[o.id],delete o.listeningTo[o.objId]))}h.length?t[e]=h:delete t[e]}return t}for(var g=i.keys(l);s<g.length;s++)o=l[g[s]],delete l[o.id],delete o.listeningTo[o.objId]}};u.once=function(t,e,n){var r=d(m,{},t,e,i.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(r,e,n)},u.listenToOnce=function(t,e,n){var r=d(m,{},e,n,i.bind(this.stopListening,this,t));return this.listenTo(t,r)};var m=function(t,e,n,r){if(n){var o=t[e]=i.once(function(){r(e,o),n.apply(this,arguments)});o._callback=n}return t};u.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),i=Array(e),n=0;n<e;n++)i[n]=arguments[n+1];return d(v,this._events,t,void 0,i),this};var v=function(t,e,i,n){if(t){var r=t[e],o=t.all;r&&o&&(o=o.slice()),r&&b(r,n),o&&b(o,[e].concat(n))}return t},b=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}};u.bind=u.on,u.unbind=u.off,i.extend(e,u);var y=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=i.result(this,"defaults");n=i.defaults(i.extend({},r,n),r),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(y.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!i.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var r;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;var o=n.unset,s=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in r)e=r[d],i.isEqual(c[d],e)||a.push(d),i.isEqual(h[d],e)?delete u[d]:u[d]=e,o?delete c[d]:c[d]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=n);for(var p=0;p<a.length;p++)this.trigger("change:"+a[p],this,c[a[p]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&i.clone(this.changed);var e=this._changing?this._previousAttributes:this.attributes,n={};for(var r in t){var o=t[r];i.isEqual(e[r],o)||(n[r]=o)}return!!i.size(n)&&n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=i.extend({parse:!0},t);var e=this,n=t.success;return t.success=function(i){var r=t.parse?e.parse(i,t):i;return!!e.set(r,t)&&(n&&n.call(t.context,e,i,t),void e.trigger("sync",e,i,t))},F(this,t),this.sync("read",this,t)},save:function(t,e,n){var r;null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0,parse:!0},n);var o=n.wait;if(r&&!o){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;var s=this,a=n.success,l=this.attributes;n.success=function(t){s.attributes=l;var e=n.parse?s.parse(t,n):t;return o&&(e=i.extend({},r,e)),!(e&&!s.set(e,n))&&(a&&a.call(n.context,s,t,n),void s.trigger("sync",s,t,n))},F(this,n),r&&o&&(this.attributes=i.extend({},l,r));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=r);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(i){r&&o(),n&&n.call(t.context,e,i,t),e.isNew()||e.trigger("sync",e,i,t)};var s=!1;return this.isNew()?i.defer(t.success):(F(this,t),s=this.sync("delete",this,t)),r||o(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||W();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1)}});var _={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(y,_,"attributes");var w=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},C={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},k=function(t,e,i){i=Math.min(Math.max(i,0),t.length);var n,r=Array(t.length-i),o=e.length;for(n=0;n<r.length;n++)r[n]=t[n+i];for(n=0;n<o;n++)t[n+i]=e[n];for(n=0;n<r.length;n++)t[n+o+i]=r[n]};i.extend(w.prototype,u,{model:y,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,x))},remove:function(t,e){e=i.extend({},e);var n=!i.isArray(t);t=n?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),n?r[0]:r},set:function(t,e){if(null!=t){e=i.extend({},C,e),e.parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!i.isArray(t);t=n?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var o,s,a=[],l=[],c=[],u=[],h={},d=e.add,p=e.merge,g=e.remove,f=!1,m=this.comparator&&null==r&&e.sort!==!1,v=i.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){o=t[s];var b=this.get(o);if(b){if(p&&o!==b){var y=this._isModel(o)?o.attributes:o;e.parse&&(y=b.parse(y,e)),b.set(y,e),c.push(b),m&&!f&&(f=b.hasChanged(v))}h[b.cid]||(h[b.cid]=!0,a.push(b)),t[s]=b}else d&&(o=t[s]=this._prepareModel(o,e),o&&(l.push(o),this._addReference(o,e),h[o.cid]=!0,a.push(o)))}if(g){for(s=0;s<this.length;s++)o=this.models[s],h[o.cid]||u.push(o);u.length&&this._removeModels(u,e)}var _=!1,w=!m&&d&&g;if(a.length&&w?(_=this.length!==a.length||i.some(this.models,function(t,e){return t!==a[e]}),this.models.length=0,k(this.models,a,0),this.length=this.models.length):l.length&&(m&&(f=!0),k(this.models,l,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!e.silent){for(s=0;s<l.length;s++)null!=r&&(e.index=r+s),o=l[s],o.trigger("add",o,this,e);(f||_)&&this.trigger("sort",this,e),(l.length||u.length||c.length)&&(e.changes={added:l,removed:u,merged:c},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?i.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return i.isFunction(e)&&(e=i.bind(e,this)),1===n||i.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=i.extend({parse:!0},t);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e.call(t.context,n,i,t),n.trigger("sync",n,i,t)},F(this,t),this.sync("read",this,t)},create:function(t,e){e=e?i.clone(e):{};var n=e.wait;if(t=this._prepareModel(t,e),!t)return!1;n||this.add(t,e);var r=this,o=e.success;return e.success=function(t,e,i){n&&r.add(t,i),o&&o.call(i.context,t,e,i)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var i=[],n=0;n<t.length;n++){var r=this.get(t[n]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,r.trigger("remove",r,this,e)),i.push(r),this._removeReference(r,e)}}return i},_isModel:function(t){return t instanceof y},_addReference:function(t,e){this._byId[t.cid]=t;var i=this.modelId(t.attributes);null!=i&&(this._byId[i]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var i=this.modelId(t.attributes);null!=i&&delete this._byId[i],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if(e){if(("add"===t||"remove"===t)&&i!==this)return;if("destroy"===t&&this.remove(e,n),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}});var M={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};a(w,M,"models");var S=e.View=function(t){this.cid=i.uniqueId("view"),i.extend(this,i.pick(t,A)),this._ensureElement(),this.initialize.apply(this,arguments)},I=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];i.extend(S.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=i.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[n]),n){var r=e.match(I);this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(t,e,i){return this.$el.on(t+".delegateEvents"+this.cid,e,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,i){return this.$el.off(t+".delegateEvents"+this.cid,e,i),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,n,r){var o=T[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=i.result(n,"url")||W()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var l=r.error;r.error=function(t,e,i){r.textStatus=e,r.errorThrown=i,l&&l.call(r.context,t,e,i)};var c=r.xhr=e.ajax(i.extend(s,r));return n.trigger("request",n,c,r),c};var T={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var E=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},R=/\((.*?)\)/g,P=/(\(\?)?:\w+/g,N=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(E.prototype,u,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return e.history.route(t,function(i){var s=o._extractParameters(t,i);o.execute(r,s,n)!==!1&&(o.trigger.apply(o,["route:"+n].concat(s)),o.trigger("route",n,s),e.history.trigger("route",o,n,s))}),this},execute:function(t,e,i){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(D,"\\$&").replace(R,"(?:$1)?").replace(P,function(t,e){return e?t:"([^/?]+)"}).replace(N,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var j=e.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,B=/^\/+|\/+$/g,U=/#.*$/;j.started=!1,i.extend(j.prototype,u,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(O,"")},start:function(t){if(j.started)throw new Error("Backbone.history has already been started");if(j.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(B,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,r=n.insertBefore(this.iframe,n.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e!==this.fragment&&(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),i.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!j.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var i=this.root;""!==t&&"?"!==t.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+t;if(t=this.decodeFragment(t.replace(U,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new j;var V=function(t,e){var n,r=this;return n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e),n.prototype=i.create(r.prototype,t),n.prototype.constructor=n,n.__super__=r.prototype,n};y.extend=w.extend=E.extend=S.extend=j.extend=V;var W=function(){throw new Error('A "url" property or function must be specified')},F=function(t,e){var i=e.error;e.error=function(n){i&&i.call(e.context,t,n,e),t.trigger("error",t,n,e)}};return e})}).call(e,function(){return this}())},function(t,e,i){var n,r;(function(){function i(t){function e(e,i,n,r,o,s){for(;o>=0&&o<s;o+=t){var a=r?r[o]:o;n=i(n,e[a],a,e)}return n}return function(i,n,r,o){n=x(n,o,4);var s=!E(i)&&C.keys(i),a=(s||i).length,l=t>0?0:a-1;return arguments.length<3&&(r=i[s?s[l]:l],l+=t),e(i,n,r,s,l,a)}}function o(t){return function(e,i,n){i=k(i,n);for(var r=T(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(i(e[o],o,e))return o;return-1}}function s(t,e,i){return function(n,r,o){var s=0,a=T(n);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(i&&o&&a)return o=i(n,r),n[o]===r?o:-1;if(r!==r)return o=e(g.call(n,s,a),C.isNaN),o>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(n[o]===r)return o;return-1}}function a(t,e){var i=j.length,n=t.constructor,r=C.isFunction(n)&&n.prototype||h,o="constructor";for(C.has(t,o)&&!C.contains(e,o)&&e.push(o);i--;)o=j[i],o in t&&t[o]!==r[o]&&!C.contains(e,o)&&e.push(o)}var l=this,c=l._,u=Array.prototype,h=Object.prototype,d=Function.prototype,p=u.push,g=u.slice,f=h.toString,m=h.hasOwnProperty,v=Array.isArray,b=Object.keys,y=d.bind,_=Object.create,w=function(){},C=function(t){return t instanceof C?t:this instanceof C?void(this._wrapped=t):new C(t)};"undefined"!=typeof t&&t.exports&&(e=t.exports=C),e._=C,C.VERSION="1.8.3";var x=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,o){return t.call(e,i,n,r,o)}}return function(){return t.apply(e,arguments)}},k=function(t,e,i){return null==t?C.identity:C.isFunction(t)?x(t,e,i):C.isObject(t)?C.matcher(t):C.property(t)};C.iteratee=function(t,e){return k(t,e,1/0)};var M=function(t,e){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var r=1;r<n;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;l<a;l++){var c=s[l];e&&void 0!==i[c]||(i[c]=o[c])}return i}},S=function(t){if(!C.isObject(t))return{};if(_)return _(t);w.prototype=t;var e=new w;return w.prototype=null,e},I=function(t){return function(e){return null==e?void 0:e[t]}},A=Math.pow(2,53)-1,T=I("length"),E=function(t){var e=T(t);return"number"==typeof e&&e>=0&&e<=A};C.each=C.forEach=function(t,e,i){e=x(e,i);var n,r;if(E(t))for(n=0,r=t.length;n<r;n++)e(t[n],n,t);else{var o=C.keys(t);for(n=0,r=o.length;n<r;n++)e(t[o[n]],o[n],t)}return t},C.map=C.collect=function(t,e,i){e=k(e,i);for(var n=!E(t)&&C.keys(t),r=(n||t).length,o=Array(r),s=0;s<r;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o},C.reduce=C.foldl=C.inject=i(1),C.reduceRight=C.foldr=i(-1),C.find=C.detect=function(t,e,i){var n;if(n=E(t)?C.findIndex(t,e,i):C.findKey(t,e,i),void 0!==n&&n!==-1)return t[n]},C.filter=C.select=function(t,e,i){var n=[];return e=k(e,i),C.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},C.reject=function(t,e,i){return C.filter(t,C.negate(k(e)),i)},C.every=C.all=function(t,e,i){e=k(e,i);for(var n=!E(t)&&C.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0},C.some=C.any=function(t,e,i){e=k(e,i);for(var n=!E(t)&&C.keys(t),r=(n||t).length,o=0;o<r;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1},C.contains=C.includes=C.include=function(t,e,i,n){return E(t)||(t=C.values(t)),("number"!=typeof i||n)&&(i=0),C.indexOf(t,e,i)>=0},C.invoke=function(t,e){var i=g.call(arguments,2),n=C.isFunction(e);return C.map(t,function(t){var r=n?e:t[e];return null==r?r:r.apply(t,i)})},C.pluck=function(t,e){return C.map(t,C.property(e))},C.where=function(t,e){return C.filter(t,C.matcher(e))},C.findWhere=function(t,e){return C.find(t,C.matcher(e))},C.max=function(t,e,i){var n,r,o=-(1/0),s=-(1/0);if(null==e&&null!=t){t=E(t)?t:C.values(t);for(var a=0,l=t.length;a<l;a++)n=t[a],n>o&&(o=n)}else e=k(e,i),C.each(t,function(t,i,n){r=e(t,i,n),(r>s||r===-(1/0)&&o===-(1/0))&&(o=t,s=r)});return o},C.min=function(t,e,i){var n,r,o=1/0,s=1/0;if(null==e&&null!=t){t=E(t)?t:C.values(t);for(var a=0,l=t.length;a<l;a++)n=t[a],n<o&&(o=n)}else e=k(e,i),C.each(t,function(t,i,n){r=e(t,i,n),(r<s||r===1/0&&o===1/0)&&(o=t,s=r)});return o},C.shuffle=function(t){for(var e,i=E(t)?t:C.values(t),n=i.length,r=Array(n),o=0;o<n;o++)e=C.random(0,o),e!==o&&(r[o]=r[e]),r[e]=i[o];return r},C.sample=function(t,e,i){return null==e||i?(E(t)||(t=C.values(t)),t[C.random(t.length-1)]):C.shuffle(t).slice(0,Math.max(0,e))},C.sortBy=function(t,e,i){return e=k(e,i),C.pluck(C.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var R=function(t){return function(e,i,n){var r={};return i=k(i,n),C.each(e,function(n,o){var s=i(n,o,e);t(r,n,s)}),r}};C.groupBy=R(function(t,e,i){C.has(t,i)?t[i].push(e):t[i]=[e]}),C.indexBy=R(function(t,e,i){t[i]=e}),C.countBy=R(function(t,e,i){C.has(t,i)?t[i]++:t[i]=1}),C.toArray=function(t){return t?C.isArray(t)?g.call(t):E(t)?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:E(t)?t.length:C.keys(t).length},C.partition=function(t,e,i){e=k(e,i);var n=[],r=[];return C.each(t,function(t,i,o){(e(t,i,o)?n:r).push(t)}),[n,r]},C.first=C.head=C.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:C.initial(t,t.length-e)},C.initial=function(t,e,i){return g.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},C.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:C.rest(t,Math.max(0,t.length-e))},C.rest=C.tail=C.drop=function(t,e,i){return g.call(t,null==e||i?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var P=function(t,e,i,n){for(var r=[],o=0,s=n||0,a=T(t);s<a;s++){var l=t[s];if(E(l)&&(C.isArray(l)||C.isArguments(l))){e||(l=P(l,e,i));var c=0,u=l.length;for(r.length+=u;c<u;)r[o++]=l[c++]}else i||(r[o++]=l)}return r};C.flatten=function(t,e){return P(t,e,!1)},C.without=function(t){return C.difference(t,g.call(arguments,1))},C.uniq=C.unique=function(t,e,i,n){C.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=k(i,n));for(var r=[],o=[],s=0,a=T(t);s<a;s++){var l=t[s],c=i?i(l,s,t):l;e?(s&&o===c||r.push(l),o=c):i?C.contains(o,c)||(o.push(c),r.push(l)):C.contains(r,l)||r.push(l)}return r},C.union=function(){return C.uniq(P(arguments,!0,!0))},C.intersection=function(t){for(var e=[],i=arguments.length,n=0,r=T(t);n<r;n++){var o=t[n];if(!C.contains(e,o)){for(var s=1;s<i&&C.contains(arguments[s],o);s++);s===i&&e.push(o)}}return e},C.difference=function(t){var e=P(arguments,!0,!0,1);return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){return C.unzip(arguments)},C.unzip=function(t){for(var e=t&&C.max(t,T).length||0,i=Array(e),n=0;n<e;n++)i[n]=C.pluck(t,n);return i},C.object=function(t,e){for(var i={},n=0,r=T(t);n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},C.findIndex=o(1),C.findLastIndex=o(-1),C.sortedIndex=function(t,e,i,n){i=k(i,n,1);for(var r=i(e),o=0,s=T(t);o<s;){var a=Math.floor((o+s)/2);i(t[a])<r?o=a+1:s=a}return o},C.indexOf=s(1,C.findIndex,C.sortedIndex),C.lastIndexOf=s(-1,C.findLastIndex),C.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),o=0;o<n;o++,t+=i)r[o]=t;return r};var N=function(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var o=S(t.prototype),s=t.apply(o,r);return C.isObject(s)?s:o};C.bind=function(t,e){if(y&&t.bind===y)return y.apply(t,g.call(arguments,1));if(!C.isFunction(t))throw new TypeError("Bind must be called on a function");var i=g.call(arguments,2),n=function(){return N(t,n,e,this,i.concat(g.call(arguments)));
};return n},C.partial=function(t){var e=g.call(arguments,1),i=function(){for(var n=0,r=e.length,o=Array(r),s=0;s<r;s++)o[s]=e[s]===C?arguments[n++]:e[s];for(;n<arguments.length;)o.push(arguments[n++]);return N(t,i,this,this,o)};return i},C.bindAll=function(t){var e,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(e=1;e<n;e++)i=arguments[e],t[i]=C.bind(t[i],t);return t},C.memoize=function(t,e){var i=function(n){var r=i.cache,o=""+(e?e.apply(this,arguments):n);return C.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return i.cache={},i},C.delay=function(t,e){var i=g.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},C.defer=C.partial(C.delay,C,1),C.throttle=function(t,e,i){var n,r,o,s=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:C.now(),s=null,o=t.apply(n,r),s||(n=r=null)};return function(){var c=C.now();a||i.leading!==!1||(a=c);var u=e-(c-a);return n=this,r=arguments,u<=0||u>e?(s&&(clearTimeout(s),s=null),a=c,o=t.apply(n,r),s||(n=r=null)):s||i.trailing===!1||(s=setTimeout(l,u)),o}},C.debounce=function(t,e,i){var n,r,o,s,a,l=function(){var c=C.now()-s;c<e&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(o,r),n||(o=r=null)))};return function(){o=this,r=arguments,s=C.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(o,r),o=r=null),a}},C.wrap=function(t,e){return C.partial(e,t)},C.negate=function(t){return function(){return!t.apply(this,arguments)}},C.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},C.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},C.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},C.once=C.partial(C.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),j=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];C.keys=function(t){if(!C.isObject(t))return[];if(b)return b(t);var e=[];for(var i in t)C.has(t,i)&&e.push(i);return D&&a(t,e),e},C.allKeys=function(t){if(!C.isObject(t))return[];var e=[];for(var i in t)e.push(i);return D&&a(t,e),e},C.values=function(t){for(var e=C.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=t[e[r]];return n},C.mapObject=function(t,e,i){e=k(e,i);for(var n,r=C.keys(t),o=r.length,s={},a=0;a<o;a++)n=r[a],s[n]=e(t[n],n,t);return s},C.pairs=function(t){for(var e=C.keys(t),i=e.length,n=Array(i),r=0;r<i;r++)n[r]=[e[r],t[e[r]]];return n},C.invert=function(t){for(var e={},i=C.keys(t),n=0,r=i.length;n<r;n++)e[t[i[n]]]=i[n];return e},C.functions=C.methods=function(t){var e=[];for(var i in t)C.isFunction(t[i])&&e.push(i);return e.sort()},C.extend=M(C.allKeys),C.extendOwn=C.assign=M(C.keys),C.findKey=function(t,e,i){e=k(e,i);for(var n,r=C.keys(t),o=0,s=r.length;o<s;o++)if(n=r[o],e(t[n],n,t))return n},C.pick=function(t,e,i){var n,r,o={},s=t;if(null==s)return o;C.isFunction(e)?(r=C.allKeys(s),n=x(e,i)):(r=P(arguments,!1,!1,1),n=function(t,e,i){return e in i},s=Object(s));for(var a=0,l=r.length;a<l;a++){var c=r[a],u=s[c];n(u,c,s)&&(o[c]=u)}return o},C.omit=function(t,e,i){if(C.isFunction(e))e=C.negate(e);else{var n=C.map(P(arguments,!1,!1,1),String);e=function(t,e){return!C.contains(n,e)}}return C.pick(t,e,i)},C.defaults=M(C.allKeys,!0),C.create=function(t,e){var i=S(t);return e&&C.extendOwn(i,e),i},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t},C.isMatch=function(t,e){var i=C.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),o=0;o<n;o++){var s=i[o];if(e[s]!==r[s]||!(s in r))return!1}return!0};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var r=f.call(t);if(r!==f.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(C.isFunction(s)&&s instanceof s&&C.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),o){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!O(t[l],e[l],i,n))return!1}else{var c,u=C.keys(t);if(l=u.length,C.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!C.has(e,c)||!O(t[c],e[c],i,n))return!1}return i.pop(),n.pop(),!0};C.isEqual=function(t,e){return O(t,e)},C.isEmpty=function(t){return null==t||(E(t)&&(C.isArray(t)||C.isString(t)||C.isArguments(t))?0===t.length:0===C.keys(t).length)},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=v||function(t){return"[object Array]"===f.call(t)},C.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},C.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){C["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return C.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(C.isFunction=function(t){return"function"==typeof t||!1}),C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!==+t},C.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return null!=t&&m.call(t,e)},C.noConflict=function(){return l._=c,this},C.identity=function(t){return t},C.constant=function(t){return function(){return t}},C.noop=function(){},C.property=I,C.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},C.matcher=C.matches=function(t){return t=C.extendOwn({},t),function(e){return C.isMatch(e,t)}},C.times=function(t,e,i){var n=Array(Math.max(0,t));e=x(e,i,1);for(var r=0;r<t;r++)n[r]=e(r);return n},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},C.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},U=C.invert(B),V=function(t){var e=function(e){return t[e]},i="(?:"+C.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}};C.escape=V(B),C.unescape=V(U),C.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),C.isFunction(n)?n.call(t):n};var W=0;C.uniqueId=function(t){var e=++W+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\u2028|\u2029/g,z=function(t){return"\\"+$[t]};C.template=function(t,e,i){!e&&i&&(e=i),e=C.defaults({},e,C.templateSettings);var n=RegExp([(e.escape||F).source,(e.interpolate||F).source,(e.evaluate||F).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(n,function(e,i,n,s,a){return o+=t.slice(r,a).replace(L,z),r=a+e.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return s.call(this,t,C)},l=e.variable||"obj";return a.source="function("+l+"){\n"+o+"}",a},C.chain=function(t){var e=C(t);return e._chain=!0,e};var H=function(t,e){return t._chain?C(e).chain():e};C.mixin=function(t){C.each(C.functions(t),function(e){var i=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return p.apply(t,arguments),H(this,i.apply(C,t))}})},C.mixin(C),C.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];C.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],H(this,i)}}),C.each(["concat","join","slice"],function(t){var e=u[t];C.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),C.prototype.value=function(){return this._wrapped},C.prototype.valueOf=C.prototype.toJSON=C.prototype.value,C.prototype.toString=function(){return""+this._wrapped},n=[],r=function(){return C}.apply(e,n),!(void 0!==r&&(t.exports=r))}).call(this)},function(t,e){t.exports=pc$},function(t,e,i){var n,r,o;!function(s,a){r=[e,i(3),i(4)],n=a,o="function"==typeof n?n.apply(e,r):n,!(void 0!==o&&(t.exports=o))}(this,function(t,e,i){"use strict";e.Relational={showWarnings:!0},e.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(t){if(this._permitsUsed>t)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=t}},e.BlockingQueue=function(){this._queue=[]},i.extend(e.BlockingQueue.prototype,e.Semaphore,{_queue:null,add:function(t){this.isBlocked()?this._queue.push(t):t()},process:function(){var t=this._queue;for(this._queue=[];t&&t.length;)t.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),e.Relational.eventQueue=new e.BlockingQueue,e.Store=function(){this._collections=[],this._reverseRelations=[],this._orphanRelations=[],this._subModels=[],this._modelScopes=[t]},i.extend(e.Store.prototype,e.Events,{initializeRelation:function(t,n,r){var o=i.isString(n.type)?e[n.type]||this.getObjectByName(n.type):n.type;if(o&&o.prototype instanceof e.Relation){new o(t,n,r)}else e.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; missing or invalid relation type!",n)},addModelScope:function(t){this._modelScopes.push(t)},removeModelScope:function(t){this._modelScopes=i.without(this._modelScopes,t)},addSubModels:function(t,e){this._subModels.push({superModelType:e,subModels:t})},setupSuperModel:function(t){i.find(this._subModels,function(e){return i.filter(e.subModels||[],function(i,n){var r=this.getObjectByName(i);if(t===r)return e.superModelType._subModels[n]=t,t._superModel=e.superModelType,t._subModelTypeValue=n,t._subModelTypeAttribute=e.superModelType.prototype.subModelTypeAttribute,!0},this).length},this)},addReverseRelation:function(t){var e=i.any(this._reverseRelations,function(e){return i.all(t||[],function(t,i){return t===e[i]})});!e&&t.model&&t.type&&(this._reverseRelations.push(t),this._addRelation(t.model,t),this.retroFitRelation(t))},addOrphanRelation:function(t){var e=i.any(this._orphanRelations,function(e){return i.all(t||[],function(t,i){return t===e[i]})});!e&&t.model&&t.type&&this._orphanRelations.push(t)},processOrphanRelations:function(){i.each(this._orphanRelations.slice(0),function(t){var n=e.Relational.store.getObjectByName(t.relatedModel);n&&(this.initializeRelation(null,t),this._orphanRelations=i.without(this._orphanRelations,t))},this)},_addRelation:function(t,e){t.prototype.relations||(t.prototype.relations=[]),t.prototype.relations.push(e),i.each(t._subModels||[],function(t){this._addRelation(t,e)},this)},retroFitRelation:function(t){var e=this.getCollection(t.model,!1);e&&e.each(function(e){if(e instanceof t.model){new t.type(e,t)}},this)},getCollection:function(t,n){t instanceof e.RelationalModel&&(t=t.constructor);for(var r=t;r._superModel;)r=r._superModel;var o=i.find(this._collections,function(t){return t.model===r});return o||n===!1||(o=this._createCollection(r)),o},getObjectByName:function(t){var e=t.split("."),n=null;return i.find(this._modelScopes,function(t){if(n=i.reduce(e||[],function(t,e){return t?t[e]:void 0},t),n&&n!==t)return!0},this),n},_createCollection:function(t){var i;return t instanceof e.RelationalModel&&(t=t.constructor),t.prototype instanceof e.RelationalModel&&(i=new e.Collection,i.model=t,this._collections.push(i)),i},resolveIdForItem:function(t,n){var r=i.isString(n)||i.isNumber(n)?n:null;return null===r&&(n instanceof e.RelationalModel?r=n.id:i.isObject(n)&&(r=n[t.prototype.idAttribute])),r||0===r||(r=null),r},find:function(t,e){var i=this.resolveIdForItem(t,e),n=this.getCollection(t);if(n){var r=n.get(i);if(r instanceof t)return r}return null},register:function(t){var e=this.getCollection(t);if(e){var i=t.collection;e.add(t),t.collection=i}},checkId:function(t,i){var n=this.getCollection(t),r=n&&n.get(i);if(r&&t!==r)throw e.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",r,t),new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")},update:function(t){var e=this.getCollection(t);e.contains(t)||this.register(t),e._onModelEvent("change:"+t.idAttribute,t,e),t.trigger("relational:change:id",t,e)},unregister:function(t){var n,r;t instanceof e.Model?(n=this.getCollection(t),r=[t]):t instanceof e.Collection?(n=this.getCollection(t.model),r=i.clone(t.models)):(n=this.getCollection(t),r=i.clone(n.models)),i.each(r,function(t){this.stopListening(t),i.invoke(t.getRelations(),"stopListening")},this),i.contains(this._collections,t)?n.reset([]):i.each(r,function(t){n.get(t)?n.remove(t):n.trigger("relational:remove",t,n)},this)},reset:function(){this.stopListening(),i.each(this._collections,function(t){this.unregister(t)},this),this._collections=[],this._subModels=[],this._modelScopes=[t]}}),e.Relational.store=new e.Store,e.Relation=function(t,n,r){if(this.instance=t,n=i.isObject(n)?n:{},this.reverseRelation=i.defaults(n.reverseRelation||{},this.options.reverseRelation),this.options=i.defaults(n,this.options,e.Relation.prototype.options),this.reverseRelation.type=i.isString(this.reverseRelation.type)?e[this.reverseRelation.type]||e.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.model=this.options.model||this.instance.constructor,this.relatedModel=this.options.relatedModel,i.isUndefined(this.relatedModel)&&(this.relatedModel=this.model),!i.isFunction(this.relatedModel)||this.relatedModel.prototype instanceof e.RelationalModel||(this.relatedModel=i.result(this,"relatedModel")),i.isString(this.relatedModel)&&(this.relatedModel=e.Relational.store.getObjectByName(this.relatedModel)),this.checkPreconditions()&&(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&e.Relational.store.addReverseRelation(i.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),t)){var o=this.keySource;o!==this.key&&i.isObject(this.instance.get(this.key))&&(o=this.key),this.setKeyContents(this.instance.get(o)),this.relatedCollection=e.Relational.store.getCollection(this.relatedModel),this.keySource!==this.key&&delete this.instance.attributes[this.keySource],this.instance._relations[this.key]=this,this.initialize(r),this.options.autoFetch&&this.instance.getAsync(this.key,i.isObject(this.options.autoFetch)?this.options.autoFetch:{}),this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}},e.Relation.extend=e.Model.extend,i.extend(e.Relation.prototype,e.Events,e.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1,autoFetch:!1,parse:!1},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var t=this.instance,n=this.key,r=this.model,o=this.relatedModel,s=e.Relational.showWarnings&&"undefined"!=typeof console;if(!r||!n||!o)return s&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,r,n,o),!1;if(!(r.prototype instanceof e.RelationalModel))return s&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,t),!1;if(!(o.prototype instanceof e.RelationalModel))return s&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,o),!1;if(this instanceof e.HasMany&&this.reverseRelation.type===e.HasMany)return s&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(t&&i.keys(t._relations).length){var a=i.find(t._relations,function(t){return t.key===n},this);if(a)return s&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,n,t,a),!1}return!0},setRelated:function(t){this.related=t,this.instance.attributes[this.key]=t},_isReverseRelation:function(t){return t.instance instanceof this.relatedModel&&this.reverseRelation.key===t.key&&this.key===t.reverseRelation.key},getReverseRelations:function(t){for(var e=[],n=i.isUndefined(t)?this.related&&(this.related.models||[this.related]):[t],r=null,o=null,s=0;s<(n||[]).length;s++){r=n[s].getRelations()||[];for(var a=0;a<r.length;a++)o=r[a],this._isReverseRelation(o)&&e.push(o)}return e},destroy:function(){this.stopListening(),this instanceof e.HasOne?this.setRelated(null):this instanceof e.HasMany&&this.setRelated(this._prepareCollection()),i.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance)},this)}}),e.HasOne=e.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(t){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var e=this.findRelated(t);this.setRelated(e),i.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,t)},this)},findRelated:function(t){var e=null;if(t=i.defaults({parse:this.options.parse},t),this.keyContents instanceof this.relatedModel)e=this.keyContents;else if(this.keyContents||0===this.keyContents){var n=i.defaults({create:this.options.createModels},t);e=this.relatedModel.findOrCreate(this.keyContents,n)}return e&&(this.keyId=null),e},setKeyContents:function(t){this.keyContents=t,this.keyId=e.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(t,n,r){if(!this.isLocked()){this.acquire(),r=r?i.clone(r):{};var o=i.isUndefined(r.__related),s=o?this.related:r.__related;if(o){this.setKeyContents(n);var a=this.findRelated(r);this.setRelated(a)}if(s&&this.related!==s&&i.each(this.getReverseRelations(s),function(t){t.removeRelated(this.instance,null,r)},this),i.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,r)},this),!r.silent&&this.related!==s){var l=this;this.changed=!0,e.Relational.eventQueue.add(function(){l.instance.trigger("change:"+l.key,l.instance,l.related,r,!0),l.changed=!1})}this.release()}},tryAddRelated:function(t,e,i){!this.keyId&&0!==this.keyId||t.id!==this.keyId||(this.addRelated(t,i),this.keyId=null)},addRelated:function(t,e){var n=this;t.queue(function(){if(t!==n.related){var r=n.related||null;n.setRelated(t),n.onChange(n.instance,t,i.defaults({__related:r},e))}})},removeRelated:function(t,e,n){if(this.related&&t===this.related){var r=this.related||null;this.setRelated(null),this.onChange(this.instance,t,i.defaults({__related:r},n))}}}),e.HasMany=e.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:e.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(t){if(this.listenTo(this.instance,"relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,!i.isFunction(this.collectionType)||this.collectionType===e.Collection||this.collectionType.prototype instanceof e.Collection||(this.collectionType=i.result(this,"collectionType")),i.isString(this.collectionType)&&(this.collectionType=e.Relational.store.getObjectByName(this.collectionType)),this.collectionType!==e.Collection&&!(this.collectionType.prototype instanceof e.Collection))throw new Error("`collectionType` must inherit from Backbone.Collection");var n=this.findRelated(t);this.setRelated(n)},_prepareCollection:function(t){if(this.related&&this.stopListening(this.related),!(t&&t instanceof e.Collection)){var n=i.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;t=new this.collectionType(null,n)}if(t.model=this.relatedModel,this.options.collectionKey){var r=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;t[r]&&t[r]!==this.instance?e.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,r,this.options.collectionKey):r&&(t[r]=this.instance)}return this.listenTo(t,"relational:add",this.handleAddition).listenTo(t,"relational:remove",this.handleRemoval).listenTo(t,"relational:reset",this.handleReset),t},findRelated:function(t){var n=null;if(t=i.defaults({parse:this.options.parse},t),this.keyContents instanceof e.Collection)this._prepareCollection(this.keyContents),n=this.keyContents;else{var r=[];i.each(this.keyContents,function(e){var n=null;n=e instanceof this.relatedModel?e:i.isObject(e)&&t.parse&&this.relatedModel.prototype.parse?this.relatedModel.prototype.parse(i.clone(e),t):e,n&&r.push(n)},this),n=this.related instanceof e.Collection?this.related:this._prepareCollection(),n.set(r,i.defaults({parse:!1},t))}return this.keyIds=i.difference(this.keyIds,i.pluck(n.models,"id")),n},setKeyContents:function(t){this.keyContents=t instanceof e.Collection?t:null,this.keyIds=[],this.keyContents||!t&&0!==t||(this.keyContents=i.isArray(t)?t:[t],i.each(this.keyContents,function(t){var i=e.Relational.store.resolveIdForItem(this.relatedModel,t);(i||0===i)&&this.keyIds.push(i)},this))},onChange:function(t,n,r){r=r?i.clone(r):{},this.setKeyContents(n),this.changed=!1;var o=this.findRelated(r);if(this.setRelated(o),!r.silent){var s=this;e.Relational.eventQueue.add(function(){s.changed&&(s.instance.trigger("change:"+s.key,s.instance,s.related,r,!0),s.changed=!1)})}},handleAddition:function(t,n,r){r=r?i.clone(r):{},this.changed=!0,i.each(this.getReverseRelations(t),function(t){t.addRelated(this.instance,r)},this);var o=this;!r.silent&&e.Relational.eventQueue.add(function(){o.instance.trigger("add:"+o.key,t,o.related,r)})},handleRemoval:function(t,n,r){r=r?i.clone(r):{},this.changed=!0,i.each(this.getReverseRelations(t),function(t){t.removeRelated(this.instance,null,r)},this);var o=this;!r.silent&&e.Relational.eventQueue.add(function(){o.instance.trigger("remove:"+o.key,t,o.related,r)})},handleReset:function(t,n){var r=this;n=n?i.clone(n):{},!n.silent&&e.Relational.eventQueue.add(function(){r.instance.trigger("reset:"+r.key,r.related,n)})},tryAddRelated:function(t,e,n){var r=i.contains(this.keyIds,t.id);r&&(this.addRelated(t,n),this.keyIds=i.without(this.keyIds,t.id))},addRelated:function(t,e){var n=this;t.queue(function(){n.related&&!n.related.get(t)&&n.related.add(t,i.defaults({parse:!1},e))})},removeRelated:function(t,e,i){this.related.get(t)&&this.related.remove(t,i)}}),e.RelationalModel=e.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,_attributeChangeFired:!1,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(t,n){if(n&&n.collection){var r=this,o=this.collection=n.collection;delete n.collection,this._deferProcessing=!0;var s=function(t){t===r&&(r._deferProcessing=!1,r.processQueue(),o.off("relational:add",s))};o.on("relational:add",s),i.defer(function(){s(r)})}e.Relational.store.processOrphanRelations(),e.Relational.store.listenTo(this,"relational:unregister",e.Relational.store.unregister),this._queue=new e.BlockingQueue,this._queue.block(),e.Relational.eventQueue.block();try{e.Model.apply(this,arguments)}finally{e.Relational.eventQueue.unblock()}},trigger:function(t){if(t.length>5&&0===t.indexOf("change")){var i=this,n=arguments;e.Relational.eventQueue.isBlocked()?e.Relational.eventQueue.add(function(){var r=!0;if("change"===t)r=i.hasChanged()||i._attributeChangeFired,i._attributeChangeFired=!1;else{var o=t.slice(7),s=i.getRelation(o);s?(r=n[4]===!0,r?i.changed[o]=n[2]:s.changed||delete i.changed[o]):r&&(i._attributeChangeFired=!0)}r&&e.Model.prototype.trigger.apply(i,n)}):e.Model.prototype.trigger.apply(i,n)}else"destroy"===t?(e.Model.prototype.trigger.apply(this,arguments),e.Relational.store.unregister(this)):e.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(t){this.acquire(),this._relations={},i.each(this.relations||[],function(i){e.Relational.store.initializeRelation(this,i,t)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(t,e){this._isInitialized&&!this.isLocked()&&i.each(this._relations,function(i){if(!t||i.keySource in t||i.key in t){var n=this.attributes[i.keySource]||this.attributes[i.key],r=t&&(t[i.keySource]||t[i.key]);(i.related!==n||null===n&&null===r)&&this.trigger("relational:change:"+i.key,this,n,e||{})}i.keySource!==i.key&&delete this.attributes[i.keySource]},this)},queue:function(t){this._queue.add(t)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(t){return this._relations[t]},getRelations:function(){return i.values(this._relations)},getIdsToFetch:function(t,n){var r=t instanceof e.Relation?t:this.getRelation(t),o=r?r.keyIds&&r.keyIds.slice(0)||(r.keyId||0===r.keyId?[r.keyId]:[]):[];if(n){var s=r.related&&(r.related.models||[r.related]);i.each(s,function(t){(t.id||0===t.id)&&o.push(t.id)})}return o},getAsync:function(t,n){n=i.extend({add:!0,remove:!1,refresh:!1},n);var r=this,o=[],s=this.getRelation(t),a=s&&this.getIdsToFetch(s,n.refresh),l=s.related instanceof e.Collection?s.related:s.relatedCollection;if(a&&a.length){var c,u=[],h=[],d=function(){u=i.map(a,function(t){var e=s.relatedModel.findModel(t);if(!e){var i={};i[s.relatedModel.prototype.idAttribute]=t,e=s.relatedModel.findOrCreate(i,n),h.push(e)}return e},this)};if(l instanceof e.Collection&&i.isFunction(l.url)){var p=l.url();c=l.url(a),c===p&&(d(),c=l.url(u),c===p&&(c=null))}if(c){var g=i.defaults({error:function(){i.each(h,function(t){t.trigger("destroy",t,t.collection,n)}),n.error&&n.error.apply(u,arguments)},url:c},n);o=[l.fetch(g)]}else u.length||d(),o=i.map(u,function(t){var e=i.defaults({error:function(){i.contains(h,t)&&t.trigger("destroy",t,t.collection,n),n.error&&n.error.apply(u,arguments)}},n);return t.fetch(e)},this)}return this.deferArray(o).then(function(){return e.Model.prototype.get.call(r,t)})},deferArray:function(t){return e.$.when.apply(null,t)},set:function(t,n,r){e.Relational.eventQueue.block();var o,s;i.isObject(t)||null==t?(o=t,r=n):(o={},o[t]=n);try{var a=this.id,l=o&&this.idAttribute in o&&o[this.idAttribute];e.Relational.store.checkId(this,l),s=e.Model.prototype.set.apply(this,arguments),this._isInitialized||this.isLocked()?l&&l!==a&&e.Relational.store.update(this):(this.constructor.initializeModelHierarchy(),(l||0===l)&&e.Relational.store.register(this),this.initializeRelations(r)),o&&this.updateRelations(o,r)}finally{e.Relational.eventQueue.unblock()}return s},clone:function(){var t=i.clone(this.attributes);return i.isUndefined(t[this.idAttribute])||(t[this.idAttribute]=null),i.each(this.getRelations(),function(e){delete t[e.key]}),new this.constructor(t)},toJSON:function(t){if(this.isLocked())return this.id;this.acquire();var n=e.Model.prototype.toJSON.call(this,t);return!this.constructor._superModel||this.constructor._subModelTypeAttribute in n||(n[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),i.each(this._relations,function(r){var o=n[r.key],s=r.options.includeInJSON,a=null;s===!0?o&&i.isFunction(o.toJSON)&&(a=o.toJSON(t)):i.isString(s)?(o instanceof e.Collection?a=o.pluck(s):o instanceof e.Model&&(a=o.get(s)),s===r.relatedModel.prototype.idAttribute&&(r instanceof e.HasMany?a=a.concat(r.keyIds):r instanceof e.HasOne&&(a=a||r.keyId,a||i.isObject(r.keyContents)||(a=r.keyContents||null)))):i.isArray(s)?o instanceof e.Collection?(a=[],o.each(function(t){var e={};i.each(s,function(i){e[i]=t.get(i)}),a.push(e)})):o instanceof e.Model&&(a={},i.each(s,function(t){a[t]=o.get(t)})):delete n[r.key],null===a&&t&&t.wait&&(a=o),s&&(n[r.keyDestination]=a),r.keyDestination!==r.key&&delete n[r.key]}),this.release(),n}},{setup:function(t){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?e.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,i.each(this.prototype.relations||[],function(t){if(t.model||(t.model=this),t.reverseRelation&&t.model===this){var n=!0;if(i.isString(t.relatedModel)){var r=e.Relational.store.getObjectByName(t.relatedModel);n=r&&r.prototype instanceof e.RelationalModel}n?e.Relational.store.initializeRelation(null,t):i.isString(t.relatedModel)&&e.Relational.store.addOrphanRelation(t)}},this),this},build:function(t,e){this.initializeModelHierarchy();var i=this._findSubModelType(this,t)||this;return new i(t,e)},_findSubModelType:function(t,e){if(t._subModels&&t.prototype.subModelTypeAttribute in e){var i=e[t.prototype.subModelTypeAttribute],n=t._subModels[i];if(n)return n;for(i in t._subModels)if(n=this._findSubModelType(t._subModels[i],e))return n}return null},initializeModelHierarchy:function(){if(this.inheritRelations(),this.prototype.subModelTypes){var t=i.keys(this._subModels),n=i.omit(this.prototype.subModelTypes,t);i.each(n,function(t){var i=e.Relational.store.getObjectByName(t);i&&i.initializeModelHierarchy()})}},inheritRelations:function(){if(i.isUndefined(this._superModel)||i.isNull(this._superModel))if(e.Relational.store.setupSuperModel(this),this._superModel){if(this._superModel.inheritRelations(),this._superModel.prototype.relations){var t=i.filter(this._superModel.prototype.relations||[],function(t){return!i.any(this.prototype.relations||[],function(e){return t.relatedModel===e.relatedModel&&t.key===e.key},this)},this);this.prototype.relations=t.concat(this.prototype.relations)}}else this._superModel=!1},findOrCreate:function(t,e){e||(e={});var n=i.isObject(t)&&e.parse&&this.prototype.parse?this.prototype.parse(i.clone(t),e):t,r=this.findModel(n);return i.isObject(t)&&(r&&e.merge!==!1?(delete e.collection,delete e.url,r.set(n,e)):r||e.create===!1||(r=this.build(n,i.defaults({parse:!1},e)))),r},find:function(t,e){return e||(e={}),e.create=!1,this.findOrCreate(t,e)},findModel:function(t){return e.Relational.store.find(this,t)}}),i.extend(e.RelationalModel.prototype,e.Semaphore),e.Collection.prototype.__prepareModel=e.Collection.prototype._prepareModel,e.Collection.prototype._prepareModel=function(t,n){var r;return t instanceof e.Model?(t.collection||(t.collection=this),r=t):(n=n?i.clone(n):{},n.collection=this,r="undefined"!=typeof this.model.findOrCreate?this.model.findOrCreate(t,n):new this.model(t,n),r&&r.validationError&&(this.trigger("invalid",this,t,n),r=!1)),r};var n=e.Collection.prototype.__set=e.Collection.prototype.set;e.Collection.prototype.set=function(t,r){if(!(this.model.prototype instanceof e.RelationalModel))return n.call(this,t,r);r&&r.parse&&(t=this.parse(t,r));var o=!i.isArray(t),s=[],a=[],l=null;t=o?t?[t]:[]:i.clone(t);for(var c=0;c<t.length;c++)l=t[c],l instanceof e.Model||(l=e.Collection.prototype._prepareModel.call(this,l,r)),l&&(a.push(l),this.get(l)||this.get(l.cid)?null!==l.id&&void 0!==l.id&&(this._byId[l.id]=l):s.push(l));a=o?a.length?a[0]:null:a;
var u=n.call(this,a,i.defaults({merge:!1,parse:!1},r));for(c=0;c<s.length;c++)l=s[c],(this.get(l)||this.get(l.cid))&&this.trigger("relational:add",l,this,r);return u};var r=e.Collection.prototype.___removeModels=e.Collection.prototype._removeModels;e.Collection.prototype._removeModels=function(t,n){if(!(this.model.prototype instanceof e.RelationalModel))return r.call(this,t,n);var o=[];i.each(t,function(t){t=this.get(t)||t&&this.get(t.cid),t&&o.push(t)},this);var s=r.call(this,o,n);return i.each(o,function(t){this.trigger("relational:remove",t,this,n)},this),s};var o=e.Collection.prototype.__reset=e.Collection.prototype.reset;e.Collection.prototype.reset=function(t,n){n=i.extend({merge:!0},n);var r=o.call(this,t,n);return this.model.prototype instanceof e.RelationalModel&&this.trigger("relational:reset",this,n),r};var s=e.Collection.prototype.__sort=e.Collection.prototype.sort;e.Collection.prototype.sort=function(t){var i=s.call(this,t);return this.model.prototype instanceof e.RelationalModel&&this.trigger("relational:reset",this,t),i};var a=e.Collection.prototype.__trigger=e.Collection.prototype.trigger;e.Collection.prototype.trigger=function(t){if(!(this.model.prototype instanceof e.RelationalModel))return a.apply(this,arguments);if("add"===t||"remove"===t||"reset"===t||"sort"===t){var n=this,r=arguments;i.isObject(r[3])&&(r=i.toArray(r),r[3]=i.clone(r[3])),e.Relational.eventQueue.add(function(){a.apply(n,r)})}else a.apply(this,arguments);return this},e.RelationalModel.extend=function(t,i){var n=e.Model.extend.call(this,t,i);return n.setup(this),n}})},function(t,e,i){function n(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n=o(t),s=n.source,u=n.id,h=n.path,d=c[u]&&h in c[u].nsps,p=e.forceNew||e["force new connection"]||!1===e.multiplex||d;return p?(l("ignoring socket cache for %s",s),i=a(s,e)):(c[u]||(l("new io instance for %s",s),c[u]=a(s,e)),i=c[u]),n.query&&!e.query?e.query=n.query:e&&"object"==typeof e.query&&(e.query=r(e.query)),i.socket(n.path,e)}function r(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")}var o=i(8),s=i(14),a=i(22),l=i(10)("socket.io-client");t.exports=e=n;var c=e.managers={};e.protocol=s.protocol,e.connect=n,e.Manager=i(22),e.Socket=i(48)},function(t,e,i){(function(e){function n(t,i){var n=t;i=i||e.location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(o("protocol-less url %s",t),t="undefined"!=typeof i?i.protocol+"//"+t:"https://"+t),o("parse %s",t),n=r(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=n.host.indexOf(":")!==-1,a=s?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port,n.href=n.protocol+"://"+a+(i&&i.port===n.port?"":":"+n.port),n}var r=i(9),o=i(10)("socket.io-client:url");t.exports=n}).call(e,function(){return this}())},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,r=t.indexOf("["),o=t.indexOf("]");r!=-1&&o!=-1&&(t=t.substring(0,r)+t.substring(r,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=i.exec(t||""),a={},l=14;l--;)a[n[l]]=s[l]||"";return r!=-1&&o!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,i){(function(n){function r(){return!("undefined"==typeof window||!window||"undefined"==typeof window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document&&"WebkitAppearance"in document.documentElement.style||"undefined"!=typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function o(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))}),t.splice(o,0,n)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function l(){try{return e.storage.debug}catch(t){}if("undefined"!=typeof n&&"env"in n)return n.env.DEBUG}function c(){try{return window.localStorage}catch(t){}}e=t.exports=i(12),e.log=s,e.formatArgs=o,e.save=a,e.load=l,e.useColors=r,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(l())}).call(e,i(11))},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){f&&p&&(f=!1,p.length?g=p.concat(g):m=-1,g.length&&a())}function a(){if(!f){var t=r(s);f=!0;for(var e=g.length;e;){for(p=g,g=[];++m<e;)p&&p[m].run();m=-1,e=g.length}p=null,f=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,h,d=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(t){h=n}}();var p,g=[],f=!1,m=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];g.push(new l(t,e)),1!==g.length||f||r(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e,i){function n(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function r(t){function i(){if(i.enabled){var t=i,n=+new Date,r=n-(c||n);t.diff=r,t.prev=c,t.curr=n,c=n;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;a++;var r=e.formatters[n];if("function"==typeof r){var s=o[a];i=r.call(t,s),o.splice(a,1),a--}return i}),e.formatArgs.call(t,o);var l=i.log||e.log||console.log.bind(console);l.apply(t,o)}}return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=n(t),"function"==typeof e.init&&e.init(i),i}function o(t){e.save(t);for(var i=(t||"").split(/[\s,]+/),n=i.length,r=0;r<n;r++)i[r]&&(t=i[r].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1}function l(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=r.debug=r.default=r,e.coerce=l,e.disable=s,e.enable=o,e.enabled=a,e.humanize=i(13),e.names=[],e.skips=[],e.formatters={};var c},function(t,e){function i(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return i*u;case"days":case"day":case"d":return i*c;case"hours":case"hour":case"hrs":case"hr":case"h":return i*l;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(t){return t>=c?Math.round(t/c)+"d":t>=l?Math.round(t/l)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function r(t){return o(t,c,"day")||o(t,l,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var s=1e3,a=60*s,l=60*a,c=24*l,u=365.25*c;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return i(t);if("number"===o&&isNaN(t)===!1)return e.long?r(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){function n(){}function r(t){var i="",n=!1;return i+=t.type,e.BINARY_EVENT!=t.type&&e.BINARY_ACK!=t.type||(i+=t.attachments,i+="-"),t.nsp&&"/"!=t.nsp&&(n=!0,i+=t.nsp),null!=t.id&&(n&&(i+=",",n=!1),i+=t.id),null!=t.data&&(n&&(i+=","),i+=d.stringify(t.data)),h("encoded %j as %s",t,i),i}function o(t,e){function i(t){var i=g.deconstructPacket(t),n=r(i.packet),o=i.buffers;o.unshift(n),e(o)}g.removeBlobs(t,i)}function s(){this.reconstructor=null}function a(t){var i={},n=0;if(i.type=Number(t.charAt(0)),null==e.types[i.type])return u();if(e.BINARY_EVENT==i.type||e.BINARY_ACK==i.type){for(var r="";"-"!=t.charAt(++n)&&(r+=t.charAt(n),n!=t.length););if(r!=Number(r)||"-"!=t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(r)}if("/"==t.charAt(n+1))for(i.nsp="";++n;){var o=t.charAt(n);if(","==o)break;if(i.nsp+=o,n==t.length)break}else i.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(i.id="";++n;){var o=t.charAt(n);if(null==o||Number(o)!=o){--n;break}if(i.id+=t.charAt(n),n==t.length)break}i.id=Number(i.id)}return t.charAt(++n)&&(i=l(i,t.substr(n))),h("decoded %s as %j",t,i),i}function l(t,e){try{t.data=d.parse(e)}catch(t){return u()}return t}function c(t){this.reconPack=t,this.buffers=[]}function u(t){return{type:e.ERROR,data:"parser error"}}var h=i(10)("socket.io-parser"),d=i(15),p=i(18),g=i(19),f=i(21);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=s,n.prototype.encode=function(t,i){if(h("encoding packet %j",t),e.BINARY_EVENT==t.type||e.BINARY_ACK==t.type)o(t,i);else{var n=r(t);i([n])}},p(s.prototype),s.prototype.add=function(t){var i;if("string"==typeof t)i=a(t),e.BINARY_EVENT==i.type||e.BINARY_ACK==i.type?(this.reconstructor=new c(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!f(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");i=this.reconstructor.takeBinaryData(t),i&&(this.reconstructor=null,this.emit("decoded",i))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=g.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,i){var n;(function(t,r){(function(){function o(t,e){function i(t){if(i[t]!==m)return i[t];var o;if("bug-string-char-index"==t)o="a"!="a"[0];else if("json"==t)o=i("json-stringify")&&i("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var c=e.stringify,u="function"==typeof c&&y;if(u){(s=function(){return 1}).toJSON=s;try{u="0"===c(0)&&"0"===c(new n)&&'""'==c(new r)&&c(b)===m&&c(m)===m&&c()===m&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([m])&&"null"==c(null)&&"[null,null,null]"==c([m,b,null])&&c({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new l(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new l(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new l(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new l(-1))}catch(t){u=!1}}o=u}if("json-parse"==t){var h=e.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){s=h(a);var d=5==s.a.length&&1===s.a[0];if(d){try{d=!h('"\t"')}catch(t){}if(d)try{d=1!==h("01")}catch(t){}if(d)try{d=1!==h("1.")}catch(t){}}}}catch(t){d=!1}o=d}}return i[t]=!!o}t||(t=c.Object()),e||(e=c.Object());var n=t.Number||c.Number,r=t.String||c.String,s=t.Object||c.Object,l=t.Date||c.Date,u=t.SyntaxError||c.SyntaxError,h=t.TypeError||c.TypeError,d=t.Math||c.Math,p=t.JSON||c.JSON;"object"==typeof p&&p&&(e.stringify=p.stringify,e.parse=p.parse);var g,f,m,v=s.prototype,b=v.toString,y=new l(-0xc782b5b800cec);try{y=y.getUTCFullYear()==-109252&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(t){}if(!i("json")){var _="[object Function]",w="[object Date]",C="[object Number]",x="[object String]",k="[object Array]",M="[object Boolean]",S=i("bug-string-char-index");if(!y)var I=d.floor,A=[0,31,59,90,120,151,181,212,243,273,304,334],T=function(t,e){return A[e]+365*(t-1970)+I((t-1969+(e=+(e>1)))/4)-I((t-1901+e)/100)+I((t-1601+e)/400)};if((g=v.hasOwnProperty)||(g=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=b?g=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,g=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,g.call(this,t)}),f=function(t,e){var i,n,r,o=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,n=new i;for(r in n)g.call(n,r)&&o++;return i=n=null,o?f=2==o?function(t,e){var i,n={},r=b.call(t)==_;for(i in t)r&&"prototype"==i||g.call(n,i)||!(n[i]=1)||!g.call(t,i)||e(i)}:function(t,e){var i,n,r=b.call(t)==_;for(i in t)r&&"prototype"==i||!g.call(t,i)||(n="constructor"===i)||e(i);(n||g.call(t,i="constructor"))&&e(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(t,e){var i,r,o=b.call(t)==_,s=!o&&"function"!=typeof t.constructor&&a[typeof t.hasOwnProperty]&&t.hasOwnProperty||g;for(i in t)o&&"prototype"==i||!s.call(t,i)||e(i);for(r=n.length;i=n[--r];s.call(t,i)&&e(i));}),f(t,e)},!i("json-stringify")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},R="000000",P=function(t,e){return(R+(e||0)).slice(-t)},N="\\u00",D=function(t){for(var e='"',i=0,n=t.length,r=!S||n>10,o=r&&(S?t.split(""):t);i<n;i++){var s=t.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=E[s];break;default:if(s<32){e+=N+P(2,s.toString(16));break}e+=r?o[i]:t.charAt(i)}}return e+'"'},j=function(t,e,i,n,r,o,s){var a,l,c,u,d,p,v,y,_,S,A,E,R,N,O,B;try{a=e[t]}catch(t){}if("object"==typeof a&&a)if(l=b.call(a),l!=w||g.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=C&&l!=x&&l!=k||g.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&a<1/0){if(T){for(d=I(a/864e5),c=I(d/365.2425)+1970-1;T(c+1,0)<=d;c++);for(u=I((d-T(c,0))/30.42);T(c,u+1)<=d;u++);d=1+d-T(c,u),p=(a%864e5+864e5)%864e5,v=I(p/36e5)%24,y=I(p/6e4)%60,_=I(p/1e3)%60,S=p%1e3}else c=a.getUTCFullYear(),u=a.getUTCMonth(),d=a.getUTCDate(),v=a.getUTCHours(),y=a.getUTCMinutes(),_=a.getUTCSeconds(),S=a.getUTCMilliseconds();a=(c<=0||c>=1e4?(c<0?"-":"+")+P(6,c<0?-c:c):P(4,c))+"-"+P(2,u+1)+"-"+P(2,d)+"T"+P(2,v)+":"+P(2,y)+":"+P(2,_)+"."+P(3,S)+"Z"}else a=null;if(i&&(a=i.call(e,t,a)),null===a)return"null";if(l=b.call(a),l==M)return""+a;if(l==C)return a>-1/0&&a<1/0?""+a:"null";if(l==x)return D(""+a);if("object"==typeof a){for(N=s.length;N--;)if(s[N]===a)throw h();if(s.push(a),A=[],O=o,o+=r,l==k){for(R=0,N=a.length;R<N;R++)E=j(R,a,i,n,r,o,s),A.push(E===m?"null":E);B=A.length?r?"[\n"+o+A.join(",\n"+o)+"\n"+O+"]":"["+A.join(",")+"]":"[]"}else f(n||a,function(t){var e=j(t,a,i,n,r,o,s);e!==m&&A.push(D(t)+":"+(r?" ":"")+e)}),B=A.length?r?"{\n"+o+A.join(",\n"+o)+"\n"+O+"}":"{"+A.join(",")+"}":"{}";return s.pop(),B}};e.stringify=function(t,e,i){var n,r,o,s;if(a[typeof e]&&e)if((s=b.call(e))==_)r=e;else if(s==k){o={};for(var l,c=0,u=e.length;c<u;l=e[c++],s=b.call(l),(s==x||s==C)&&(o[l]=1));}if(i)if((s=b.call(i))==C){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else s==x&&(n=i.length<=10?i:i.slice(0,10));return j("",(l={},l[""]=t,l),r,o,n,"",[])}}if(!i("json-parse")){var O,B,U=r.fromCharCode,V={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},W=function(){throw O=B=null,u()},F=function(){for(var t,e,i,n,r,o=B,s=o.length;O<s;)switch(r=o.charCodeAt(O)){case 9:case 10:case 13:case 32:O++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=S?o.charAt(O):o[O],O++,t;case 34:for(t="@",O++;O<s;)if(r=o.charCodeAt(O),r<32)W();else if(92==r)switch(r=o.charCodeAt(++O)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=V[r],O++;break;case 117:for(e=++O,i=O+4;O<i;O++)r=o.charCodeAt(O),r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70||W();t+=U("0x"+o.slice(e,O));break;default:W()}else{if(34==r)break;for(r=o.charCodeAt(O),e=O;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++O);t+=o.slice(e,O)}if(34==o.charCodeAt(O))return O++,t;W();default:if(e=O,45==r&&(n=!0,r=o.charCodeAt(++O)),r>=48&&r<=57){for(48==r&&(r=o.charCodeAt(O+1),r>=48&&r<=57)&&W(),n=!1;O<s&&(r=o.charCodeAt(O),r>=48&&r<=57);O++);if(46==o.charCodeAt(O)){for(i=++O;i<s&&(r=o.charCodeAt(i),r>=48&&r<=57);i++);i==O&&W(),O=i}if(r=o.charCodeAt(O),101==r||69==r){for(r=o.charCodeAt(++O),43!=r&&45!=r||O++,i=O;i<s&&(r=o.charCodeAt(i),r>=48&&r<=57);i++);i==O&&W(),O=i}return+o.slice(e,O)}if(n&&W(),"true"==o.slice(O,O+4))return O+=4,!0;if("false"==o.slice(O,O+5))return O+=5,!1;if("null"==o.slice(O,O+4))return O+=4,null;W()}return"$"},$=function(t){var e,i;if("$"==t&&W(),"string"==typeof t){if("@"==(S?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=F(),"]"!=t;i||(i=!0))i&&(","==t?(t=F(),"]"==t&&W()):W()),","==t&&W(),e.push($(t));return e}if("{"==t){for(e={};t=F(),"}"!=t;i||(i=!0))i&&(","==t?(t=F(),"}"==t&&W()):W()),","!=t&&"string"==typeof t&&"@"==(S?t.charAt(0):t[0])&&":"==F()||W(),e[t.slice(1)]=$(F());return e}W()}return t},L=function(t,e,i){var n=z(t,e,i);n===m?delete t[e]:t[e]=n},z=function(t,e,i){var n,r=t[e];if("object"==typeof r&&r)if(b.call(r)==k)for(n=r.length;n--;)L(r,n,i);else f(r,function(t){L(r,t,i)});return i.call(t,e,r)};e.parse=function(t,e){var i,n;return O=0,B=""+t,i=$(F()),"$"!=F()&&W(),O=B=null,e&&b.call(e)==_?z((n={},n[""]=i,n),"",e):i}}}return e.runInContext=o,e}var s=i(17),a={function:!0,object:!0},l=a[typeof e]&&e&&!e.nodeType&&e,c=a[typeof window]&&window||this,u=l&&a[typeof t]&&t&&!t.nodeType&&"object"==typeof r&&r;if(!u||u.global!==u&&u.window!==u&&u.self!==u||(c=u),l&&!s)o(c,l);else{var h=c.JSON,d=c.JSON3,p=!1,g=o(c,c.JSON3={noConflict:function(){return p||(p=!0,c.JSON=h,c.JSON3=d,h=d=null),g}});c.JSON={parse:g.parse,stringify:g.stringify}}s&&(n=function(){return g}.call(e,i,e,t),!(void 0!==n&&(t.exports=n)))}).call(this)}).call(e,i(16)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,i){function n(t){if(t)return r(t)}function r(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,r=0;r<i.length;r++)if(n=i[r],n===e||n.fn===e){i.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i){i=i.slice(0);for(var n=0,r=i.length;n<r;++n)i[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){(function(t){var n=i(20),r=i(21);e.deconstructPacket=function(t){function e(t){if(!t)return t;if(r(t)){var o={_placeholder:!0,num:i.length};return i.push(t),o}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a]);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var l in t)s[l]=e(t[l]);return s}return t}var i=[],o=t.data,s=t;return s.data=e(o),s.attachments=i.length,{packet:s,buffers:i}},e.reconstructPacket=function(t,e){function i(t){if(t&&t._placeholder){var r=e[t.num];return r}if(n(t)){for(var o=0;o<t.length;o++)t[o]=i(t[o]);return t}if(t&&"object"==typeof t){for(var s in t)t[s]=i(t[s]);return t}return t}return t.data=i(t.data),t.attachments=void 0,t},e.removeBlobs=function(e,i){function o(e,l,c){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var u=new FileReader;u.onload=function(){c?c[l]=this.result:a=this.result,--s||i(a)},u.readAsArrayBuffer(e)}else if(n(e))for(var h=0;h<e.length;h++)o(e[h],h,e);else if(e&&"object"==typeof e&&!r(e))for(var d in e)o(e[d],d,e)}var s=0,a=e;o(a),s||i(a)}}).call(e,function(){return this}())},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){(function(e){function i(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=i}).call(e,function(){return this}())},function(t,e,i){function n(t,e){return this instanceof n?(t&&"object"==typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(t,e)}var r=i(23),o=i(48),s=i(18),a=i(14),l=i(50),c=i(51),u=i(10)("socket.io-client:manager"),h=i(46),d=i(52),p=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)p.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)p.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)},s(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(t,e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var i=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=l(i,"open",function(){n.onopen(),t&&t()}),s=l(i,"error",function(e){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var c=setTimeout(function(){u("connect attempt timed out after %d",a),o.destroy(),i.close(),i.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(s),this},n.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(l(t,"data",c(this,"ondata"))),this.subs.push(l(t,"ping",c(this,"onping"))),this.subs.push(l(t,"pong",c(this,"onpong"))),this.subs.push(l(t,"error",c(this,"onerror"))),this.subs.push(l(t,"close",c(this,"onclose"))),this.subs.push(l(this.decoder,"decoded",c(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},n.prototype.socket=function(t,e){function i(){~h(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[t];if(!n){n=new o(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",i),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&i()}return n},n.prototype.destroy=function(t){var e=h(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},n.prototype.packet=function(t){u("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},n.prototype.cleanup=function(){u("cleanup");for(var t=this.subs.length,e=0;e<t;e++){var i=this.subs.shift();i.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,i){t.exports=i(24)},function(t,e,i){t.exports=i(25),t.exports.parser=i(32)},function(t,e,i){(function(e){function n(t,i){if(!(this instanceof n))return new n(t,i);i=i||{},t&&"object"==typeof t&&(i=t,t=null),t?(t=u(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=u(i.host).host),this.secure=null!=i.secure?i.secure:e.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(e.location?location.hostname:"localhost"),this.port=i.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized?null:i.rejectUnauthorized,this.forceNode=!!i.forceNode;var r="object"==typeof e&&e;r.global===r&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function r(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var o=i(26),s=i(18),a=i(10)("engine.io-client:socket"),l=i(46),c=i(32),u=i(9),h=i(47),d=i(40);t.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=c.protocol,n.Socket=n,n.Transport=i(31),n.transports=i(26),n.parser=i(32),n.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=r(this.query);e.EIO=c.protocol,e.transport=t,this.id&&(e.sid=this.id);var i=new o[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,
cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return i},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(d.onlyBinaryUpgrades){var e=!this.supportsBinary&&d.transport.supportsBinary;h=h||e}h||(a('probe transport "%s" opened',t),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(e){if(!h)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),d.upgrading=!0,d.emit("upgrading",u),!u)return;n.priorWebsocketSuccess="websocket"===u.name,a('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){h||"closed"!==d.readyState&&(a("changing transport and sending upgrade packet"),c(),d.setTransport(u),u.send([{type:"upgrade"}]),d.emit("upgrade",u),u=null,d.upgrading=!1,d.flush())})}else{a('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=u.name,d.emit("upgradeError",i)}}))}function i(){h||(h=!0,c(),u.close(),u=null)}function r(e){var n=new Error("probe error: "+e);n.transport=u.name,i(),a('probe transport "%s" failed because of error: %s',t,e),d.emit("upgradeError",n)}function o(){r("transport closed")}function s(){r("socket closed")}function l(t){u&&t.name!==u.name&&(a('"%s" works - aborting "%s"',t.name,u.name),i())}function c(){u.removeListener("open",e),u.removeListener("error",r),u.removeListener("close",o),d.removeListener("close",s),d.removeListener("upgrading",l)}a('probing transport "%s"',t);var u=this.createTransport(t,{probe:1}),h=!1,d=this;n.priorWebsocketSuccess=!1,u.once("open",e),u.once("error",r),u.once("close",o),this.once("close",s),this.once("upgrading",l),u.open()},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(h(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},n.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){i=i||{},i.compress=!1!==i.compress;var r={type:t,data:e,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function i(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},n.prototype.onError=function(t){a("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),i.writeBuffer=[],i.prevBufferLen=0}},n.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~l(this.transports,t[i])&&e.push(t[i]);return e}}).call(e,function(){return this}())},function(t,e,i){(function(t){function n(e){var i,n=!1,a=!1,l=!1!==e.jsonp;if(t.location){var c="https:"===location.protocol,u=location.port;u||(u=c?443:80),n=e.hostname!==location.hostname||u!==e.port,a=e.secure!==c}if(e.xdomain=n,e.xscheme=a,i=new r(e),"open"in i&&!e.forceJSONP)return new o(e);if(!l)throw new Error("JSONP disabled");return new s(e)}var r=i(27),o=i(29),s=i(43),a=i(44);e.polling=n,e.websocket=a}).call(e,function(){return this}())},function(t,e,i){(function(e){var n=i(28);t.exports=function(t){var i=t.xdomain,r=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(t){}if(!i)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(e,function(){return this}())},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,i){(function(e){function n(){}function r(t){if(l.call(this,t),this.requestTimeout=t.requestTimeout,e.location){var i="https:"===location.protocol,n=location.port;n||(n=i?443:80),this.xd=t.hostname!==e.location.hostname||n!==t.port,this.xs=t.secure!==i}else this.extraHeaders=t.extraHeaders}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}var a=i(27),l=i(30),c=i(18),u=i(41),h=i(10)("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=o,u(r,l),r.prototype.supportsBinary=!0,r.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new o(t)},r.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:i}),r=this;n.on("success",e),n.on("error",function(t){r.onError("xhr post error",t)}),this.sendXhr=n},r.prototype.doPoll=function(){h("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},c(o.prototype),o.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new a(t),n=this;try{h("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders){i.setDisableHeaderCheck(!0);for(var r in this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this.extraHeaders[r])}}catch(t){}if(this.supportsBinary&&(i.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){n.onLoad()},i.onerror=function(){n.onError(i.responseText)}):i.onreadystatechange=function(){4===i.readyState&&(200===i.status||1223===i.status?n.onLoad():setTimeout(function(){n.onError(i.status)},0))},h("xhr data %s",this.data),i.send(this.data)}catch(t){return void setTimeout(function(){n.onError(t)},0)}e.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(t){}e.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(t){}if("application/octet-stream"===e)t=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(e){for(var i=new Uint8Array(this.xhr.response),n=[],r=0,o=i.length;r<o;r++)n.push(i[r]);t=String.fromCharCode.apply(null,n)}else t=this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return"undefined"!=typeof e.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",s):e.addEventListener&&e.addEventListener("beforeunload",s,!1))}).call(e,function(){return this}())},function(t,e,i){function n(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),r.call(this,t)}var r=i(31),o=i(40),s=i(32),a=i(41),l=i(42),c=i(10)("engine.io-client:polling");t.exports=n;var u=function(){var t=i(27),e=new t({xdomain:!1});return null!=e.responseType}();a(n,r),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){c("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){c("pre-pause polling complete"),--n||e()})),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",function(){c("pre-pause writing complete"),--n||e()}))}else e()},n.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var e=this;c("polling got data %s",t);var i=function(t,i,n){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,i),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){c("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";!1!==this.timestampRequests&&(t[this.timestampParam]=l()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,e,i){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var r=i(32),o=i(18);t.exports=n,o(n.prototype),n.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,i){(function(t){function n(t,i){var n="b"+e.packets[t.type]+t.data.data;return i(n)}function r(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=b[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}function o(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=new FileReader;return r.onload=function(){t.data=r.result,e.encodePacket(t,i,!0,n)},r.readAsArrayBuffer(t.data)}function s(t,i,n){if(!i)return e.encodeBase64Packet(t,n);if(v)return o(t,i,n);var r=new Uint8Array(1);r[0]=b[t.type];var s=new w([r.buffer,t.data]);return n(s)}function a(t){try{t=g.decode(t)}catch(t){return!1}return t}function l(t,e,i){for(var n=new Array(t.length),r=p(t.length,i),o=function(t,i,r){e(i,function(e,i){n[t]=i,r(e,n)})},s=0;s<t.length;s++)o(s,t[s],r)}var c,u=i(33),h=i(34),d=i(35),p=i(36),g=i(37);t&&t.ArrayBuffer&&(c=i(38));var f="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=f||m;e.protocol=3;var b=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=u(b),_={type:"error",data:"parser error"},w=i(39);e.encodePacket=function(e,i,o,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof o&&(a=o,o=null);var l=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&l instanceof ArrayBuffer)return r(e,i,a);if(w&&l instanceof t.Blob)return s(e,i,a);if(l&&l.base64)return n(e,a);var c=b[e.type];return void 0!==e.data&&(c+=o?g.encode(String(e.data)):String(e.data)),a(""+c)},e.encodeBase64Packet=function(i,n){var r="b"+e.packets[i.type];if(w&&i.data instanceof t.Blob){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];n(r+t)},o.readAsDataURL(i.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(i.data))}catch(t){for(var a=new Uint8Array(i.data),l=new Array(a.length),c=0;c<a.length;c++)l[c]=a[c];s=String.fromCharCode.apply(null,l)}return r+=t.btoa(s),n(r)},e.decodePacket=function(t,i,n){if(void 0===t)return _;if("string"==typeof t){if("b"==t.charAt(0))return e.decodeBase64Packet(t.substr(1),i);if(n&&(t=a(t),t===!1))return _;var r=t.charAt(0);return Number(r)==r&&y[r]?t.length>1?{type:y[r],data:t.substring(1)}:{type:y[r]}:_}var o=new Uint8Array(t),r=o[0],s=d(t,1);return w&&"blob"===i&&(s=new w([s])),{type:y[r],data:s}},e.decodeBase64Packet=function(t,e){var i=y[t.charAt(0)];if(!c)return{type:i,data:{base64:!0,data:t.substr(1)}};var n=c.decode(t.substr(1));return"blob"===e&&w&&(n=new w([n])),{type:i,data:n}},e.encodePayload=function(t,i,n){function r(t){return t.length+":"+t}function o(t,n){e.encodePacket(t,!!s&&i,!0,function(t){n(null,r(t))})}"function"==typeof i&&(n=i,i=null);var s=h(t);return i&&s?w&&!v?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n):t.length?void l(t,o,function(t,e){return n(e.join(""))}):n("0:")},e.decodePayload=function(t,i,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,i,n);"function"==typeof i&&(n=i,i=null);var r;if(""==t)return n(_,0,1);for(var o,s,a="",l=0,c=t.length;l<c;l++){var u=t.charAt(l);if(":"!=u)a+=u;else{if(""==a||a!=(o=Number(a)))return n(_,0,1);if(s=t.substr(l+1,o),a!=s.length)return n(_,0,1);if(s.length){if(r=e.decodePacket(s,i,!0),_.type==r.type&&_.data==r.data)return n(_,0,1);var h=n(r,l+o,c);if(!1===h)return}l+=o,a=""}}return""!=a?n(_,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,i){function n(t,i){e.encodePacket(t,!0,!0,function(t){return i(null,t)})}return t.length?void l(t,n,function(t,e){var n=e.reduce(function(t,e){var i;return i="string"==typeof e?e.length:e.byteLength,t+i.toString().length+i+2},0),r=new Uint8Array(n),o=0;return e.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);i=n.buffer}e?r[o++]=0:r[o++]=1;for(var a=i.byteLength.toString(),s=0;s<a.length;s++)r[o++]=parseInt(a[s]);r[o++]=255;for(var n=new Uint8Array(i),s=0;s<n.length;s++)r[o++]=n[s]}),i(r.buffer)}):i(new ArrayBuffer(0))},e.encodePayloadAsBlob=function(t,i){function n(t,i){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);t=n.buffer,e[0]=0}for(var o=t instanceof ArrayBuffer?t.byteLength:t.size,s=o.toString(),a=new Uint8Array(s.length+1),r=0;r<s.length;r++)a[r]=parseInt(s[r]);if(a[s.length]=255,w){var l=new w([e.buffer,a.buffer,t]);i(null,l)}})}l(t,n,function(t,e){return i(new w(e))})},e.decodePayloadAsBinary=function(t,i,n){"function"==typeof i&&(n=i,i=null);for(var r=t,o=[],s=!1;r.byteLength>0;){for(var a=new Uint8Array(r),l=0===a[0],c="",u=1;255!=a[u];u++){if(c.length>310){s=!0;break}c+=a[u]}if(s)return n(_,0,1);r=d(r,2+c.length),c=parseInt(c);var h=d(r,0,c);if(l)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(t){var p=new Uint8Array(h);h="";for(var u=0;u<p.length;u++)h+=String.fromCharCode(p[u])}o.push(h),r=d(r,c)}var g=o.length;o.forEach(function(t,r){n(e.decodePacket(t,i,!0),r,g)})}}).call(e,function(){return this}())},function(t,e){t.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},function(t,e,i){(function(e){function n(t){function i(t){if(!t)return!1;if(e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer||e.Blob&&t instanceof Blob||e.File&&t instanceof File)return!0;if(r(t)){for(var n=0;n<t.length;n++)if(i(t[n]))return!0}else if(t&&"object"==typeof t){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&i(t[o]))return!0}return!1}return i(t)}var r=i(20);t.exports=n}).call(e,function(){return this}())},function(t,e){t.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-e),s=e,a=0;s<i;s++,a++)o[a]=r[s];return o.buffer}},function(t,e){function i(t,e,i){function r(t,n){if(r.count<=0)throw new Error("after called too many times");--r.count,t?(o=!0,e(t),e=i):0!==r.count||o||e(null,n)}var o=!1;return i=i||n,r.count=t,0===t?e():r}function n(){}t.exports=i},function(t,e,i){var n;(function(t,r){!function(o){function s(t){for(var e,i,n=[],r=0,o=t.length;r<o;)e=t.charCodeAt(r++),e>=55296&&e<=56319&&r<o?(i=t.charCodeAt(r++),56320==(64512&i)?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--)):n.push(e);return n}function a(t){for(var e,i=t.length,n=-1,r="";++n<i;)e=t[n],e>65535&&(e-=65536,r+=y(e>>>10&1023|55296),e=56320|1023&e),r+=y(e);return r}function l(t,e){return y(t>>e&63|128)}function c(t){if(0==(4294967168&t))return y(t);var e="";return 0==(4294965248&t)?e=y(t>>6&31|192):0==(4294901760&t)?(e=y(t>>12&15|224),e+=l(t,6)):0==(4292870144&t)&&(e=y(t>>18&7|240),e+=l(t,12),e+=l(t,6)),e+=y(63&t|128)}function u(t){for(var e,i=s(t),n=i.length,r=-1,o="";++r<n;)e=i[r],o+=c(e);return o}function h(){if(b>=v)throw Error("Invalid byte index");var t=255&m[b];if(b++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function d(){var t,e,i,n,r;if(b>v)throw Error("Invalid byte index");if(b==v)return!1;if(t=255&m[b],b++,0==(128&t))return t;if(192==(224&t)){var e=h();if(r=(31&t)<<6|e,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if(e=h(),i=h(),r=(15&t)<<12|e<<6|i,r>=2048)return r;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=h(),i=h(),n=h(),r=(15&t)<<18|e<<12|i<<6|n,r>=65536&&r<=1114111))return r;throw Error("Invalid WTF-8 detected")}function p(t){m=s(t),v=m.length,b=0;for(var e,i=[];(e=d())!==!1;)i.push(e);return a(i)}var g="object"==typeof e&&e,f=("object"==typeof t&&t&&t.exports==g&&t,"object"==typeof r&&r);f.global!==f&&f.window!==f||(o=f);var m,v,b,y=String.fromCharCode,_={version:"1.0.0",encode:u,decode:p};n=function(){return _}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,i(16)(t),function(){return this}())},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),n=0;n<t.length;n++)i[t.charCodeAt(n)]=n;e.encode=function(e){var i,n=new Uint8Array(e),r=n.length,o="";for(i=0;i<r;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,n,r,o,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(e=0;e<l;e+=4)n=i[t.charCodeAt(e)],r=i[t.charCodeAt(e+1)],o=i[t.charCodeAt(e+2)],s=i[t.charCodeAt(e+3)],h[c++]=n<<2|r>>4,h[c++]=(15&r)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return u}}()},function(t,e){(function(e){function i(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.buffer instanceof ArrayBuffer){var n=i.buffer;if(i.byteLength!==n.byteLength){var r=new Uint8Array(i.byteLength);r.set(new Uint8Array(n,i.byteOffset,i.byteLength)),n=r.buffer}t[e]=n}}}function n(t,e){e=e||{};var n=new o;i(t);for(var r=0;r<t.length;r++)n.append(t[r]);return e.type?n.getBlob(e.type):n.getBlob()}function r(t,e){return i(t),new Blob(t,e||{})}var o=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size}catch(t){return!1}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size}catch(t){return!1}}(),l=o&&o.prototype.append&&o.prototype.getBlob;t.exports=function(){return s?a?e.Blob:r:l?n:void 0}()}).call(e,function(){return this}())},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),n=0,r=i.length;n<r;n++){var o=i[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){t.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e){"use strict";function i(t){var e="";do e=s[t%a]+e,t=Math.floor(t/a);while(t>0);return e}function n(t){var e=0;for(u=0;u<t.length;u++)e=e*a+l[t.charAt(u)];return e}function r(){var t=i(+new Date);return t!==o?(c=0,o=t):t+"."+i(c++)}for(var o,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,l={},c=0,u=0;u<a;u++)l[s[u]]=u;r.encode=i,r.decode=n,t.exports=r},function(t,e,i){(function(e){function n(){}function r(t){o.call(this,t),this.query=this.query||{},a||(e.___eio||(e.___eio=[]),a=e.___eio),this.index=a.length;var i=this;a.push(function(t){i.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=n)},!1)}var o=i(30),s=i(41);t.exports=r;var a,l=/\n/g,c=/\\n/g;s(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},r.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(t){o=document.createElement("iframe"),o.name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=u,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),t=t.replace(c,"\\\n"),this.area.value=t.replace(l,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&i()}:this.iframe.onload=i}}).call(e,function(){return this}())},function(t,e,i){(function(e){function n(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=h&&!t.forceNode,this.usingBrowserWebSocket||(d=r),o.call(this,t)}var r,o=i(31),s=i(32),a=i(40),l=i(41),c=i(42),u=i(10)("engine.io-client:websocket"),h=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{r=i(45)}catch(t){}var d=h;d||"undefined"!=typeof window||(d=r),t.exports=n,l(n,o),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new d(t):new d(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},n.prototype.write=function(t){function i(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var r=t.length,o=0,a=r;o<a;o++)!function(t){s.encodePacket(t,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var s={};if(t.options&&(s.compress=t.options.compress),n.perMessageDeflate){var a="string"==typeof o?e.Buffer.byteLength(o):o.length;a<n.perMessageDeflate.threshold&&(s.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,s)}catch(t){u("websocket closed before onclose event")}--r||i()})}(t[o])},n.prototype.onClose=function(){o.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),t=a.encode(t),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+i+this.path+t},n.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===n.prototype.name)}}).call(e,function(){return this}())},function(t,e){},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e){(function(e){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):i.test(t.replace(n,"@").replace(r,"]").replace(o,""))?new Function("return "+t)():void 0):null}}).call(e,function(){return this}())},function(t,e,i){function n(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var r=i(14),o=i(18),s=i(49),a=i(50),l=i(51),c=i(10)("socket.io-client:socket"),u=i(34);t.exports=e=n;var h={connect:1,connect_error:1,connect_timeout:1,
connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=o.prototype.emit;o(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",l(this,"onopen")),a(t,"packet",l(this,"onpacket")),a(t,"close",l(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){if(h.hasOwnProperty(t))return d.apply(this,arguments),this;var e=s(arguments),i=r.EVENT;u(e)&&(i=r.BINARY_EVENT);var n={type:i,data:e};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){c("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:r.CONNECT,query:this.query}):this.packet({type:r.CONNECT}))},n.prototype.onclose=function(t){c("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(t);break;case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:this.onack(t);break;case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];c("emitting event %j",e),null!=t.id&&(c("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?d.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var n=s(arguments);c("sending ack %j",n);var o=u(n)?r.BINARY_ACK:r.ACK;e.packet({type:o,id:t,data:n})}}},n.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(c("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):c("bad ack %s",t.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)d.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},function(t,e){function i(t,e){var i=[];e=e||0;for(var n=e||0;n<t.length;n++)i[n-e]=t[n];return i}t.exports=i},function(t,e){function i(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}t.exports=i},function(t,e){var i=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},function(t,e,i){var n,r;/*!
	 * Includes BabySitter
	 * https://github.com/marionettejs/backbone.babysitter/
	 *
	 * Includes Wreqr
	 * https://github.com/marionettejs/backbone.wreqr/
	 */
!function(o,s){n=[i(3),i(4)],r=function(t,e){return o.Marionette=o.Mn=s(o,t,e)}.apply(e,n),!(void 0!==r&&(t.exports=r))}(this,function(t,e,i){"use strict";!function(t,e){var i=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var i=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(i.prototype,{add:function(t,e){var i=t.cid;return this._views[i]=t,t.model&&(this._indexByModel[t.model.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var i=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){if(t===i)return delete this._indexByCustom[e],!0},this),delete this._views[i],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,i){e.each(this._views,function(n){e.isFunction(n[t])&&n[t].apply(n,i||[])})},_updateLength:function(){this.length=e.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return e.each(n,function(t){i.prototype[t]=function(){var i=e.values(this._views),n=[i].concat(e.toArray(arguments));return e[t].apply(e,n)}}),i}(t,e),t.ChildViewContainer.VERSION="0.1.11",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=i,this},t.ChildViewContainer}(e,i),function(t,e){var i=t.Wreqr,n=t.Wreqr={};return t.Wreqr.VERSION="1.3.6",t.Wreqr.noConflict=function(){return t.Wreqr=i,this},n.Handlers=function(t,e){var i=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events,{setHandlers:function(t){e.each(t,function(t,i){var n=null;e.isObject(t)&&!e.isFunction(t)&&(n=t.context,t=t.callback),this.setHandler(i,t,n)},this)},setHandler:function(t,e,i){var n={callback:e,context:i};this._wreqrHandlers[t]=n,this.trigger("handler:add",t,e,i)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){return e.callback.apply(e.context,arguments)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(t,e),n.CommandStorage=function(){var i=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(i.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var i=this.getCommands(t);i.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),i}(),n.Commands=function(t,e){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),t.Handlers.prototype.constructor.apply(this,arguments)},execute:function(t){t=arguments[0];var i=e.rest(arguments);this.hasHandler(t)?this.getHandler(t).apply(this,i):this.storage.addCommand(t,i)},_executeCommands:function(t,i,n){var r=this.storage.getCommands(t);e.each(r.instances,function(t){i.apply(n,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var i,n=t.storageType||this.storageType;i=e.isFunction(n)?new n:n,this.storage=i}})}(n,e),n.RequestResponse=function(t,e){return t.Handlers.extend({request:function(t){if(this.hasHandler(t))return this.getHandler(t).apply(this,e.rest(arguments))}})}(n,e),n.EventAggregator=function(t,e){var i=function(){};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events),i}(t,e),n.Channel=function(i){var n=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,i,n){if(i){n=n||this;var r="vent"===t?"on":"setHandler";e.each(i,function(i,o){this[t][r](o,e.bind(i,n))},this)}}}),n}(n),n.radio=function(t,e){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(i.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var i=this._channels[e];return i||(i=new t.Channel(e),this._channels[e]=i),i},_proxyMethods:function(){e.each(["vent","commands","reqres"],function(t){e.each(n[t],function(e){this[t][e]=r(this,t,e)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(t,i,n){return function(r){var o=t._getChannel(r)[i];return o[n].apply(o,e.rest(arguments))}};return new i}(n,e),t.Wreqr}(e,i);var n=t.Marionette,r=t.Mn,o=e.Marionette={};o.VERSION="2.4.7",o.noConflict=function(){return t.Marionette=n,t.Mn=r,this},e.Marionette=o,o.Deferred=e.$.Deferred,o.extend=e.Model.extend,o.isNodeAttached=function(t){return e.$.contains(document.documentElement,t)},o.mergeOptions=function(t,e){t&&i.extend(this,i.pick(t,e))},o.getOption=function(t,e){if(t&&e)return t.options&&void 0!==t.options[e]?t.options[e]:t[e]},o.proxyGetOption=function(t){return o.getOption(this,t)},o._getValue=function(t,e,n){return i.isFunction(t)&&(t=n?t.apply(e,n):t.call(e)),t},o.normalizeMethods=function(t){return i.reduce(t,function(t,e,n){return i.isFunction(e)||(e=this[e]),e&&(t[n]=e),t},{},this)},o.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(t){return e[t.slice(4)]})},o.normalizeUIKeys=function(t,e){return i.reduce(t,function(t,i,n){var r=o.normalizeUIString(n,e);return t[r]=i,t},{})},o.normalizeUIValues=function(t,e,n){return i.each(t,function(r,s){i.isString(r)?t[s]=o.normalizeUIString(r,e):i.isObject(r)&&i.isArray(n)&&(i.extend(r,o.normalizeUIValues(i.pick(r,n),e)),i.each(n,function(t){var n=r[t];i.isString(n)&&(r[t]=o.normalizeUIString(n,e))}))}),t},o.actAsCollection=function(t,e){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){t[n]=function(){var t=i.values(i.result(this,e)),r=[t].concat(i.toArray(arguments));return i[n].apply(i,r)}})};var s=o.deprecate=function(t,e){i.isObject(t)&&(t=t.prev+" is going to be removed in the future. Please use "+t.next+" instead."+(t.url?" See: "+t.url:"")),void 0!==e&&e||s._cache[t]||(s._warn("Deprecation warning: "+t),s._cache[t]=!0)};s._console="undefined"!=typeof console?console:{},s._warn=function(){var t=s._console.warn||s._console.log||function(){};return t.apply(s._console,arguments)},s._cache={},o._triggerMethod=function(){function t(t,e,i){return i.toUpperCase()}var e=/(^|:)(\w)/gi;return function(n,r,o){var s=arguments.length<3;s&&(o=r,r=o[0]);var a,l="on"+r.replace(e,t),c=n[l];return i.isFunction(c)&&(a=c.apply(n,s?i.rest(o):o)),i.isFunction(n.trigger)&&(s+o.length>1?n.trigger.apply(n,s?o:[r].concat(i.drop(o,0))):n.trigger(r)),a}}(),o.triggerMethod=function(t){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(t){var e=i.isFunction(t.triggerMethod)?t.triggerMethod:o.triggerMethod;return e.apply(t,i.rest(arguments))},o.MonitorDOMRefresh=function(t){function e(){t._isShown=!0,n()}function i(){t._isRendered=!0,n()}function n(){t._isShown&&t._isRendered&&o.isNodeAttached(t.el)&&o.triggerMethodOn(t,"dom:refresh",t)}t._isDomRefreshMonitored||(t._isDomRefreshMonitored=!0,t.on({show:e,render:i}))},function(t){function e(e,n,r,o){var s=o.split(/\s+/);i.each(s,function(i){var o=e[i];if(!o)throw new t.Error('Method "'+i+'" was configured as an event handler, but does not exist.');e.listenTo(n,r,o)})}function n(t,e,i,n){t.listenTo(e,i,n)}function r(t,e,n,r){var o=r.split(/\s+/);i.each(o,function(i){var r=t[i];t.stopListening(e,n,r)})}function o(t,e,i,n){t.stopListening(e,i,n)}function s(e,n,r,o,s){if(n&&r){if(!i.isObject(r))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=t._getValue(r,e),i.each(r,function(t,r){i.isFunction(t)?o(e,n,r,t):s(e,n,r,t)})}}t.bindEntityEvents=function(t,i,r){s(t,i,r,n,e)},t.unbindEntityEvents=function(t,e,i){s(t,e,i,o,r)},t.proxyBindEntityEvents=function(e,i){return t.bindEntityEvents(this,e,i)},t.proxyUnbindEntityEvents=function(e,i){return t.unbindEntityEvents(this,e,i)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(t,e){i.isObject(t)?(e=t,t=e.message):e||(e={});var n=Error.call(this,t);i.extend(this,i.pick(n,a),i.pick(e,a)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},i.extend(o.Callbacks.prototype,{add:function(t,e){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),n.then(function(i){e&&(i.context=e),t.call(i.context,i.options)})},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],i.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.options=t||{},i.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,i.extend(o.Controller.prototype,e.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(t){this.options=i.extend({},i.result(this,"options"),t),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,i.extend(o.Object.prototype,e.Events,{initialize:function(){},destroy:function(t){return t=t||{},this.triggerMethod("before:destroy",t),this.triggerMethod("destroy",t),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,t)},show:function(t,e){if(this._ensureElement()){this._ensureViewIsIntact(t),o.MonitorDOMRefresh(t);var n=e||{},r=t!==this.currentView,s=!!n.preventDestroy,a=!!n.forceShow,l=!!this.currentView,c=r&&!s,u=r||a;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,e),this.currentView&&r&&delete this.currentView._parent,c?this.empty():l&&u&&this.currentView.off("destroy",this.empty,this),u){t.once("destroy",this.empty,this),t._parent=this,this._renderView(t),l&&this.triggerMethod("before:swap",t,this,e),this.triggerMethod("before:show",t,this,e),o.triggerMethodOn(t,"before:show",t,this,e),l&&this.triggerMethod("swapOut",this.currentView,this,e);var h=o.isNodeAttached(this.el),d=[],p=i.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},n);return h&&p.triggerBeforeAttach&&(d=this._displayedViews(t),this._triggerAttach(d,"before:")),this.attachHtml(t),this.currentView=t,h&&p.triggerAttach&&(d=this._displayedViews(t),this._triggerAttach(d)),l&&this.triggerMethod("swap",t,this,e),this.triggerMethod("show",t,this,e),o.triggerMethodOn(t,"show",t,this,e),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(t,e){var n=(e||"")+"attach";i.each(t,function(t){o.triggerMethodOn(t,n,t,this)},this)},_displayedViews:function(t){return i.union([t],i.result(t,"_getNestedViews")||[])},_renderView:function(t){t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t)},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(t){if(!t)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t,o._getValue(this.options.parentEl,this))},attachHtml:function(t){this.$el.contents().detach(),this.el.appendChild(t.el)},empty:function(t){var e=this.currentView,i=t||{},n=!!i.preventDestroy;return e?(e.off("destroy",this.empty,this),this.triggerMethod("before:empty",e),n||this._destroyView(),this.triggerMethod("empty",e),delete this.currentView,n&&this.$el.contents().detach(),this):this},_destroyView:function(){var t=this.currentView;t.isDestroyed||(t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():(t.remove(),t.isDestroyed=!0),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t))},attachView:function(t){return this.currentView&&delete this.currentView._parent,t._parent=this,this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(t,e){if(i.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(i.isFunction(t))return this._buildRegionFromRegionClass(t);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,e){var n=t.regionClass||e,r=i.omit(t,"selector","regionClass");return t.selector&&!r.el&&(r.el=t.selector),new n(r)},_buildRegionFromRegionClass:function(t){return new t}}),o.RegionManager=o.Controller.extend({constructor:function(t){this._regions={},this.length=0,o.Controller.call(this,t),this.addRegions(this.getOption("regions"))},addRegions:function(t,e){return t=o._getValue(t,this,arguments),i.reduce(t,function(t,n,r){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,e)),t[r]=this.addRegion(r,n),t},{},this)},addRegion:function(t,e){var i;return i=e instanceof o.Region?e:o.Region.buildRegion(e,o.Region),this.triggerMethod("before:add:region",t,i),i._parent=this,this._store(t,i),this.triggerMethod("add:region",t,i),i},get:function(t){return this._regions[t]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return i.each(this._regions,function(t,e){this._remove(e,t)},this),t},emptyRegions:function(){var t=this.getRegions();return i.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]||this.length++,this._regions[t]=e},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete e._parent,delete this._regions[t],this.length--,this.triggerMethod("remove:region",t,e)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(t){this.templateId=t},i.extend(o.TemplateCache,{templateCaches:{},get:function(t,e){var i=this.templateCaches[t];return i||(i=new o.TemplateCache(t),this.templateCaches[t]=i),i.load(e)},clear:function(){var t,e=i.toArray(arguments),n=e.length;if(n>0)for(t=0;t<n;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),i.extend(o.TemplateCache.prototype,{load:function(t){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId,t);return this.compiledTemplate=this.compileTemplate(e,t),this.compiledTemplate},loadTemplate:function(t,i){var n=e.$(t);if(!n.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return n.html()},compileTemplate:function(t,e){return i.template(t,e)}}),o.Renderer={render:function(t,e){if(!t)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=i.isFunction(t)?t:o.TemplateCache.get(t);return n(e)}},o.View=e.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(t){this.render=i.bind(this.render,this),t=o._getValue(t,this),this.options=i.extend({},i.result(this,"options"),t),this._behaviors=o.Behaviors(this),e.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,i.rest(arguments))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return e=o._getValue(e,this),i.extend(t,e)},normalizeUIKeys:function(t){var e=i.result(this,"_uiBindings");return o.normalizeUIKeys(t,e||i.result(this,"ui"))},normalizeUIValues:function(t,e){var n=i.result(this,"ui"),r=i.result(this,"_uiBindings");return o.normalizeUIValues(t,r||n,e)},configureTriggers:function(){if(this.triggers){var t=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(t,function(t,e,i){return t[i]=this._buildViewTrigger(e),t},{},this)}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var n=o._getValue(t||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(t)&&(this.events=n);var r={},s=i.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=i.result(this,"behaviorTriggers")||{};i.extend(r,s,n,a,l),e.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return e.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var t=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",t),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=i.result(this,"_uiBindings");this.ui={},i.each(t,function(t,e){this.ui[e]=this.$(t)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=i.defaults({},t,{preventDefault:!0,stopPropagation:!0}),n=i.isObject(t)?e.event:t;return function(t){t&&(t.preventDefault&&e.preventDefault&&t.preventDefault(),t.stopPropagation&&e.stopPropagation&&t.stopPropagation());var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(n,i)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),t},_triggerEventOnBehaviors:function(t){for(var e=o._triggerMethod,i=this._behaviors,n=0,r=i&&i.length;n<r;n++)e(i[n],t)},_triggerEventOnParentLayout:function(t,e){var n=this._parentLayoutView();if(n){var r=o.getOption(n,"childViewEventPrefix"),s=r+":"+t,a=[this].concat(e);o._triggerMethod(n,s,a);var l=o.getOption(n,"childEvents");l=o._getValue(l,n);var c=n.normalizeMethods(l);c&&i.isFunction(c[t])&&c[t].apply(n,a)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var t=this._getImmediateChildren();return t.length?i.reduce(t,function(t,e){return e._getNestedViews?t.concat(e._getNestedViews()):t},t):t},_parentLayoutView:function(){for(var t=this._parent;t;){if(t instanceof o.LayoutView)return t;t=t._parent}},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var t=[this.model||this.collection];return arguments.length&&t.push.apply(t,arguments),this.model?this.serializeModel.apply(this,t):{items:this.serializeCollection.apply(this,t)}},serializeCollection:function(t){return t.toJSON.apply(t,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(t!==!1){if(!t)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.mixinTemplateHelpers(this.serializeData()),i=o.Renderer.render(t,e,this);return this.attachElContent(i),this}},attachElContent:function(t){return this.$el.html(t),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(t){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var t,e=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),e&&this._triggerBeforeAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),e&&this._triggerAttach&&(t=this._getNestedViews(),this._triggerMethodMany(t,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(t,e,n){var r=i.drop(arguments,3);i.each(t,function(t){o.triggerMethodOn.apply(t,[t,n,t,e].concat(r))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t,e,n){var r=void 0!==n.at&&(n.index||e.indexOf(t));if((this.getOption("filter")||r===!1)&&(r=i.indexOf(this._filteredSortedModels(r),t)),this._shouldAddChild(t,r)){this.destroyEmptyView();var o=this.getChildView(t);this.addChild(t,o,r)}},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(t){o.triggerMethodOn(t,"before:show",t)})},_onShowCalled:function(){this.children.each(function(t){o.triggerMethodOn(t,"show",t)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var t=this.children,e=this._filteredSortedModels();if(!e.length&&this._showingEmptyView)return this;var n=i.some(e,function(e){return!t.findByModel(e)});if(n)this.render();else{var r=i.map(e,function(e,i){var n=t.findByModel(e);return n._index=i,n.el}),o=t.filter(function(t){return!i.contains(r,t.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),i.each(o,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var t=this._filteredSortedModels(),e=i.find(t,function(t,e){var i=this.children.findByModel(t);return!i||i._index!==e},this);e&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(t){this.$el.append(t)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var t,e=this._filteredSortedModels();i.each(e,function(e,i){t=this.getChildView(e),this.addChild(e,t,i)},this)},_filteredSortedModels:function(t){var e=this.getViewComparator(),n=this.collection.models;if(t=Math.min(Math.max(t,0),n.length-1),e){var r;t&&(r=n[t],n=n.slice(0,t).concat(n.slice(t+1))),n=this._sortModelsBy(n,e),r&&n.splice(t,0,r)}return this.getOption("filter")&&(n=i.filter(n,function(t,e){return this._shouldAddChild(t,e)},this)),n},_sortModelsBy:function(t,e){return"string"==typeof e?i.sortBy(t,function(t){return t.get(e)},this):1===e.length?i.sortBy(t,e,this):t.sort(i.bind(e,this))},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new e.Model;this.addEmptyView(i,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var n,r=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),s=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(s)&&(s=s.call(this,t,this._emptyViewIndex));var a=this.buildChildView(t,e,s);a._parent=this,this.proxyChildEvents(a),a.once("render",function(){this._isShown&&o.triggerMethodOn(a,"before:show",a),r&&this._triggerBeforeAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"before:attach"))},this),this.children.add(a),this.renderChildView(a,this._emptyViewIndex),r&&this._triggerAttach&&(n=this._getViewAndNested(a),this._triggerMethodMany(n,this,"attach")),this._isShown&&o.triggerMethodOn(a,"show",a)},getChildView:function(t){var e=this.getOption("childView");if(!e)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(t,e,i){var n=this.getOption("childViewOptions");n=o._getValue(n,this,[t,i]);var r=this.buildChildView(t,e,n);return this._updateIndices(r,!0,i),this.triggerMethod("before:add:child",r),this._addChildView(r,i),this.triggerMethod("add:child",r),r._parent=this,r},_updateIndices:function(t,e,i){this.getOption("sort")&&(e&&(t._index=i),this.children.each(function(i){i._index>=t._index&&(i._index+=e?1:-1)}))},_addChildView:function(t,e){var i,n=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(t),t.once("render",function(){this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"before:show",t),n&&this._triggerBeforeAttach&&(i=this._getViewAndNested(t),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(t),this.renderChildView(t,e),n&&this._triggerAttach&&(i=this._getViewAndNested(t),this._triggerMethodMany(i,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"show",t)},renderChildView:function(t,e){return t.supportsRenderLifecycle||o.triggerMethodOn(t,"before:render",t),t.render(),t.supportsRenderLifecycle||o.triggerMethodOn(t,"render",t),this.attachHtml(this,t,e),t},buildChildView:function(t,e,n){var r=i.extend({model:t},n),s=new e(r);return o.MonitorDOMRefresh(s),s},removeChildView:function(t){return t?(this.triggerMethod("before:remove:child",t),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"before:destroy",t),t.destroy?t.destroy():t.remove(),t.supportsDestroyLifecycle||o.triggerMethodOn(t,"destroy",t),delete t._parent,this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1),t):t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t,e){t.$el.append(e)},_createBuffer:function(){var t=document.createDocumentFragment();return i.each(this._bufferedChildren,function(e){t.appendChild(e.el)}),t},attachHtml:function(t,e,i){t.isBuffering?t._bufferedChildren.splice(i,0,e):t._insertBefore(e,i)||t._insertAfter(e)},_insertBefore:function(t,e){var i,n=this.getOption("sort")&&e<this.children.length-1;return n&&(i=this.children.find(function(t){return t._index===e+1})),!!i&&(i.$el.before(t.el),!0)},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(t){var e=t||{},n=!0,r=this.children.map(i.identity);return i.isUndefined(e.checkEmpty)||(n=e.checkEmpty),this.children.each(this.removeChildView,this),n&&this.checkEmpty(),r},_shouldAddChild:function(t,e){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,t,e,this.collection)},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",function(){var n=i.toArray(arguments),r=n[0],o=this.normalizeMethods(i.result(this,"childEvents"));n[0]=e+":"+r,n.splice(1,0,t),"undefined"!=typeof o&&i.isFunction(o[r])&&o[r].apply(this,n.slice(1)),
this.triggerMethod.apply(this,n)})},_getImmediateChildren:function(){return i.values(this.children._views)},_getViewAndNested:function(t){return[t].concat(i.result(t,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(t){var e=this.getOption("childView")||this.constructor;return e},serializeData:function(){var t={};return this.model&&(t=i.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),i=o.Renderer.render(e,t,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t,e){var i=this.getChildViewContainer(t);i.append(e)},_insertAfter:function(t){var e=this.getChildViewContainer(this,t);e.append(t.el)},_appendReorderedChildren:function(t){var e=this.getChildViewContainer(this);e.append(t)},getChildViewContainer:function(t,e){if(t.$childViewContainer)return t.$childViewContainer;var i,n=o.getOption(t,"childViewContainer");if(n){var r=o._getValue(n,t);if(i="@"===r.charAt(0)&&t.ui?t.ui[r.substr(4)]:t.$(r),i.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else i=t.$el;return t.$childViewContainer=i,i},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(t,e,n){var r=this.getRegion(t);return r.show.apply(r,i.rest(arguments))},getChildView:function(t){return this.getRegion(t).currentView},addRegion:function(t,e){var i={};return i[t]=e,this._buildRegions(i)[t]},addRegions:function(t){return this.regions=i.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(t,e)},_initializeRegions:function(t){var e;this._initRegionManager(),e=o._getValue(this.regions,this,[t])||{};var n=this.getOption.call(t,"regions");n=o._getValue(n,this,[t]),i.extend(e,n),e=this.normalizeUIValues(e,["selector","el"]),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this.regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this.regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this.regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(t,e){this.view=e,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,t),this.ui=i.extend({},i.result(e,"ui"),i.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el}}),o.Behaviors=function(t,e){function i(t,n){return e.isObject(t.behaviors)?(n=i.parseBehaviors(t,n||e.result(t,"behaviors")),i.wrap(t,n,e.keys(s)),n):{}}function n(t,e){this._view=t,this._behaviors=e,this._triggers={}}function r(t){return t._uiBindings||t.ui}var o=/^(\S+)\s*(.*)$/,s={behaviorTriggers:function(t,e){var i=new n(this,e);return i.buildBehaviorTriggers()},behaviorEvents:function(i,n){var s={};return e.each(n,function(i,n){var a={},l=e.clone(e.result(i,"events"))||{};l=t.normalizeUIKeys(l,r(i));var c=0;e.each(l,function(t,r){var s=r.match(o),l=s[1]+"."+[this.cid,n,c++," "].join(""),u=s[2],h=l+u,d=e.isFunction(t)?t:i[t];d&&(a[h]=e.bind(d,i))},this),s=e.extend(s,a)},this),s}};return e.extend(i,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(e,n){return e.behaviorClass?e.behaviorClass:t._getValue(i.behaviorsLookup,this,[e,n])[n]},parseBehaviors:function(t,n){return e.chain(n).map(function(n,r){var o=i.getBehaviorClass(n,r),s=new o(n,t),a=i.parseBehaviors(t,e.result(s,"behaviors"));return[s].concat(a)}).flatten().value()},wrap:function(t,i,n){e.each(n,function(n){t[n]=e.partial(s[n],t[n],i)})}}),e.extend(n.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var o=e.clone(e.result(i,"triggers"))||{};o=t.normalizeUIKeys(o,r(i)),e.each(o,e.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(t,e,i,n){var r=n.replace(/^\S+/,function(t){return t+".behaviortriggers"+e});this._triggers[r]=this._view._buildViewTrigger(i)}}),i}(o,i),o.AppRouter=e.Router.extend({constructor:function(t){this.options=t||{},e.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var i=this._getController();this._addAppRoute(i,t,e)},_processOnRoute:function(t,e){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[t];this.onRoute(t,n,e)}},processAppRoutes:function(t,e){if(e){var n=i.keys(e).reverse();i.each(n,function(i){this._addAppRoute(t,i,e[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,n){var r=t[n];if(!r)throw new o.Error('Method "'+n+'" was not found on the controller');this.route(e,n,i.bind(r,t))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(t){this._initializeRegions(t),this._initCallbacks=new o.Callbacks,this.submodules={},i.extend(this,t),this._initChannel(),o.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var n=o.Module.getClass(e),r=i.toArray(arguments);return r.unshift(this),n.create.apply(n,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(t){var e=i.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var n=o.getOption(t,"regions");return i.isFunction(n)&&(n=n.call(this,t)),i.extend(e,n),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(t,e){this[t]=e,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(t){delete this[t],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),o.Module=function(t,e,n){this.moduleName=t,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,i.isFunction(this.initialize)&&this.initialize(t,e,this.options)},o.Module.extend=o.extend,i.extend(o.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(i.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,n){if(t){var r=i.flatten([this,this.app,e,o,e.$,i,n]);t.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),i.extend(o.Module,{create:function(t,e,n){var r=t,o=i.drop(arguments,3);e=e.split(".");var s=e.length,a=[];return a[s-1]=n,i.each(e,function(e,i){var s=r;r=this._getModule(s,e,t,n),this._addModuleDefinition(s,r,a[i],o)},this),r},_getModule:function(t,e,n,r,o){var s=i.extend({},r),a=this.getClass(r),l=t[e];return l||(l=new a(e,n,s),t[e]=l,t.submodules[e]=l),l},getClass:function(t){var e=o.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,i,n){var r=this._getDefine(i),o=this._getStartWithParent(i,e);r&&e.addDefinition(r,n),this._addStartWithParent(t,e,o)},_getStartWithParent:function(t,e){var n;return i.isFunction(t)&&t.prototype instanceof o.Module?(n=e.constructor.prototype.startWithParent,!!i.isUndefined(n)||n):!i.isObject(t)||(n=t.startWithParent,!!i.isUndefined(n)||n)},_getDefine:function(t){return!i.isFunction(t)||t.prototype instanceof o.Module?i.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,i){e.startWithParent=e.startWithParent&&i,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PCDataController=e.TestDataController=e.BaseDataController=void 0;var r=i(2),o=i(4),s=(n(o),i(53)),a=n(s),l=i(55),c=n(l),u=i(61),h=n(u),d=i(62),p=a.default.Controller.extend({getCookie:function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var r=i[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return r.substring(e.length,r.length)}return""},resetExpandedForMobile:function(){},getPreviousChat:function(t){var e=r.$.Deferred();return e.resolve([]),e.promise()},getContactInfo:function(){var t=r.$.Deferred(),e=this.getContactId(),i=a.default.getOption(this,"widgetId");return e&&i?r.$.ajax({url:a.default.getOption(this,"pureServerUrl")+"/api/contact/widget/"+a.default.getOption(this,"widgetId")+"/"+e}).done(function(e){t.resolve(e)}).fail(function(){console.log("Error obtaining contact details")}):setTimeout(function(){t.resolve()},0),t},initialize:function(){var t=this;this.sentChatRequest=!1,this.connectionInfo=new c.default.ChatConnection({},this.options),this.options.connectionInfo&&this.connectionInfo.set(this.options.connectionInfo),this._originalGetWidgetSettings=this.getWidgetSettings,this.getWidgetSettings=function(){var e=r.$.Deferred();return t._originalGetWidgetSettings.apply(t,arguments).done(function(t){t.widgetConfig&&t.widgetConfig.AllowWidgetOnMobile&&t.widgetConfig.RequestFromMobileDevice&&(localStorage.expanded=!1),e.resolve(t)}),e.promise()}},unbindHandlerEvents:function(){},loadWidgetSettings:function(){var t=this,e=r.$.Deferred();return this.getWidgetSettings().done(function(i){t.widgetSettings=i,e.resolve()}).fail(function(){e.reject()}),e}}),g=p.extend({initialize:function(){p.prototype.initialize.apply(this,arguments),this.chatAvailable="function"!=typeof this.setDemoUnavailable||!this.setDemoUnavailable()},startChat:function(t){return this.connectionInfo.set("userId",1),this.connectionInfo.set("authToken","adsfasfdsdf"),this.connectionInfo.set("roomId",1),r.$.Deferred().resolve(this.connectionInfo)},closeChat:function(t){return r.$.Deferred().resolve()},getContactInfo:function(){var t=r.$.Deferred();return setTimeout(function(){t.resolve({firstName:"",lastName:"",company:"",email:"",phone:""})},0),t},restartChat:function(t){return r.$.Deferred().resolve()},connectToChatServer:function(t){var e=r.$.Deferred();return this.handler=t,setTimeout(function(){e.resolve()},0),e},sendRoomHistory:function(t){},checkInRoom:function(){return!1},newMessage:function(t){var e=new Date,i=e.getHours(),n=e.getMinutes(),r=e.getSeconds(),o=i>=12;i=i<10?i:12==i?i:i%12,n=n<10?"0"+n:n,r=r<10?"0"+r:r,a.default.getOption(this,"chatModel").get("messages").add({userId:e.getTime(),type:"message",message:t,myMessage:!0,userName:"Aaron",time:i+":"+n+" "+r+(o?"PM":"AM"),date:e,avatarUrl:"/content/images/avatars/visitor.png"})},checkChatAvailable:function(t){var e=this,i=r.$.Deferred();return setTimeout(function(){i.resolve({available:e.chatAvailable})},1),i},getWidgetSettings:function(){var t={Version:27288,WidgetWording:{Id:721,AccountId:0,Title:"Chat with us test."},AccountId:1,Color:"000000",Position:2,WidgetType:1,UnavailableBehavior:2,AskForRating:!0,AskForFirstName:!0,AskForLastName:!0,AskForEmail:!1,AskForCompany:!0,AskForQuestion:!0,ForcePopout:!1,StringResources:{chat_identifyFailed:"Failed to connect to PureChat!",greeting:"Hello",closed_message:"Thanks for chatting. Please rate how you feel about the chat session:",closed_opMessage:"This chat has ended.<br/>What would you like to do?",chat_joinMessage:"{displayName} has joined the chat!",placeholder_email:"Email",chat_connecting:"Connecting you to the chat now...",chat_nowChattingWith:"Chatting with {chatUserNames}.",label_pressToBegin:"Press the button below to begin!",error_enterEmail:"Please enter an email address.",closed_downloadTrans:"Download chat transcript",title_noOperators:"No Operators Available",error_enterQuestion:"Please enter a question",noOperators_email_message:"There are currently no operators available, but feel free to send us an email!",poweredby:"Powered by",chat_noOperatorMessage:"An operator has not yet connected. Don't worry, an operator will be by shortly! When they connect, they'll see all the messages you've sent so far.",chat_typing:"{displayName} is typing",title_chatClosed:"Chat Closed",closed_ratingThanks:"Thanks for your rating!",placeholder_name:"Name",placeholder_firstName:"First Name",placeholder_lastName:"Last Name",placeholder_comapny:"Company",title_initial:"Chat with us test.",placeholder_question:"Enter your Question",label_initial_label:"Introductory Text",title_initial_label:"Widget Title",error_noOperators:"Sorry, no operators are currently available",label_initial:"Enter your info below to begin.",error_noOperators_label:"No Operators Available",button_startChat:"Send Chat Request",label_initial_helptext:"This is the introductory text that will be displayed after the user clicks on the PureChat widget.",button_sendEmail:"Send Email",chat_startedMessage:"An operator will be right with you! Feel free to hide this box and navigate around the site.",chat_leftMessage:"{displayName} has left the chat!",chat_connectionFailed:"Failed to connect to PureChat!",button_startNewChat:"Start a new chat",error_noOperators_helptext:"This is the message that will be displayed when Hide Widget When Unavailable is unchecked, and there are no operators available.",error_enterName:"Please enter a name.",mobile_expandButton:"Chat!",mobile_expandButton_label:"Mobile Title"},GoogId:"UA-XXXX-Y",GaTrackingTab:!1,GaTrackingChat:!1,GaTrackingThumbs:!1,GATabEvent:"Tab Opened",GAChatEvent:"Chat Started",GAUpThumbEvent:"Thumbs Up",GADownThumbEvent:"Thumbs Down",GAEventCategory:"PureChat widget",UsingGa:!1,ChatServerUrl:"http://chad.purechat.com:8000",DisplayWidgetAnimation:"bounceInDown",CollapsedWidgetImageUrl:"http://chad.purechat.com/Content/images/widgetSamples/operator1.png"};return r.$.Deferred().resolve(t)},rateChat:function(t){var e=r.$.Deferred();return e.resolve()},setTypingIndicator:function(t){},bindEvents:function(t){this.handler=t}}),f=p.extend({sessionTimeout:12e5,timeStampUrl:function(t){var e=new Date;return t.indexOf("?")>=0?t+"&t="+e.getTime():t+"?t="+e.getTime()},closeChat:function(t){return this.chatServerConnection.destroyself(null,t),r.$.Deferred().resolve()},leaveChat:function(){return this.chatServerConnection.leave(this.connectionInfo.get("roomId")),r.$.Deferred().resolve()},restartChat:function(t){return this.connectionInfo.clearLocalStorage(),r.$.Deferred().resolve()},newMessage:function(t){return""!=r.$.trim(t)&&(""!=r.$.trim(t)&&void this.chatServerConnection.sendmessage(t,this.connectionInfo.get("roomId")))},checkChatAvailable:function(t){var e=this;t=t||this.widgetSettings.accountId;var i=!1;if(this.options.BrowserDetails){var n=this.options.BrowserDetails.Version,o=parseInt(n);("Opera"==this.options.BrowserDetails.Browser&&o<12||"InternetExplorer"==this.options.BrowserDetails.Browser.replace(/\s+/g,"")&&o<=9||"Safari"==this.options.BrowserDetails.Browser&&o<5&&o>0)&&(i=!0)}if(!window._checkChatAvailableDeferred)if(window._checkChatAvailableDeferred=r.$.Deferred(),i)setTimeout(function(){window._checkChatAvailableDeferred.resolve({a:0,r:2})},300);else{var s={accountId:t,widgetId:this.options?this.options.connectionSettings&&this.options.connectionSettings.c?this.options.connectionSettings.c:this.options.widgetId||this.options.Id:null},l=a.default.getOption(this,"pureServerUrl")+"/VisitorWidget/ChatAvailable/"+s.accountId+"/"+s.widgetId+"/_PCcb?externalRequest=false";r.$.ajax({url:e.timeStampUrl(l),dataType:"jsonp",timeout:2e4,jsonpCallback:"_PCcb",error:function(){window._checkChatAvailableDeferred.reject(),window._checkChatAvailableDeferred=null}})}return window._checkChatAvailableDeferred.promise()},getDashboardVersion:function(){return r.$.ajax({url:a.default.getOption(this,"pureServerUrl")+"/version",dataType:"jsonp",timeout:2e4})},getWidgetSettings:function(){var t=this,e="boolean"==typeof a.default.getOption(this,"hasAllSettings")&&a.default.getOption(this,"hasAllSettings"),i=r.$.Deferred();return e?i.resolve({success:!0,version:a.default.getOption(this,"Version"),accountId:a.default.getOption(this,"AccountId"),color:a.default.getOption(this,"Color"),position:a.default.getOption(this,"Position"),widgetType:a.default.getOption(this,"WidgetType"),widgetConfig:this.options,resources:a.default.getOption(this,"StringResources"),googleAnalytics:a.default.getOption(this,"GoogleAnalytics"),chatServerUrl:a.default.getOption(this,"ChatServerUrl"),userWidgetConfig:a.default.getOption(this,"UserWidgetSettings")}):r.$.when(t.getDashboardVersion(),r.$.ajax({url:a.default.getOption(this,"pureServerUrl")+"/VisitorWidget/Widget/"+a.default.getOption(this,"widgetId"),dataType:"jsonp",timeout:2e4})).done(function(e,n){var o=e[0].v,s=n[0];if(s.Valid){0==s.UnavailableBehavior&&t.options.isDirectAccess&&(s.UnavailableBehavior=1),s.UserWidgetSettings=new r.backbone.Model(s.UserWidgetSettings);var a={success:!0,version:o,accountId:s.AccountId,color:s.Color,position:s.Position,widgetType:s.WidgetType,widgetConfig:s,resources:s.StringResources,googleAnalytics:s.GoogleAnalytics,chatServerUrl:s.ChatServerUrl,userWidgetConfig:s.UserWidgetSettings};i.resolve(a)}}).fail(function(){i.reject()}),i.promise()},submitEmailForm:function(t){var e,i=null;try{e=this.cleanNulls(localStorage.getItem("i")),this.isActiveSession()&&(i=this.cleanNulls(localStorage.getItem(this.getSessionItemName())))}catch(t){}t.widgetId=a.default.getOption(this,"widgetId"),t.startPage=t.origin||window.location.toString()||"unknown",t.acquisitionSource=localStorage.acquisitionSource||"Direct",t.pccId=e,t.pccsId=i;var n=r.$.Deferred();return r.$.ajax({url:a.default.getOption(this,"pureServerUrl")+"/VisitorWidget/SendEmail",dataType:"jsonp",type:"GET",data:t}).done(function(t){try{response.customerId&&localStorage.setItem("i",response.customerId)}catch(t){}n.resolve(t)}).fail(function(){}),n.promise()},cleanNulls:function(t){return"null"==t?void 0:null==t?void 0:t},getSessionItemName:function(){return"s_"+this.widgetSettings.accountId},getLastCheckinItemName:function(){return"lastCheckin_"+this.widgetSettings.accountId},isActiveSession:function(){var t=Date.now(),e=this.getLastCheckinItemName(),i=this.cleanNulls(localStorage.getItem(e));return!(i&&t-i>=this.sessionTimeout)},getContactId:function(){try{return this.cleanNulls(localStorage.getItem("i"))}catch(t){return null}},getSessionId:function(){var t=null;try{this.isActiveSession()&&(t=this.cleanNulls(localStorage.getItem(this.getSessionItemName())))}catch(t){}return t},startChat:function(t){var e=this,i=r.$.Deferred(),n=this.getContactId(),o=this.getSessionId(),s=t.visitorName,l=t.visitorFirstName,c=t.visitorLastName,u=t.visitorCompany,h=a.default.getOption(this,"pureServerUrl")+"/VisitorWidget/Chat/"+a.default.getOption(this,"widgetId")+"?visitorName="+encodeURIComponent(s||"")+"&visitorFirstName="+encodeURIComponent(l||"")+"&visitorLastName="+encodeURIComponent(c||"")+"&visitorCompany="+encodeURIComponent(u||"")+"&origin="+encodeURIComponent(t.origin||window.location.toString()||"unknown")+"&expandSource="+(window.localStorage.getItem("expandSource")||"")+"&acquisitionSource="+(localStorage.acquisitionSource||"Direct")+"&operatorJoinIds="+encodeURIComponent((t.operatorJoinIds||[]).join(","))+"&initiator="+encodeURIComponent(t.initiator||"")+"&startedByOperator="+(t.startedByOperator||!1).toString()+"&pccid="+n+"&pccsid="+o+"&hubspotUtk="+(0,d.getHubspotId)()+"&sentChatRequest="+(this.sentChatRequest||!1).toString();return t.visitorEmail&&(h+="&visitorEmail="+encodeURIComponent(t.visitorEmail)),t.visitorPhoneNumber&&(h+="&visitorPhoneNumber="+encodeURIComponent(t.visitorPhoneNumber)),t.visitorQuestion&&1!=t.initiator&&(h+="&visitorQuestion="+encodeURIComponent(t.visitorQuestion)),this.sentChatRequest||(this.sentChatRequest=!0),r.$.ajax({url:h,dataType:"jsonp",timeout:2e4,success:function(t){if(t.user&&t.room){try{t.customerId&&localStorage.setItem("i",t.customerId)}catch(t){}e.connectionInfo.set({userId:t.user.id,authToken:t.user.authToken,roomId:t.room.id,chatId:t.chat.id,chatClosed:!1}),e.widgetSettings.chatServerUrl=t.server.url,i.resolve(e.connectionInfo)}else"undefined"!=typeof connectingView&&null!==connectingView&&connectingView.showErrorMessage(t.message),i.reject(t.message);i.resolve()},error:function(t,e,n){i.reject(e+", "+n)},complete:function(){setTimeout(function(){e.sentChatRequest=!1},0)}}),i},connectToChatServer:function(t){function e(t,e,r,o){i=!0,0==t?n.reject():n.resolve()}var i,n=r.$.Deferred(),o=o||this.widgetSettings.accountId;return!this.chatServerConnection||this.chatServerConnection.socket.disconnected?(this.chatServerConnection=new h.default(this.widgetSettings.chatServerUrl+"/client",this.connectionInfo.get("userId"),o,this.connectionInfo.get("authToken"),e,function(){i||n.reject()},null,"boolean"==typeof this.options.connectionSettings.poppedOut&&this.options.connectionSettings.poppedOut),t&&this.bindEvents(t)):(this.chatServerConnection.identify(this.connectionInfo.get("userId"),o,this.connectionInfo.get("authToken"),e,"boolean"==typeof this.options.connectionSettings.poppedOut&&this.options.connectionSettings.poppedOut),t&&this.bindEvents(t)),n},setTypingIndicator:function(t){this.chatServerConnection.sendtyping(this.connectionInfo.get("roomId"),t)},rateChat:function(t){var e=r.$.Deferred();return r.$.ajax({url:a.default.getOption(this,"pureServerUrl")+"/VisitorWidget/Rate",dataType:"jsonp",data:{chatId:this.connectionInfo.get("chatId"),rating:t,authToken:this.connectionInfo.get("authToken")}}).done(function(){}).fail(function(){}),e.promise()},checkInRoom:function(){return this.connectionInfo.isInChat()||this.connectionInfo.loadFromLocalStorage().isInChat()},setCurrentPage:function(t){this.chatServerConnection.setVisitorDetails(this.connectionInfo.get("roomId"),{visitorReferer:t})},sendRoomHistory:function(t){this.chatServerConnection.sendroomhistory(t||this.connectionInfo.get("roomId"))},unbindHandlerEvents:function(){p.prototype.unbindHandlerEvents.apply(this,arguments),this.unbindHandlerEventsImpl&&this.unbindHandlerEventsImpl()},bindEvents:function(t){var e=this;e.handler=t;var i={message:function(i,n,r,o,s,a,l,c){e.connectionInfo.get("roomId")==r&&(a=a.replace("response below to see hos it works","response below to see how it works"),t.onMessage.apply(t,arguments))},joined:function(i,n,r,o,s,a){e.connectionInfo.get("roomId")==r&&t.onJoined.apply(t,arguments)},left:function(i,n,r,o,s,a){e.connectionInfo.get("roomId")==r&&t.onLeft.apply(t,arguments)},roomdestroyed:function(i,n,r){e.connectionInfo.get("roomId")==i&&t.onRoomDestroyed.apply(t,arguments)},typing:function(i,n,r,o,s,a){e.connectionInfo.get("userId")!=i&&e.connectionInfo.get("roomId")==r&&t.onTyping.apply(t,arguments)},userDestroyed:function(i){e.connectionInfo.get("userId")==i&&t.onRoomDestroyed.apply(t)},roomdetailschanged:function(i){e.connectionInfo.get("roomId")==i.id&&t.onRoomDetailsChanged.apply(t,arguments)},roomchanged:function(i){e.connectionInfo.get("roomId")==i.room.id&&t.onRoomChanged.apply(t,arguments)},noOperatorJoined:function(i){e.connectionInfo.get("roomId")==i.roomId&&t.onNoOperatorJoined.apply(t,arguments)}};e.unbindHandlerEventsImpl=function(){e.chatServerConnection.off(i),e.handler=null},e.chatServerConnection.on(i)}});e.BaseDataController=p,e.TestDataController=g,e.PCDataController=f},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){return(0,o.$)("<div/>").html(t).text()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=i(4),a=n(s),l=i(53),c=(n(l),i(56)),u=n(c),h=i(57),d=n(h),p={};p.Chat=o.backbone.RelationalModel.extend({defaults:function(){return{participants:new p.ChatParticipantCollection}},relations:[{type:o.backbone.HasMany,key:"messages",relatedModel:"Message",collectionType:"MessageCollection",reverseRelation:{key:"chat"}},{type:o.backbone.HasMany,key:"operators",relatedModel:"Operator",collectionType:"OperatorCollection",reverseRelation:{key:"chat"}},{type:o.backbone.HasMany,key:"participants",relatedModel:"ChatParticipant",collectionType:"ChatParticipantCollection",reverseRelation:{key:"chat"}}],getFullName:function(){var t,e=this.get("visitorFirstName"),i=this.get("visitorLastName");return e?(t=e,i&&(t+=" "+i)):i&&(t=i),t||(t="Visitor"),t},restartChat:function(){this.set("visitorQuestion",null),this.get("operators").reset(),this.get("messages").reset(),this.set("state",u.default.WidgetStates.Inactive),this.trigger("chat:restart")},chatUserNames:function(){var t="";return this.get("operators").forEach(function(e){""!=t&&(t+=", "),t+=e.get("userDisplayName")}),t},isInChat:function(){return this.get("userId")&&this.get("chatId")&&this.get("authToken")},initialize:function(){var t=this;this.get("operators").on("add",function(e){t.trigger("operator:join",e)}).on("remove",function(e){t.trigger("operator:leave",e)})}}),p.Message=o.backbone.RelationalModel.extend({events:{"change:messageResource":function(){alert("test")}}}),p.MessageCollectionMessagesGrouped=o.backbone.Collection.extend({initialize:function(t,e){var i=this;this.proxy=e.collection,this.listenTo(this.proxy,"add",function(t,e,n){t.set("message",d.default.formatWhitespace(t.get("message")));var r=t.toJSON(),o=null;e.every(function(e){if(e.cid==t.cid){if(null==o||"message"!=o.get("type")||"message"!=e.get("type")||o.get("userId")!=e.get("userId")){var n=i.add(r);return t.set("relatedCid",n.cid),!1}var s=i.get(o.get("relatedCid"));if(s){var a=s.get("message");a=a+" <div class='purechat-line-break'></div> "+e.get("message"),s.set("message",a),s.set("time",e.get("time")),t.set("relatedCid",o.get("relatedCid"))}}return o=e,!0})})},comparator:function(t,e){var i=t.get("date").getTime()-e.get("date").getTime();return 0==i?t.cid<e.cid?-1:1:i}}),p.MessageCollection=o.backbone.Collection.extend({model:p.Message,add:function(t,e){if(t){var i=a.default.isArray(t)?t:[t];i.forEach(function(t){t.timeAdded=(new Date).getTime()})}return o.backbone.Collection.prototype.add.apply(this,arguments)},comparator:function(t,e){var i=t.get("date").getTime()-e.get("date").getTime();return 0==i?t.cid<e.cid?-1:1:i}}),p.Operator=o.backbone.RelationalModel.extend({idAttribute:"userId"}),p.OperatorCollection=o.backbone.Collection.extend({model:p.Operator}),p.ChatParticipant=o.backbone.RelationalModel.extend({idAttribute:"userId"}),p.ChatParticipantCollection=o.backbone.Collection.extend({model:p.ChatParticipant,getOperatorTypingText:function(t){var e=this.where({isTyping:!0});if(e&&0!==e.length){var i="";return a.default.each(e,function(e,n){0!=n&&(i+=", ");var s=o.$.trim(e.get("displayName"));i="<span data-resourcekey='chat_typing'>"+r(i+a.default.escape(t.getResource("chat_typing",{displayName:s})))+"...</span>"}),i}return""}}),p.WidgetSettings=o.backbone.RelationalModel.extend({getResource:function(t,e){var i=this.get("StringResources");if(!i)return t;if(e){var n=i[t]||"";return n+="",e.displayName||(n=n.replace("{displayName}","")),e.chatUserNames||(n=n.replace("{chatUserNames}","")),self.compiledResources||(self.compiledResources={}),self.compiledResources[n]||(self.compiledResources[n]=a.default.template(n,null,{interpolate:/\{(.+?)\}/g})),self.compiledResources[n](e)}return i[t]},isTabTop:function(){return 3==this.get("Position")||4==this.get("Position")},isTabLeft:function(){
return 1==this.get("Position")||3==this.get("Position")},_isDesktopDimension:null,isDesktopDimension:function(){if(!this._isDesktopDimension){var t=(0,o.$)(window).height(),e=(0,o.$)(window).width(),i=625,n=625;this._isDesktopDimension=this.get("isDemo")||t>=i&&e>=n}return this._isDesktopDimension},isMobileRequest:function(){return this.get("RequestFromMobileDevice")},isAllowedOnMobile:function(){return this.get("MobileDisplayType")===u.default.MobileDisplayTypes.MobileOptimized||!!this.get("Demo")},useMobile:function(){return this.isMobileRequest()&&this.isAllowedOnMobile()},showTab:function(){var t=this.useMobile(),e=this.isDesktopDimension();return this.get("CollapsedStyle")==u.default.WidgetType.Tab||this.get("CollapsedStyle")==u.default.WidgetType.ImageTab||t&&!e&&this.get("CollapsedStyle")!=u.default.WidgetType.Button},showImage:function(){return this.get("CollapsedStyle")==u.default.WidgetType.Image||this.get("CollapsedStyle")==u.default.WidgetType.ImageTab},collapsedImageCss:function(t){var e=t?this.get("AvailableImageScale"):this.get("UnavailableImageScale"),i=e/100,n=(t?this.get("AvailableImageWidth"):this.get("UnavailableImageWidth"))*i,r=(t?this.get("AvailableImageHeight"):this.get("UnavailableImageHeight"))*i,o=0,s=t?this.get("AvailableImageYOffset"):this.get("UnavailableImageYOffset");this.isTabTop()?(o=this.showTab()?60:0,o+=s||0):(o=-(r+(s||0)),this.showTab()||(o-=10));var a=t?this.get("AvailableImageWidth"):this.get("UnavailableImageWidth"),l=(t?this.get("AvailableImageHeight"):this.get("UnavailableImageHeight"),t?this.get("AvailableImageTop"):this.get("UnavailableImageTop")),c=["position:absolute;","margin-top: "+o+"px;","width: "+a*i+"px;","max-width: "+a*i+"px;","top: 0px;","z-index: "+(l?2:0)+";"],u=t?this.get("AvailableImageXOffset"):this.get("UnavailableImageXOffset");this.showTab()?(c.push("left: 50%;"),c.push("margin-left: "+-(n/2-(u||0))+"px;")):this.isTabLeft()?(c.push("left: 50%;"),c.push("margin-left: "+(u||0)+"px;")):(c.push("right: 50%;"),c.push("margin-right: "+-(u||0)+"px;"));var h=c.join("");return h},poweredByUrl:function(){return"http://www.purechat.com?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=widget&utm_campaign=poweredby"},absoluteCollapsedImageUrl:function(t){return t?this.absoluteUrl(this.get("AvailableCollapsedWidgetImageUrl")):this.absoluteUrl(this.get("UnavailableCollapsedWidgetImageUrl"))},absoluteUrl:function(t){t=(t||"").trim();var e=0==t.indexOf("~");return 1==t.length&&e?null:e?this.get("cdnServerUrl")+t.substring(1):t},formatDateTime:function(t){var e=new Date(t),i=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear();return i+=" "+(e.getHours()%12==0?"12":e.getHours()%12)+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+(e.getHours()>=12?"PM":"AM")},browserIsUnsupported:function(){var t=!1,e=this.get("BrowserDetails");switch(e.Version=parseFloat(e.Version),e.Browser.toLowerCase().replace(/s+/g,"")){case"internetexplorer":case"ie":e.Version<=9&&(t=!0);break;case"safari":e.Version<5&&(t=!0);break;case"opera":e.Version<12&&(t=!0)}return t}}),p.WidgetSettingsCollection=o.backbone.Collection.extend({model:p.WidgetSettings}),p.ChatConnection=o.backbone.Model.extend({defaults:{chatClosed:!1},initialize:function(t,e){var i=this;e.isOperator||e.poppedOut||setInterval(function(){i.loadFromLocalStorage()},2e3),this.listenTo(this,"change:userId, change:authToken, change:chatClosed",function(){this.trigger("change:isInChat",this,this.isInChat())})},persistedKeys:["userId","authToken","roomId","chatId","visitorName","disabled","chatActiveInOtherWindow","chatClosed","expandSource"],persistLocalStorage:function(){var t=this;return a.default.each(t.persistedKeys,function(e){void 0!=t.get(e)&&(localStorage["purechat_"+e]=t.get(e))}),t},clearLocalStorage:function(){var t=this;return a.default.each(t.persistedKeys,function(t){delete localStorage[t]}),this.clear(),t},loadFromLocalStorage:function(){var t=this;return a.default.each(t.persistedKeys,function(e){t.set(e,localStorage["purechat_"+e])}),t},isInChat:function(){return this.get("userId")&&this.get("authToken")&&(a.default.isUndefined(this.get("chatClosed"))||"false"==this.get("chatClosed")||!this.get("chatClosed"))}}),e.default=p},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={};i.WidgetType={Tab:1,Button:2,Image:3,ImageTab:4},i.BasicWidgetType=1,i.PersonalChatType=2,i.WidgetStates={Initializing:"PCStateInitializing",Inactive:"PCStateInactive",Activating:"PCStateActivating",Chatting:"PCStateChatting",Closed:"PCStateClosed",Unavailable:"PCStateUnavailable",Unsupported:"PCStateUnsupported",EmailForm:"PCStateEmailForm"},i.Features={VisitorTracking:1},i.FeatureStatus={Disabled:0,Enabled:1,Off:-1},i.MobileDisplayTypes={Hidden:0,SameAsDesktop:1,MobileOptimized:2},e.default=i},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var i=escape(e);document.cookie=t+"="+i}function o(t){var e=document.cookie,i=e.indexOf(" "+t+"=");if(i==-1&&(i=e.indexOf(t+"=")),i==-1)e=null;else{i=e.indexOf("=",i)+1;var n=e.indexOf(";",i);n==-1&&(n=e.length),e=unescape(e.substring(i,n))}return e}function s(t){return 1==t?"Available":2==t?"NoOperators":3==t?"ServerDowntime":4==t?"AccountActivity":5==t?"ChatQuotaExceeded":6==t?"WidgetDisabled":7==t?"IpIsbanned":""}Object.defineProperty(e,"__esModule",{value:!0}),e.getCookie=e.setCookie=void 0;var a=i(2),l=i(4),c=(n(l),i(53)),u=(n(c),i(58)),h=n(u),d=i(59),p=n(d),g=i(60),f=n(g),m={};a.$.throttle=function(t,e,i,n){function r(){function r(){s=+new Date,i.apply(l,u)}function a(){o=void 0}var l=this,c=+new Date-s,u=arguments;n&&!o&&r(),o&&clearTimeout(o),void 0===n&&c>t?r():e!==!0&&(o=setTimeout(n?a:r,void 0===n?t-c:t))}var o,s=0;return"boolean"!=typeof e&&(n=i,i=e,e=void 0),a.$.guid&&(r.guid=i.guid=i.guid||a.$.guid++),r},m.convertTimeFromUtc=function(t,e){return t},m.linkify=function(t){if(t){t=t.replace(/&amp;/gm,"&"),t=t.replace(p.default.brTags," <br/> ");var e=h.default.link(t,{stripPrefix:!1});return e}return null},m.formatWhitespace=function(t){var e=t.replace(/\n|\r/gm," <br/> ");return e=e.replace(/\t/gm," &nbsp; &nbsp; "),e.replace(/\s\s/g," &nbsp;")},m.parseEmoticons=function(t){return f.default.parse(t)},m.GaEvent=function(t,e,i){var n="GAEventCategory",r=!1,o=function(){if(window._gaq||window.ga){if(window.ga)try{window.ga("create",t.get("GoogId")),window.ga("send","event",t.get(n),t.get(i))}catch(t){r=!0,console.log("Unable to push event to Google via _gaq")}if(window.ga&&r&&window._gaq||!r&&window._gaq)try{window._gaq.push(["_setAccount",t.get("GoogId")]),window._gaq.push(["_trackEvent",t.get(n),t.get(i)])}catch(t){console.log("Unable to push event to Google via _gaq")}}};t.get("UsingGa")&&t.get(e)&&t.get(i)&&(window._gaq||window.ga||this.isOperator?this.isOperator||o():!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=!1;t.onreadystatechange=t.onload=function(t){e||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(window._gaq=window._gaq||[],o(),e=!0)},document.getElementsByTagName("head").item(0).appendChild(t)}())},m.Notifier=function(){this.isTitleModified=!1,this.windowNotifyTimeout=null,this.timeoutId=null,this.active=!1,this.mobileActive=!1,this.mobileAnimationInterval=null},m.Notifier.prototype.notify=function(t,e,i){var n=this;if(n.mouseStopElement=i,!n.active){n.active=!0;var r=document.title;e&&(originalElementTitle=e.text());var o=function i(){return 0==n.active?(document.title=r,e&&e.text(originalElementTitle),void(n.isTitleModified=!1)):(1==n.isTitleModified?(n.isTitleModified=!1,document.title=r,e&&e.text(originalElementTitle)):(n.isTitleModified=!0,document.title=t,e&&e.text(t)),void(n.timeoutId=setTimeout(i,900)))};n.timeoutId=setTimeout(o,900),n.mouseStopElement?n.mouseStopElement.on("mousemove.notifier",function(){n.stop()}):(0,a.$)(document).on("mousemove.notifier",function(){n.stop()})}},m.Notifier.prototype.stop=function(){this.active=!1,this.mouseStopElement?this.mouseStopElement.off("mousemove.notifier"):(0,a.$)(document).off("mousemove.notifier")},m.stripDangerousTags=function(t){return t.replace(/<script>.+<\/script>/gim,"")},m.stripOpenCloseTage=function(t){return t.replace(/<.+?>/gim,"")},m.escapeHtml=function(t,e){var i=(0,a.$)("<div/>");return t=i.text(t||"").html(),t.replace(/"/g,"")},"function"!=typeof Date.prototype.toHourMinuteString&&(Date.prototype.toHourMinuteString=function(){var t=this.getHours(),e=this.getMinutes(),i=this.getSeconds(),n=t>=12?" PM":" AM",r=0==t?12:t>12?t-12:t;return r+":"+(e<10?"0"+e:e)+":"+(i<10?"0"+i:i)+n}),window._PCcb=function(t){window._checkChatAvailableDeferred.resolve({available:1==t.a,reason:s(t.r)}),window._checkChatAvailableDeferred=null},e.default=m,e.setCookie=r,e.getCookie=o},function(t,e,i){var n,r,o;!function(i,s){r=[],n=s,o="function"==typeof n?n.apply(e,r):n,!(void 0!==o&&(t.exports=o))}(this,function(){var t=function(e){e=e||{},this.version=t.version,this.urls=this.normalizeUrlsCfg(e.urls),this.email="boolean"!=typeof e.email||e.email,this.twitter="boolean"!=typeof e.twitter||e.twitter,this.phone="boolean"!=typeof e.phone||e.phone,this.hashtag=e.hashtag||!1,this.newWindow="boolean"!=typeof e.newWindow||e.newWindow,this.stripPrefix="boolean"!=typeof e.stripPrefix||e.stripPrefix;var i=this.hashtag;if(i!==!1&&"twitter"!==i&&"facebook"!==i&&"instagram"!==i)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(e.truncate),this.className=e.className||"",this.replaceFn=e.replaceFn||null,this.htmlParser=null,this.matchers=null,this.tagBuilder=null};return t.link=function(e,i){var n=new t(i);return n.link(e)},t.version="0.26.0",t.prototype={constructor:t,normalizeUrlsCfg:function(t){return null==t&&(t=!0),"boolean"==typeof t?{schemeMatches:t,wwwMatches:t,tldMatches:t}:{schemeMatches:"boolean"!=typeof t.schemeMatches||t.schemeMatches,wwwMatches:"boolean"!=typeof t.wwwMatches||t.wwwMatches,tldMatches:"boolean"!=typeof t.tldMatches||t.tldMatches}},normalizeTruncateCfg:function(e){return"number"==typeof e?{length:e,location:"end"}:t.Util.defaults(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},parse:function(t){for(var e=this.getHtmlParser(),i=e.parse(t),n=0,r=[],o=0,s=i.length;o<s;o++){var a=i[o],l=a.getType();if("element"===l&&"a"===a.getTagName())a.isClosing()?n=Math.max(n-1,0):n++;else if("text"===l&&0===n){var c=this.parseText(a.getText(),a.getOffset());r.push.apply(r,c)}}return r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},compactMatches:function(t){t.sort(function(t,e){return t.getOffset()-e.getOffset()});for(var e=0;e<t.length-1;e++)for(var i=t[e],n=i.getOffset()+i.getMatchedText().length;e+1<t.length&&t[e+1].getOffset()<=n;)t.splice(e+1,1);return t},removeUnwantedMatches:function(e){var i=t.Util.remove;return this.hashtag||i(e,function(t){return"hashtag"===t.getType()}),this.email||i(e,function(t){return"email"===t.getType()}),this.phone||i(e,function(t){return"phone"===t.getType()}),this.twitter||i(e,function(t){return"twitter"===t.getType()}),this.urls.schemeMatches||i(e,function(t){return"url"===t.getType()&&"scheme"===t.getUrlMatchType()}),this.urls.wwwMatches||i(e,function(t){return"url"===t.getType()&&"www"===t.getUrlMatchType()}),this.urls.tldMatches||i(e,function(t){return"url"===t.getType()&&"tld"===t.getUrlMatchType()}),e},parseText:function(t,e){e=e||0;for(var i=this.getMatchers(),n=[],r=0,o=i.length;r<o;r++){for(var s=i[r].parseMatches(t),a=0,l=s.length;a<l;a++)s[a].setOffset(e+s[a].getOffset());n.push.apply(n,s)}return n},link:function(t){if(!t)return"";for(var e=this.parse(t),i=[],n=0,r=0,o=e.length;r<o;r++){var s=e[r];i.push(t.substring(n,s.getOffset())),i.push(this.createMatchReturnVal(s)),n=s.getOffset()+s.getMatchedText().length}return i.push(t.substring(n)),i.join("")},createMatchReturnVal:function(e){var i;if(this.replaceFn&&(i=this.replaceFn.call(this,this,e)),"string"==typeof i)return i;if(i===!1)return e.getMatchedText();if(i instanceof t.HtmlTag)return i.toAnchorString();var n=e.buildTag();return n.toAnchorString()},getHtmlParser:function(){var e=this.htmlParser;return e||(e=this.htmlParser=new t.htmlParser.HtmlParser),e},getMatchers:function(){if(this.matchers)return this.matchers;var e=t.matcher,i=this.getTagBuilder(),n=[new e.Hashtag({tagBuilder:i,serviceName:this.hashtag}),new e.Email({tagBuilder:i}),new e.Phone({tagBuilder:i}),new e.Twitter({tagBuilder:i}),new e.Url({tagBuilder:i,stripPrefix:this.stripPrefix})];return this.matchers=n},getTagBuilder:function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new t.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e}},t.match={},t.matcher={},t.htmlParser={},t.truncate={},t.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},defaults:function(t,e){for(var i in e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i]);return t},extend:function(e,i){var n=e.prototype,r=function(){};r.prototype=n;var o;o=i.hasOwnProperty("constructor")?i.constructor:function(){n.constructor.apply(this,arguments)};var s=o.prototype=new r;return s.constructor=o,s.superclass=n,delete i.constructor,t.Util.assign(s,i),o},ellipsis:function(t,e,i){return t.length>e&&(i=null==i?"..":i,t=t.substring(0,e-i.length)+i),t},indexOf:function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},remove:function(t,e){for(var i=t.length-1;i>=0;i--)e(t[i])===!0&&t.splice(i,1)},splitAndCapture:function(t,e){if(!e.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var i,n=[],r=0;i=e.exec(t);)n.push(t.substring(r,i.index)),n.push(i[0]),r=i.index+i[0].length;return n.push(t.substring(r)),n},trim:function(t){return t.replace(this.trimRegex,"")}},t.HtmlTag=t.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(e){t.Util.assign(this,e),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(t){return this.tagName=t,this},getTagName:function(){return this.tagName||""},setAttr:function(t,e){var i=this.getAttrs();return i[t]=e,this},getAttr:function(t){return this.getAttrs()[t]},setAttrs:function(e){var i=this.getAttrs();return t.Util.assign(i,e),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(t){return this.setAttr("class",t)},addClass:function(e){for(var i,n=this.getClass(),r=this.whitespaceRegex,o=t.Util.indexOf,s=n?n.split(r):[],a=e.split(r);i=a.shift();)o(s,i)===-1&&s.push(i);return this.getAttrs().class=s.join(" "),this},removeClass:function(e){for(var i,n=this.getClass(),r=this.whitespaceRegex,o=t.Util.indexOf,s=n?n.split(r):[],a=e.split(r);s.length&&(i=a.shift());){var l=o(s,i);l!==-1&&s.splice(l,1)}return this.getAttrs().class=s.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(t){return(" "+this.getClass()+" ").indexOf(" "+t+" ")!==-1},setInnerHtml:function(t){return this.innerHtml=t,this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var t=this.getTagName(),e=this.buildAttrsStr();return e=e?" "+e:"",["<",t,e,">",this.getInnerHtml(),"</",t,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var t=this.getAttrs(),e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+'="'+t[i]+'"');return e.join(" ")}}),t.RegexLib=function(){var t="A-Za-z\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",e="0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=t+e,n=new RegExp("["+i+".\\-]*["+i+"\\-]"),r=/(?:travelersinsurance|sandvikcoromant|kerryproperties|cancerresearch|weatherchannel|kerrylogistics|spreadbetting|international|wolterskluwer|lifeinsurance|construction|pamperedchef|scholarships|versicherung|bridgestone|creditunion|kerryhotels|investments|productions|blackfriday|enterprises|lamborghini|photography|motorcycles|williamhill|playstation|contractors|barclaycard|accountants|redumbrella|engineering|management|telefonica|protection|consulting|tatamotors|creditcard|vlaanderen|schaeffler|associates|properties|foundation|republican|bnpparibas|boehringer|eurovision|extraspace|industries|immobilien|university|technology|volkswagen|healthcare|restaurant|cuisinella|vistaprint|apartments|accountant|travelers|homedepot|institute|vacations|furniture|fresenius|insurance|christmas|bloomberg|solutions|barcelona|firestone|financial|kuokgroup|fairwinds|community|passagens|goldpoint|equipment|lifestyle|yodobashi|aquarelle|marketing|analytics|education|amsterdam|statefarm|melbourne|allfinanz|directory|microsoft|stockholm|montblanc|accenture|lancaster|landrover|everbank|istanbul|graphics|grainger|ipiranga|softbank|attorney|pharmacy|saarland|catering|airforce|yokohama|mortgage|frontier|mutuelle|stcgroup|memorial|pictures|football|symantec|cipriani|ventures|telecity|cityeats|verisign|flsmidth|boutique|cleaning|firmdale|clinique|clothing|redstone|infiniti|deloitte|feedback|services|broadway|plumbing|commbank|training|barclays|exchange|computer|brussels|software|delivery|barefoot|builders|business|bargains|engineer|holdings|download|security|helsinki|lighting|movistar|discount|hdfcbank|supplies|marriott|property|diamonds|capetown|partners|democrat|jpmorgan|bradesco|budapest|rexroth|zuerich|shriram|academy|science|support|youtube|singles|surgery|alibaba|statoil|dentist|schwarz|android|cruises|cricket|digital|markets|starhub|systems|courses|coupons|netbank|country|domains|corsica|network|neustar|realtor|lincoln|limited|schmidt|yamaxun|cooking|contact|auction|spiegel|liaison|leclerc|latrobe|lasalle|abogado|compare|lanxess|exposed|express|company|cologne|college|avianca|lacaixa|fashion|recipes|ferrero|komatsu|storage|wanggou|clubmed|sandvik|fishing|fitness|bauhaus|kitchen|flights|florist|flowers|watches|weather|temasek|samsung|bentley|forsale|channel|theater|frogans|theatre|okinawa|website|tickets|jewelry|gallery|tiffany|iselect|shiksha|brother|organic|wedding|genting|toshiba|origins|philips|hyundai|hotmail|hoteles|hosting|rentals|windows|cartier|bugatti|holiday|careers|whoswho|hitachi|panerai|caravan|reviews|guitars|capital|trading|hamburg|hangout|finance|stream|family|abbott|health|review|travel|report|hermes|hiphop|gratis|career|toyota|hockey|dating|repair|google|social|soccer|reisen|global|otsuka|giving|unicom|casino|photos|center|broker|rocher|orange|bostik|garden|insure|ryukyu|bharti|safety|physio|sakura|oracle|online|jaguar|gallup|piaget|tienda|futbol|pictet|joburg|webcam|berlin|office|juegos|kaufen|chanel|chrome|xihuan|church|tennis|circle|kinder|flickr|bayern|claims|clinic|viajes|nowruz|xperia|norton|yachts|studio|coffee|camera|sanofi|nissan|author|expert|events|comsec|lawyer|tattoo|viking|estate|villas|condos|realty|yandex|energy|emerck|virgin|vision|durban|living|school|coupon|london|taobao|natura|taipei|nagoya|luxury|walter|aramco|sydney|madrid|credit|maison|makeup|schule|market|anquan|direct|design|swatch|suzuki|alsace|vuelos|dental|alipay|voyage|shouji|voting|airtel|mutual|degree|supply|agency|museum|mobily|dealer|monash|select|mormon|active|moscow|racing|datsun|quebec|nissay|rodeo|email|gifts|works|photo|chloe|edeka|cheap|earth|vista|tushu|koeln|glass|shoes|globo|tunes|gmail|nokia|space|kyoto|black|ricoh|seven|lamer|sener|epson|cisco|praxi|trust|citic|crown|shell|lease|green|legal|lexus|ninja|tatar|gripe|nikon|group|video|wales|autos|gucci|party|nexus|guide|linde|adult|parts|amica|lixil|boats|azure|loans|locus|cymru|lotte|lotto|stada|click|poker|quest|dabur|lupin|nadex|paris|faith|dance|canon|place|gives|trade|skype|rocks|mango|cloud|boots|smile|final|swiss|homes|honda|media|horse|cards|deals|watch|bosch|house|pizza|miami|osaka|tours|total|xerox|coach|sucks|style|delta|toray|iinet|tools|money|codes|beats|tokyo|salon|archi|movie|baidu|study|actor|yahoo|store|apple|world|forex|today|bible|tmall|tirol|irish|tires|forum|reise|vegas|vodka|sharp|omega|weber|jetzt|audio|promo|build|bingo|chase|gallo|drive|dubai|rehab|press|solar|sale|beer|bbva|bank|band|auto|sapo|sarl|saxo|audi|asia|arte|arpa|army|yoga|ally|zara|scor|scot|sexy|seat|zero|seek|aero|adac|zone|aarp|maif|meet|meme|menu|surf|mini|mobi|mtpc|porn|desi|star|ltda|name|talk|navy|love|loan|live|link|news|limo|like|spot|life|nico|lidl|lgbt|land|taxi|team|tech|kred|kpmg|sony|song|kiwi|kddi|jprs|jobs|sohu|java|itau|tips|info|immo|icbc|hsbc|town|host|page|toys|here|help|pars|haus|guru|guge|tube|goog|golf|gold|sncf|gmbh|gift|ggee|gent|gbiz|game|vana|pics|fund|ford|ping|pink|fish|film|fast|farm|play|fans|fail|plus|skin|pohl|fage|moda|post|erni|dvag|prod|doha|prof|docs|viva|diet|luxe|site|dell|sina|dclk|show|qpon|date|vote|cyou|voto|read|coop|cool|wang|club|city|chat|cern|cash|reit|rent|casa|cars|care|camp|rest|call|cafe|weir|wien|rich|wiki|buzz|wine|book|bond|room|work|rsvp|shia|ruhr|blue|bing|shaw|bike|safe|xbox|best|pwc|mtn|lds|aig|boo|fyi|nra|nrw|ntt|car|gal|obi|zip|aeg|vin|how|one|ong|onl|dad|ooo|bet|esq|org|htc|bar|uol|ibm|ovh|gdn|ice|icu|uno|gea|ifm|bot|top|wtf|lol|day|pet|eus|wtc|ubs|tvs|aco|ing|ltd|ink|tab|abb|afl|cat|int|pid|pin|bid|cba|gle|com|cbn|ads|man|wed|ceb|gmo|sky|ist|gmx|tui|mba|fan|ski|iwc|app|pro|med|ceo|jcb|jcp|goo|dev|men|aaa|meo|pub|jlc|bom|jll|gop|jmp|mil|got|gov|win|jot|mma|joy|trv|red|cfa|cfd|bio|moe|moi|mom|ren|biz|aws|xin|bbc|dnp|buy|kfh|mov|thd|xyz|fit|kia|rio|rip|kim|dog|vet|nyc|bcg|mtr|bcn|bms|bmw|run|bzh|rwe|tel|stc|axa|kpn|fly|krd|cab|bnl|foo|crs|eat|tci|sap|srl|nec|sas|net|cal|sbs|sfr|sca|scb|csc|edu|new|xxx|hiv|fox|wme|ngo|nhk|vip|sex|frl|lat|yun|law|you|tax|soy|sew|om|ac|hu|se|sc|sg|sh|sb|sa|rw|ru|rs|ro|re|qa|py|si|pw|pt|ps|sj|sk|pr|pn|pm|pl|sl|sm|pk|sn|ph|so|pg|pf|pe|pa|zw|nz|nu|nr|np|no|nl|ni|ng|nf|sr|ne|st|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|mq|mp|mo|su|mn|mm|ml|mk|mh|mg|me|sv|md|mc|sx|sy|ma|ly|lv|sz|lu|lt|ls|lr|lk|li|lc|lb|la|tc|kz|td|ky|kw|kr|kp|kn|km|ki|kh|tf|tg|th|kg|ke|jp|jo|jm|je|it|is|ir|tj|tk|tl|tm|iq|tn|to|io|in|im|il|ie|ad|sd|ht|hr|hn|hm|tr|hk|gy|gw|gu|gt|gs|gr|gq|tt|gp|gn|gm|gl|tv|gi|tw|tz|ua|gh|ug|uk|gg|gf|ge|gd|us|uy|uz|va|gb|ga|vc|ve|fr|fo|fm|fk|fj|vg|vi|fi|eu|et|es|er|eg|ee|ec|dz|do|dm|dk|vn|dj|de|cz|cy|cx|cw|vu|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|wf|bz|by|bw|bv|bt|bs|br|bo|bn|bm|bj|bi|ws|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ye|ar|aq|ao|am|al|yt|ai|za|ag|af|ae|zm|id)\b/;return{alphaNumericCharsStr:i,domainNameRegex:n,tldRegex:r}}(),t.AnchorTagBuilder=t.Util.extend(Object,{constructor:function(e){t.Util.assign(this,e)},build:function(e){return new t.HtmlTag({tagName:"a",attrs:this.createAttrs(e.getType(),e.getAnchorHref()),innerHtml:this.processAnchorText(e.getAnchorText())})},createAttrs:function(t,e){var i={href:e},n=this.createCssClass(t);return n&&(i.class=n),this.newWindow&&(i.target="_blank",i.rel="noopener noreferrer"),i},createCssClass:function(t){var e=this.className;return e?e+" "+e+"-"+t:""},processAnchorText:function(t){return t=this.doTruncate(t)},doTruncate:function(e){var i=this.truncate;if(!i||!i.length)return e;var n=i.length,r=i.location;return"smart"===r?t.truncate.TruncateSmart(e,n,".."):"middle"===r?t.truncate.TruncateMiddle(e,n,".."):t.truncate.TruncateEnd(e,n,"..")}}),t.htmlParser.HtmlParser=t.Util.extend(Object,{htmlRegex:function(){var t=/!--([\s\S]+?)--/,e=/[0-9a-zA-Z][0-9a-zA-Z:]*/,i=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,n=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,r=i.source+"(?:\\s*=\\s*"+n.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",r,"|",n.source+")",")*",">",")","|","(?:","<(/)?","(?:",t.source,"|","(?:","("+e.source+")","(?:","\\s*",r,")*","\\s*/?",")",")",">",")"].join(""),"gi")}(),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(t){for(var e,i,n=this.htmlRegex,r=0,o=[];null!==(e=n.exec(t));){var s=e[0],a=e[3],l=e[1]||e[4],c=!!e[2],u=e.index,h=t.substring(r,u);h&&(i=this.parseTextAndEntityNodes(r,h),o.push.apply(o,i)),a?o.push(this.createCommentNode(u,s,a)):o.push(this.createElementNode(u,s,l,c)),r=u+s.length}if(r<t.length){var d=t.substring(r);d&&(i=this.parseTextAndEntityNodes(r,d),o.push.apply(o,i))}return o},parseTextAndEntityNodes:function(e,i){for(var n=[],r=t.Util.splitAndCapture(i,this.htmlCharacterEntitiesRegex),o=0,s=r.length;o<s;o+=2){var a=r[o],l=r[o+1];a&&(n.push(this.createTextNode(e,a)),e+=a.length),l&&(n.push(this.createEntityNode(e,l)),e+=l.length)}return n},createCommentNode:function(e,i,n){return new t.htmlParser.CommentNode({offset:e,text:i,comment:t.Util.trim(n)})},createElementNode:function(e,i,n,r){return new t.htmlParser.ElementNode({offset:e,text:i,tagName:n.toLowerCase(),closing:r})},createEntityNode:function(e,i){return new t.htmlParser.EntityNode({offset:e,text:i})},createTextNode:function(e,i){return new t.htmlParser.TextNode({offset:e,text:i})}}),t.htmlParser.HtmlNode=t.Util.extend(Object,{offset:void 0,text:void 0,constructor:function(e){if(t.Util.assign(this,e),null==this.offset)throw new Error("`offset` cfg required");if(null==this.text)throw new Error("`text` cfg required")},getType:t.Util.abstractMethod,getOffset:function(){return this.offset},getText:function(){return this.text}}),t.htmlParser.CommentNode=t.Util.extend(t.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}}),t.htmlParser.ElementNode=t.Util.extend(t.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),t.htmlParser.EntityNode=t.Util.extend(t.htmlParser.HtmlNode,{getType:function(){return"entity"}}),t.htmlParser.TextNode=t.Util.extend(t.htmlParser.HtmlNode,{getType:function(){return"text"}}),t.match.Match=t.Util.extend(Object,{constructor:function(t){if(null==t.tagBuilder)throw new Error("`tagBuilder` cfg required");if(null==t.matchedText)throw new Error("`matchedText` cfg required");if(null==t.offset)throw new Error("`offset` cfg required");this.tagBuilder=t.tagBuilder,this.matchedText=t.matchedText,this.offset=t.offset},getType:t.Util.abstractMethod,getMatchedText:function(){return this.matchedText},setOffset:function(t){this.offset=t},getOffset:function(){return this.offset},getAnchorHref:t.Util.abstractMethod,getAnchorText:t.Util.abstractMethod,buildTag:function(){return this.tagBuilder.build(this)}}),t.match.Email=t.Util.extend(t.match.Match,{constructor:function(e){if(t.match.Match.prototype.constructor.call(this,e),!e.email)throw new Error("`email` cfg required");this.email=e.email},getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),t.match.Hashtag=t.Util.extend(t.match.Match,{constructor:function(e){if(t.match.Match.prototype.constructor.call(this,e),!e.hashtag)throw new Error("`hashtag` cfg required");this.serviceName=e.serviceName,this.hashtag=e.hashtag},getType:function(){return"hashtag"},getServiceName:function(){return this.serviceName},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var t=this.serviceName,e=this.hashtag;switch(t){case"twitter":return"https://twitter.com/hashtag/"+e;case"facebook":return"https://www.facebook.com/hashtag/"+e;case"instagram":return"https://instagram.com/explore/tags/"+e;default:throw new Error("Unknown service name to point hashtag to: ",t)}},getAnchorText:function(){return"#"+this.hashtag}}),t.match.Phone=t.Util.extend(t.match.Match,{constructor:function(e){if(t.match.Match.prototype.constructor.call(this,e),!e.number)throw new Error("`number` cfg required");if(null==e.plusSign)throw new Error("`plusSign` cfg required");this.number=e.number,this.plusSign=e.plusSign},getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+(this.plusSign?"+":"")+this.number},getAnchorText:function(){return this.matchedText}}),t.match.Twitter=t.Util.extend(t.match.Match,{constructor:function(e){if(t.match.Match.prototype.constructor.call(this,e),!e.twitterHandle)throw new Error("`twitterHandle` cfg required");this.twitterHandle=e.twitterHandle},getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),t.match.Url=t.Util.extend(t.match.Match,{constructor:function(e){if(t.match.Match.prototype.constructor.call(this,e),"scheme"!==e.urlMatchType&&"www"!==e.urlMatchType&&"tld"!==e.urlMatchType)throw new Error('`urlMatchType` cfg must be one of: "scheme", "www", or "tld"');if(!e.url)throw new Error("`url` cfg required");if(null==e.protocolUrlMatch)throw new Error("`protocolUrlMatch` cfg required");if(null==e.protocolRelativeMatch)throw new Error("`protocolRelativeMatch` cfg required");if(null==e.stripPrefix)throw new Error("`stripPrefix` cfg required");this.urlMatchType=e.urlMatchType,this.url=e.url,this.protocolUrlMatch=e.protocolUrlMatch,this.protocolRelativeMatch=e.protocolRelativeMatch,this.stripPrefix=e.stripPrefix},urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrlMatchType:function(){return this.urlMatchType},getUrl:function(){var t=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(t=this.url="http://"+t,this.protocolPrepended=!0),t},getAnchorHref:function(){var t=this.getUrl();return t.replace(/&amp;/g,"&")},getAnchorText:function(){var t=this.getMatchedText();return this.protocolRelativeMatch&&(t=this.stripProtocolRelativePrefix(t)),this.stripPrefix&&(t=this.stripUrlPrefix(t)),t=this.removeTrailingSlash(t)},stripUrlPrefix:function(t){return t.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(t){return t.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(t){return"/"===t.charAt(t.length-1)&&(t=t.slice(0,-1)),t}}),t.matcher.Matcher=t.Util.extend(Object,{constructor:function(t){if(!t.tagBuilder)throw new Error("`tagBuilder` cfg required");this.tagBuilder=t.tagBuilder},parseMatches:t.Util.abstractMethod}),t.matcher.Email=t.Util.extend(t.matcher.Matcher,{matcherRegex:function(){var e=t.RegexLib.alphaNumericCharsStr,i=new RegExp("["+e+"\\-;:&=+$.,]+@"),n=t.RegexLib.domainNameRegex,r=t.RegexLib.tldRegex;return new RegExp([i.source,n.source,"\\.",r.source].join(""),"gi")}(),parseMatches:function(e){for(var i,n=this.matcherRegex,r=this.tagBuilder,o=[];null!==(i=n.exec(e));){var s=i[0];o.push(new t.match.Email({tagBuilder:r,matchedText:s,offset:i.index,email:s}))}return o}}),t.matcher.Hashtag=t.Util.extend(t.matcher.Matcher,{matcherRegex:new RegExp("#[_"+t.RegexLib.alphaNumericCharsStr+"]{1,139}","g"),nonWordCharRegex:new RegExp("[^"+t.RegexLib.alphaNumericCharsStr+"]"),constructor:function(e){t.matcher.Matcher.prototype.constructor.call(this,e),this.serviceName=e.serviceName},parseMatches:function(e){for(var i,n=this.matcherRegex,r=this.nonWordCharRegex,o=this.serviceName,s=this.tagBuilder,a=[];null!==(i=n.exec(e));){
var l=i.index,c=e.charAt(l-1);if(0===l||r.test(c)){var u=i[0],h=i[0].slice(1);a.push(new t.match.Hashtag({tagBuilder:s,matchedText:u,offset:l,serviceName:o,hashtag:h}))}}return a}}),t.matcher.Phone=t.Util.extend(t.matcher.Matcher,{matcherRegex:/(?:(\+)?\d{1,3}[-\040.])?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]\d{4}/g,parseMatches:function(e){for(var i,n=this.matcherRegex,r=this.tagBuilder,o=[];null!==(i=n.exec(e));){var s=i[0],a=s.replace(/\D/g,""),l=!!i[1];o.push(new t.match.Phone({tagBuilder:r,matchedText:s,offset:i.index,number:a,plusSign:l}))}return o}}),t.matcher.Twitter=t.Util.extend(t.matcher.Matcher,{matcherRegex:new RegExp("@[_"+t.RegexLib.alphaNumericCharsStr+"]{1,20}","g"),nonWordCharRegex:new RegExp("[^"+t.RegexLib.alphaNumericCharsStr+"]"),parseMatches:function(e){for(var i,n=this.matcherRegex,r=this.nonWordCharRegex,o=this.tagBuilder,s=[];null!==(i=n.exec(e));){var a=i.index,l=e.charAt(a-1);if(0===a||r.test(l)){var c=i[0],u=i[0].slice(1);s.push(new t.match.Twitter({tagBuilder:o,matchedText:c,offset:a,twitterHandle:u}))}}return s}}),t.matcher.Url=t.Util.extend(t.matcher.Matcher,{matcherRegex:function(){var e=/(?:[A-Za-z][-.+A-Za-z0-9]*:(?![A-Za-z][-.+A-Za-z0-9]*:\/\/)(?!\d+\/?)(?:\/\/)?)/,i=/(?:www\.)/,n=t.RegexLib.domainNameRegex,r=t.RegexLib.tldRegex,o=t.RegexLib.alphaNumericCharsStr,s=new RegExp("["+o+"\\-+&@#/%=~_()|'$*\\[\\]?!:,.;]*["+o+"\\-+&@#/%=~_()|'$*\\[\\]]");return new RegExp(["(?:","(",e.source,n.source,")","|","(","(//)?",i.source,n.source,")","|","(","(//)?",n.source+"\\.",r.source,")",")","(?:"+s.source+")?"].join(""),"gi")}(),wordCharRegExp:/\w/,openParensRe:/\(/g,closeParensRe:/\)/g,constructor:function(e){if(t.matcher.Matcher.prototype.constructor.call(this,e),this.stripPrefix=e.stripPrefix,null==this.stripPrefix)throw new Error("`stripPrefix` cfg required")},parseMatches:function(e){for(var i,n=this.matcherRegex,r=this.stripPrefix,o=this.tagBuilder,s=[];null!==(i=n.exec(e));){var a=i[0],l=i[1],c=i[2],u=i[3],h=i[5],d=i.index,p=u||h,g=e.charAt(d-1);if(t.matcher.UrlMatchValidator.isValid(a,l)&&!(d>0&&"@"===g||d>0&&p&&this.wordCharRegExp.test(g))){if(this.matchHasUnbalancedClosingParen(a))a=a.substr(0,a.length-1);else{var f=this.matchHasInvalidCharAfterTld(a,l);f>-1&&(a=a.substr(0,f))}var m=l?"scheme":c?"www":"tld",v=!!l;s.push(new t.match.Url({tagBuilder:o,matchedText:a,offset:d,urlMatchType:m,url:a,protocolUrlMatch:v,protocolRelativeMatch:!!p,stripPrefix:r}))}}return s},matchHasUnbalancedClosingParen:function(t){var e=t.charAt(t.length-1);if(")"===e){var i=t.match(this.openParensRe),n=t.match(this.closeParensRe),r=i&&i.length||0,o=n&&n.length||0;if(r<o)return!0}return!1},matchHasInvalidCharAfterTld:function(t,e){if(!t)return-1;var i=0;e&&(i=t.indexOf(":"),t=t.slice(i));var n=/^((.?\/\/)?[A-Za-z0-9\u00C0-\u017F\.\-]*[A-Za-z0-9\u00C0-\u017F\-]\.[A-Za-z]+)/,r=n.exec(t);return null===r?-1:(i+=r[1].length,t=t.slice(r[1].length),/^[^.A-Za-z:\/?#]/.test(t)?i:-1)}}),t.matcher.UrlMatchValidator={hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]*:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z\u00C0-\u017F]/,isValid:function(t,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(t,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(t,e))},isValidUriScheme:function(t){var e=t.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==e&&"vbscript:"!==e},urlMatchDoesNotHaveProtocolOrDot:function(t,e){return!(!t||e&&this.hasFullProtocolRegex.test(e)||t.indexOf(".")!==-1)},urlMatchDoesNotHaveAtLeastOneWordChar:function(t,e){return!(!t||!e)&&!this.hasWordCharAfterProtocolRegex.test(t)}},t.truncate.TruncateEnd=function(e,i,n){return t.Util.ellipsis(e,i,n)},t.truncate.TruncateMiddle=function(t,e,i){if(t.length<=e)return t;var n=e-i.length,r="";return n>0&&(r=t.substr(-1*Math.floor(n/2))),(t.substr(0,Math.ceil(n/2))+i+r).substr(0,e)},t.truncate.TruncateSmart=function(t,e,i){var n=function(t){var e={},i=t,n=i.match(/^([a-z]+):\/\//i);return n&&(e.scheme=n[1],i=i.substr(n[0].length)),n=i.match(/^(.*?)(?=(\?|#|\/|$))/i),n&&(e.host=n[1],i=i.substr(n[0].length)),n=i.match(/^\/(.*?)(?=(\?|#|$))/i),n&&(e.path=n[1],i=i.substr(n[0].length)),n=i.match(/^\?(.*?)(?=(#|$))/i),n&&(e.query=n[1],i=i.substr(n[0].length)),n=i.match(/^#(.*?)$/i),n&&(e.fragment=n[1]),e},r=function(t){var e="";return t.scheme&&t.host&&(e+=t.scheme+"://"),t.host&&(e+=t.host),t.path&&(e+="/"+t.path),t.query&&(e+="?"+t.query),t.fragment&&(e+="#"+t.fragment),e},o=function(t,e){var n=e/2,r=Math.ceil(n),o=-1*Math.floor(n),s="";return o<0&&(s=t.substr(o)),t.substr(0,r)+i+s};if(t.length<=e)return t;var s=e-i.length,a=n(t);if(a.query){var l=a.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);l&&(a.query=a.query.substr(0,l[1].length),t=r(a))}if(t.length<=e)return t;if(a.host&&(a.host=a.host.replace(/^www\./,""),t=r(a)),t.length<=e)return t;var c="";if(a.host&&(c+=a.host),c.length>=s)return a.host.length==e?(a.host.substr(0,e-i.length)+i).substr(0,e):o(c,s).substr(0,e);var u="";if(a.path&&(u+="/"+a.path),a.query&&(u+="?"+a.query),u){if((c+u).length>=s){if((c+u).length==e)return(c+u).substr(0,e);var h=s-c.length;return(c+o(u,h)).substr(0,e)}c+=u}if(a.fragment){var d="#"+a.fragment;if((c+d).length>=s){if((c+d).length==e)return(c+d).substr(0,e);var p=s-c.length;return(c+o(d,p)).substr(0,e)}c+=d}if(a.scheme&&a.host){var g=a.scheme+"://";if((c+g).length<s)return(g+c).substr(0,e)}if(c.length<=e)return c;var f="";return s>0&&(f=c.substr(-1*Math.floor(s/2))),(c.substr(0,Math.ceil(s/2))+i+f).substr(0,e)},t})},function(t,e,i){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i,n){"object"===e(t)&&t.exports?t.exports=n():i.PureChatRegExp=n()}(void 0,function(){return{linkify:/(^|&nbsp;|\s)(www\.)?(?=[a-zA-Z0-9])(([-a-zA-Z0-9@:%_\+\/\/=]){1,256}\.)+([a-zA-Z]{2,15})\b(:[0-9]{2,})?([?\/#]([-a-zA-Z0-9,@:%_\+.~#!?&\/\/=\[\]]|[^\x00-\x7F])*)?/gim,email:/^[a-zA-Z]([a-zA-Z0-9\._%\+\-])*@([a-zA-Z0-9\.\-])*\.[a-zA-Z]{2,10}$/,brTags:/(<br>|<br\/>)/gi,tagRemoval:/<.+?>/g}})}).call(e,i(16)(t))},function(t,e,i){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i,n){if("object"===e(t)&&t.exports)t.exports=n();else{var r=n();i.PureChatEmoticons=r.PureChatEmoticons}}(void 0,function(){function t(t){return new RegExp("([\\s.]|&nbsp;|^)("+t+")(?=[\\s.]|&nbsp;|$)","gim")}return{regex:{happy:t("(:\\)|:-\\)|\\(happy\\))"),sad:t("(:\\(|:-\\(|\\(sad\\))"),grin:t("(:D|:-D|\\(grin\\))"),sealed:t("(:x|:-x|\\(sealed\\))"),wink:t("(;\\)|;-\\)|\\(wink\\))"),yawn:t("(\\(yawn\\))"),smirk:t("(\\(smirk\\))"),starstruck:t("(\\(starstruck\\))"),depressed:t("(:C|:-C|\\(depressed\\))"),sadnerd:t("(8\\(|8-\\(|\\(sadnerd\\))"),zomg:t("(D:|\\(zomg\\))"),speechless:t("(:\\||:-\\||\\(speechless\\))"),crying:t("(:'\\(|:'-\\(|\\(crying\\))"),relieved:t("(\\(relieved\\))"),satisfied:t("(\\(satisfied\\))"),determined:t("(\\(determined\\))"),tongue:t("(:p|:-p|\\(tongue\\))"),unsure:t("(:-\\/|\\(unsure\\))"),sleep:t("(-_-|\\(sleep\\))"),disguise:t("(8{|8-{|\\(disguise\\))"),cool:t("(B\\)|B-\\)|\\(cool\\))"),nerd:t("(8\\)|8-\\)|\\(nerd\\))"),lovestruck:t("(\\(lovestruck\\))"),angry:t("\\(angry\\)"),evil:t("(\\(evil\\))"),sick:t("(:s|:-s|\\(sick\\))"),embarassed:t("(\\/_\\\\|\\(embarassed\\))"),mustache:t("(:{|\\(mustache\\))"),surprised:t("(:o|:-o|\\(surprised\\))"),tease:t("(;p|;-p|\\(tease\\))"),ninja:t("\\(ninja\\)"),zombie:t("\\(zombie\\)")},imageMappings:{happy:"emote-happy",sad:"emote-sad",grin:"emote-grin",sealed:"emote-sealed",wink:"emote-wink",yawn:"emote-yawn",smirk:"emote-smirk",starstruck:"emote-starstruck",depressed:"emote-depressed",sadnerd:"emote-sadnerd",zomg:"emote-zomg",speechless:"emote-speechless",crying:"emote-crying",relieved:"emote-relieved",satisfied:"emote-satisfied",determined:"emote-determined",tongue:"emote-tongue",unsure:"emote-unsure",sleep:"emote-sleep",disguise:"emote-disguised",cool:"emote-cool",nerd:"emote-nerd",lovestruck:"emote-lovestruck",angry:"emote-angry",evil:"emote-evil",sick:"emote-sick",embarassed:"emote-embarassed",mustache:"emote-mustache",surprised:"emote-surprised",tease:"emote-tease",ninja:"emote-ninja",zombie:"emote-zombie"},parse:function(t,e){if(e||(e="div"),t)for(var i in this.regex)t=t.replace(this.regex[i],"$1<"+e+' class="emoticon '+this.imageMappings[i]+'" title="'+i+'"></'+e+">");return t}}})}).call(e,i(16)(t))},function(t,e,i){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n,r){if("object"===e(t)&&t.exports){var o=i(4),s=i(7);t.exports=r(o,s)}else n.PureChat=r(n._,n.io)}(void 0,function(t,i){var n=function(t,e,n,o,s,a,l,c,u,h){var d=this;this.currentUserId=e,this.currentDomainId=n,this.currentAuthToken=o,this.poppedOut=c,this.emailMD5Hash=u,d.setConnectionStatus(0),i.transports=["websocket"];var p={reconnection:!0,reconnectionAttempts:h||1/0};this.socket=i.connect(t,p),this.messageQueue=[],this.eventFncMappings={},this.registerHandler=function(t){var e=function(e){r[t]?r[t].call(d,e):r.default.call(d,t,e)};d.eventFncMappings[t]=e,d.socket.on(t,d.eventFncMappings[t])},this.chatServerEvents=["message","joined","left","roomdestroyed","userDestroyed","typing","reidentify","userdeleted","chat-counts","opInvite","roomchanged","roomclosed","rooms","onlineOperatorStatus","opStatus","serverNotice","roomdetailschanged","userSettings:change","canned-responses:changed","canned-responses:added","canned-responses:deleted","userOnboarding:change","operator:refresh","noOperatorJoined","contact:changed"],this.chatServerEvents.forEach(function(t){d.registerHandler(t)}),this.socket.on("connect",function(){this.reconnectCount=0,d.setConnectionStatus(1),d.identify(d.currentUserId,d.currentDomainId,d.currentAuthToken,s,d.poppedOut,d.emailMD5Hash),d.trigger("connection:connected:socketio")}),this.socket.on("disconnect",function(){d.setConnectionStatus(0),console.log("Just disconnected..."),d.trigger("connection:disconnected:socketio")}),this.socket.on("reconnecting",function(){this.reconnectCount++,console.log("reconnecting..."),this.reconnectCount>8&&d.setConnectionStatus(3)}),d.on("connection:retry:socketio",function(){var t=d.socket;!t.connected&&t.reconnectionAttempts>=8&&t.reconnect()}),a&&this.socket.on("error",a)};n.prototype.setConnectionStatus=function(t){this.status=t,this.trigger("change:connectionStatus",this,t)},n.prototype.disconnect=function(){this.socket.disconnect(),this.socket.removeAllListeners(),this.socket=null},n.prototype.identify=function(t,e,i,r,o,s){function a(t,e,i,n){t&&l.setConnectionStatus(2),r.apply(this,arguments)}var l=this;this.currentUserId=t,this.currentDomainId=e,this.currentAuthToken=i,this.deviceType=n.enums.deviceType.desktop,this.poppedOut=o,this.protocolVersion="2.0",this.emailMD5Hash=s,this.socket.emit("identify",{userId:this.currentUserId,domainId:this.currentDomainId,authToken:this.currentAuthToken,deviceType:this.deviceType,deviceVersion:n.deviceVersion,poppedOut:this.poppedOut,protocolVersion:this.protocolVersion,emailMD5Hash:this.emailMD5Hash},a)},n.prototype.sendmessage=function(t,e,i){this.socket.emit("sendmessage",{message:t,roomId:e},i)},n.prototype.sendtyping=function(t,e,i){this.socket.emit("sendtyping",{roomId:t,isTyping:e},i)},n.prototype.destroyself=function(t,e){this.socket.emit("destroyself",e||{},t)},n.prototype.join=function(t,e){var i=t.roomId,n=t.invisible,r=t.joinType;this.socket.emit("join",{roomId:i,invisible:n,joinType:r},e)},n.prototype.leave=function(t,e){this.socket.emit("leave",{roomId:t},e)},n.prototype.closeroom=function(t,e){this.socket.emit("closeroom",{roomId:t},e)},n.prototype.createoperatorroom=function(t,e,i,n,r){this.socket.emit("createoperatorroom",{roomName:t,otherUserIds:e},i,n,r)},n.prototype.sendcurrentstate=function(t){this.socket.emit("sendcurrentstate",{},t)},n.prototype.getuser=function(t){this.socket.emit("getuser",t)},n.prototype.getusers=function(t){this.socket.emit("getusers",t)},n.prototype.sendroomhistory=function(t,e){this.socket.emit("sendroomhistory",{roomId:t},e)},n.prototype.setavailable=function(t,e,i,n){this.socket.emit("setavailable",{userId:t,connectionId:e,available:i},n)},n.prototype.setWidgetTypeAvailable=function(t,e,i,n){this.socket.emit("setwidgettypeavailable",{userId:t,widgetType:e,available:i},n)},n.prototype.forcedisconnect=function(t,e,i){this.socket.emit("forcedisconnect",{userId:t,connectionId:e},i)},n.prototype.startdemo=function(t,e){this.socket.emit("startdemo",{widgetId:t},e)},n.prototype.sendInvite=function(t,e,i,n,r){this.socket.emit("opInvite",{userId:t,roomId:e,roomName:i,fromName:n},r)},n.prototype.setVisitorDetails=function(t,e,i){this.socket.emit("setvisitordetails",{roomId:t,details:e},i)},n.deviceVersion=1,n.enums={deviceType:{desktop:0,ios:1},roomType:{account:0,operator:1,visitor:2}};var r={message:function(t){var e=t.userDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=t.roomDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n=(t.message||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.trigger("message",t.userId,e,t.roomId,i,t.time,n.length>0?n:null,t.isHistory,t.timeElapsed,t.protocolVersion,t.avatarUrl,t.fromOperator,t.roomUtcOffset)},joined:function(t){var e=t.userDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=t.roomDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.trigger("joined",t.userId,e,t.roomId,i,t.time,t.isHistory)},left:function(t){var e=t.userDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=t.roomDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.trigger("left",t.userId,e,t.roomId,i,t.time,t.isHistory)},roomdestroyed:function(t){var e=t.roomDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.trigger("roomdestroyed",t.roomId,e,t.time,t.reasonCode)},userDestroyed:function(t){this.trigger("userDestroyed",t.userId)},typing:function(t){var e=t.userDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t.roomDisplayName.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.trigger("typing",t.userId,e,t.roomId,t.roomDisplayName,t.isTyping,t.time)},roomchanged:function(t){t&&"closedroom"==t.action&&purechatApp.execute("roomclosed",t.room.id),this.trigger("roomchanged",t)},default:function(t,e){this.trigger(t,e)}},o=[],s=(o.push,o.slice);o.splice;n.prototype.on=function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},n.prototype.once=function(e,i,n){if(!l(this,"once",e,[i,n])||!i)return this;var r=this,o=t.once(function(){r.off(e,o),i.apply(this,arguments)});return o._callback=i,this.on(e,o,n)},n.prototype.off=function(e,i,n){var r,o,s,a,c,u,h,d;if(!this._events||!l(this,"off",e,[i,n]))return this;if(!e&&!i&&!n)return this._events=void 0,this;for(a=e?[e]:t.keys(this._events),c=0,u=a.length;c<u;c++)if(e=a[c],s=this._events[e]){if(this._events[e]=r=[],i||n)for(h=0,d=s.length;h<d;h++)o=s[h],(i&&i!==o.callback&&i!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},n.prototype.trigger=function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},n.prototype.stopListening=function(i,n,r){var o=this._listeningTo;if(!o)return this;var s=!n&&!r;r||"object"!==("undefined"==typeof n?"undefined":e(n))||(r=this),i&&((o={})[i._listenId]=i);for(var a in o)i=o[a],i.off(n,r,this),(s||t.isEmpty(i._events))&&delete this._listeningTo[a];return this};var a=/\s+/,l=function(t,i,n,r){if(!n)return!0;if("object"===("undefined"==typeof n?"undefined":e(n))){for(var o in n)t[i].apply(t,[o,n[o]].concat(r));return!1}if(a.test(n)){for(var s=n.split(a),l=0,c=s.length;l<c;l++)t[i].apply(t,[s[l]].concat(r));return!1}return!0},c=function(t,e){var i,n=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e)}};return n})}).call(e,i(16)(t))},function(t,e,i){"use strict";function n(){return(0,r.getCookie)("hubspotutk")}Object.defineProperty(e,"__esModule",{value:!0}),e.getHubspotId=void 0;var r=i(57);e.getHubspotId=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PureChatController=void 0;var r=i(2),o=i(4),s=n(o),a=i(53),l=(n(a),i(64)),c=n(l),u=i(55),h=n(u),d=i(56),p=n(d),g=i(57),f=n(g),m=i(83),v=n(m),b=i(85),y=n(b),_=i(87),w=n(_),C=i(88),x=n(C),k=i(98),M=n(k),S=i(99),I=n(S),A=i(65),T=n(A),E=v.default.extend({setChatModel:function(t){this.chatModel=t},getChatModel:function(){return this.chatModel},setDataController:function(t){this.dc=t},getDataController:function(){return this.dc},popoutChatOnExpand:function(t,e,i,n,r){i.set("poppedOut",!0),n.disable(),t.connectionInfo.persistLocalStorage();var o=e.pureServerUrl+"/VisitorWidget/ChatWindow?widgetId="+e.widgetId+"&userId="+t.connectionInfo.get("userId")+"&displayName="+t.connectionInfo.get("visitorName")+"&authToken="+t.connectionInfo.get("authToken")+"&roomId="+t.connectionInfo.get("roomId")+"&chatId="+t.connectionInfo.get("chatId")+"&origin="+encodeURIComponent(i?i.get("origin"):"");r?window.openedWindow=window.open(o,"_blank"):window.openedWindow=window.open(o,"purechatwindow","menubar=no, location=no, resizable=yes, scrollbars=no, status=no, width=480, height=640"),this.trigger("widget:poppedOut")},resetVisitorQuestion:function(){this.getChatModel().set("visitorQuestion",null)},triggerResizedEvent:function(){var t=this;t.resizeTrigger&&clearTimeout(t.resizeTrigger),t.resizeTrigger=setTimeout(function(){if(t.resizeTrigger=null,t.widgetLayout&&t.widgetLayout.$el){var e=t.widgetLayout.$el.width();t.widgetLayout.trigger("resized",{height:390,width:e}),t.widgetLayout.trigger("widget:resized",{height:390,width:e}),t.resizeTrigger2&&clearTimeout(t.resizeTrigger2),t.resizeTrigger2=setTimeout(function(){t.resizeTrigger2=null;var i=t.widgetLayout.$el.height();if(0===i){var n=t.widgetLayout.$el.find("img.collapsed-image");n.length>0&&(i=n.height(),e=n.width())}t.widgetLayout.trigger("resized",{height:i,width:e}),t.widgetLayout.trigger("widget:resized",{height:i,width:e})},1e3)}},0)},unbindAppLevelCommands:function(){T.default.commands.removeHandler("roomHostChanged")},bindAppLevelCommands:function(){var t=this;try{this.unbindAppLevelCommands()}catch(t){}T.default.commands.setHandler("roomHostChanged",function(e){(t.options.get("MobileDisplayType")===p.default.MobileDisplayTypes.MobileOptimized&&t.options.get("RequestFromMobileDevice")||!t.options.get("RequestFromMobileDevice"))&&t.getPublicApi().trigger("room:hostChanged",e)})},getStyleURL:function(){var t=null,e=this.options.get("version")+this.options.get("CssVersion"),i=this.options.isMobileRequest(),n=this.options.isAllowedOnMobile();return t=this.options.get("isPersonalChat")?i&&!this.options.isDesktopDimension()?this.options.get("apiCdnServerUrl")+"/VisitorWidget/WidgetCss/personal-mobile/"+this.options.get("Color")+"/"+e+".css":this.options.get("apiCdnServerUrl")+"/VisitorWidget/WidgetCss/personal/"+this.options.get("Color")+"/"+e+".css":i&&n&&!this.options.isDesktopDimension()?this.options.get("apiCdnServerUrl")+"/VisitorWidget/WidgetCss/mobile/"+this.options.get("Color")+"/"+e+".css":this.options.get("apiCdnServerUrl")+"/VisitorWidget/WidgetCss/"+this.options.get("StyleName")+"/"+this.options.get("Color")+"/"+e+".css"},bindVisitorTrackingEvents:function(){var t=this;this.vtftw&&this.vtftw.on("purechat:startChat",function(e){t.onFormSubmitted({operatorJoinIds:e.eventArgs.operatorJoinIds||[],initiator:1,startedByOperator:!0})})},unbindVisitorTrackingEvents:function(){this.vtftw&&this.vtftw.off("purechat:startChat")},isBanned:function(){var t=this.options.get("IPIsBanned");if(!t)return!1;try{return JSON.parse(t.toString().toLowerCase())}catch(t){return!1}},startVisitorTracking:function(){if(!this.getChatModel().get("isOperator")&&this.options.get("VisitorTrackingEnabled")){var t=s.default.find(this.options.get("Features"),function(t){return t.Status!=p.default.FeatureStatus.Off&&t.Feature==p.default.Features.VisitorTracking}),e=this.options.get("Type")!=p.default.PersonalChatType;if(e&&t&&(!this.vtftw||!this.vtftw.initialized)){var i={widgetId:this.options.get("overrideWidgetId")||this.options.get("Id"),widgetName:this.options.get("Name")};this.isBanned()&&(i.isBanned=!0),this.vtftw=new M.default(I.default,this.options.get("AccountId")),this.vtftw.setAdditionalInfo(i),this.vtftw.init(),this.bindVisitorTrackingEvents()}}},disableVisitorTrackingInactivity:function(){this.vtftw&&this.vtftw.setUserAlwaysActive()},enableVisitorTrackingInactivity:function(){this.vtftw&&this.vtftw.unsetUserAlwaysActive()},coalesceStartChatData:function(t){var e=this.getChatModel();return(!e.get("visitorFirstName")||t.visitorFirstName&&e.get("visitorFirstName")!=t.visitorFirstName)&&e.set("visitorFirstName",t.visitorFirstName),(!e.get("visitorLastName")||t.visitorLastName&&e.get("visitorLastName")!=t.visitorLastName)&&e.set("visitorLastName",t.visitorLastName),(!e.get("visitorName")||t.visitorName&&e.get("visitorName")!=t.visitorName)&&e.set("visitorName",t.visitorName),(!e.get("visitorEmail")||t.visitorEmail&&e.get("visitorEmail")!=t.visitorEmail)&&e.set("visitorEmail",t.visitorEmail),(!e.get("visitorQuestion")||t.visitorQuestion&&e.get("visitorQuestion")!=t.visitorQuestion)&&e.set("visitorQuestion",t.visitorQuestion),(!e.get("visitorCompany")||t.visitorCompany&&e.get("visitorCompany")!=t.visitorCompany)&&e.set("visitorCompany",t.visitorCompany),(!e.get("visitorPhoneNumber")||t.visitorPhoneNumber&&e.get("visitorPhoneNumber")!=t.visitorPhoneNumber)&&e.set("visitorPhoneNumber",t.visitorPhoneNumber),r.$.extend(t,e.attributes)},onFormSubmitted:function(t){var e=this,i=e.getDataController().checkInRoom(),n=e.widgetLayout.$el.find(".purechat-form.purechat-init-form"),r=this.getChatModel();if(n&&n.length>0&&T.default.execute("spinner:show",n),!e.state.submittingChat)if(i)T.default.execute("spinner:hide",n),r.set("state",p.default.WidgetStates.Activating);else{e.submittingChat=!0,t.origin=r.get("origin");e.getDataController().startChat(this.coalesceStartChatData(t)).done(function(i){f.default.GaEvent(e.options,"GaTrackingChat","GAChatEvent"),e.widgetLayout.$el.find(".purechat-init-form").find(".general-error").text("").hide(),e.state.status.chatInfo=i,e.state.status.initialData=t,r.set({visitorFirstName:t.visitorFirstName,visitorLastName:t.visitorLastName,visitorName:t.visitorName,visitorEmail:t.visitorEmail,visitorQuestion:t.visitorQuestion,visitorPhoneNumber:t.visitorPhoneNumber,visitorCompany:t.visitorCompany,roomId:i.get("roomId"),userId:i.get("userId"),authToken:i.get("authToken"),chatId:i.get("chatId"),state:p.default.WidgetStates.Chatting}),e.getDataController().connectionInfo.persistLocalStorage()}).fail(function(t){e.widgetLayout.$el.find(".purechat-init-form").find(".general-error").text("Unable to start chat. Please try again").show()}).always(function(){e.state.submittingChat=!1,n&&n.length>0&&T.default.execute("spinner:hide",n)})}},initialize:function(t){var e=this;t.get("apiCdnServerUrl")||t.set("apiCdnServerUrl","https://cdnva2.purechat.com/api"),T.default.pureServerUrl=t.get("pureServerUrl");var i=(r.$.Deferred(),new h.default.Chat({isWidget:t.get("isWidget"),position:t.get("position"),pureServerUrl:t.get("pureServerUrl"),cdnServerUrl:t.get("cdnServerUrl")||t.get("pureServerUrl"),apiCdnServerUrl:t.get("apiCdnServerUrl"),chatServerUrl:t.get("chatServerUrl"),widgetType:p.default.WidgetType.Tab,isOperator:t.get("isOperator"),isPoppedOut:t.get("poppedOut"),State:p.default.WidgetStates.Inactive,messages:new h.default.MessageCollection,operators:new h.default.OperatorCollection,origin:t.get("origin")||window.location.href,userId:t.get("userId")}));e.setChatModel(i),this.registerPublicApiEvents(),t.get("isDemo")&&(i.set("operatorsAvailable",!0),i.set("visitorName",t.get("visitorName")),t.get("isPersonalChat")&&t.get("isInEditorMode")&&(window.pcDemoChatModel=i));var n=e.options.isMobileRequest()&&!e.options.isDesktopDimension(),o=e.options.get("MobileDisplayType")===p.default.MobileDisplayTypes.Hidden;if(n&&o&&t.set("ChatBoxEnabled",!1),t.get("ChatBoxEnabled")||t.get("isDemo")){var s=function(){e.options.set(e.options.get("dataController").widgetSettings.widgetConfig),e.setupPageActivityTest(),e.rm=e.options,e.options.set(e.getDataController().widgetSettings);var n=e.options.isMobileRequest()&&e.options.isAllowedOnMobile()&&!e.options.isDesktopDimension(),o=n?"mobile_expandButton":"title_initial";(0,r.$)(".purechat-button-expand").find(".purechat-button-text").text(e.options.getResource(o),o),i.on("change:operatorsAvailable",function(t,n){var o=(0,r.$)(".purechat-button-expand");o.filter(":not(.purechat)").click(function(t){var i=e.getDataController();(0,r.$)(t.target).hasClass("pc-icon-caret-down")||(0,r.$)(t.target).hasClass("purechat-super-minimize-link-button")||!(i.options.ForcePopout&&!e.chatModel.get("isPoppedOut")||i.options.usePrototypeFallback)?e.widgetLayout.triggerMethod("expand",t,{collapse:(0,r.$)(t.target).hasClass("purechat-btn-collapse")||(0,r.$)(t.target).hasClass("pc-icon-minus"),superMinimize:(0,r.$)(t.target).hasClass("pc-icon-caret-down")||(0,r.$)(t.target).hasClass("pc-icon-caret-up")||(0,r.$)(t.target).hasClass("purechat-super-minimize-link-button")}):e.popoutChatOnExpand(i,i.options,e.chatModel,e.state)}),n?(o.addClass("purechat-button-available"),o.removeClass("purechat-button-unavailable"),o.removeClass("purechat-button-hidden"),o.removeAttr("disabled"),i.trigger("widget:available")):(0===e.options.get("UnavailableBehavior")&&(o.removeClass("purechat-button-available"),o.addClass("purechat-button-unavailable"),o.attr("disabled","disabled")),o.each(function(){var t,i=(0,r.$)(this),n=i.attr("HideUnavailable");t=n?"true"==n:0===e.options.get("UnavailableBehavior"),t&&i.addClass("purechat-button-hidden")}),i.trigger("widget:unavailable"))}),e.getDataController().connectionInfo.isInChat()||e.getDataController().connectionInfo.loadFromLocalStorage(),i.set("userId",e.getDataController().connectionInfo.get("userId")),e.widgetLayout=new c.default.WidgetLayout({viewController:e,rm:e.rm,model:i,widgetSettings:e.options}),e.widgetLayout.render(),e.widgetLayout.onHide(),!e.getDataController().connectionInfo.get("chatActiveInOtherWindow")&&e.getDataController().connectionInfo.get("disabled")&&e.getDataController().connectionInfo.get("roomId")?e.widgetLayout.$el.hide():e.getDataController().connectionInfo.get("chatActiveInOtherWindow")&&e.widgetLayout.triggerMethod("collapse");var s=function(){var n=(0,r.$)(t.get("renderInto"));n.append(e.widgetLayout.$el),n.on("selectionShow",function(){e.triggerMethod("selectionShow")}),e.bindGobalCommand(e.widgetLayout.$el),e.triggerMethod("rendered"),e.options.get("dataController").options.chatModel=e.getChatModel(),e.listenTo(i,"change:state",e.stateChange),i.set("state",e.options.get("initialState")||p.default.WidgetStates.Initializing),e.listenTo(e.widgetLayout.$el,"change:state",e.stateChange),e.widgetLayout.$el.removeClass("purechat-hide"),e.widgetLayout.triggerMethod("afterInsertion"),e.trigger("widget:ready"),e.chatModel.get("expanded")||!e.options.useMobile()||e.options.isDesktopDimension()||setTimeout(function(){e.widgetLayout.collapseMobile()},1e3),e.setUpUiTriggers(),e.startVisitorTracking()};if(e.options.get("isOperator"))s();else{var a=!1,l=e.options.get("BrowserDetails").Browser||"",u=(parseFloat(e.options.get("BrowserDetails").Version||""),e.options.get("BrowserDetails").OS||"Other"),h=e.getStyleURL(),d=(0,r.$)('<link rel="stylesheet" href="'+h+'" type="text/css">'),g=0;if(/safari/i.test(l)&&"Windows"==u){d.appendTo("head");var f=setInterval(function(){(d[0].sheet||g>=150)&&(a||(a=!0,f=clearInterval(f),s())),g++},100)}else d.appendTo("head").on("load",function(){a=!0,s()})}};if(window.pcDashboard)var a=r.$.Deferred().resolve();else var a=r.$.Deferred().resolve();var l=e.setupDataController(t,i);r.$.when(l,a).done(s).fail(function(){e.trigger("widget:fail")}),this.on("all",function(){e.state&&e.state.triggerMethod.apply(e.state,arguments)}),this.on("chat:start",function(){e.disableVisitorTrackingInactivity()}),this.on("chat:end",function(){e.enableVisitorTrackingInactivity()})}else t.get("VisitorTrackingEnabled")&&(this.setupPageActivityTest(),this.startVisitorTracking())},setUpUiTriggers:function(){new y.default(this),new w.default(this)},setupDataController:function(t,e){var i=this.options.get("dataController").loadWidgetSettings();return this.setDataController(this.options.get("dataController")),i},setupPageActivityTest:function(){var t=this,e=null,i=-9999,n=-9999;t.pageActivity=!1,(0,r.$)(document).on("mousemove.setupPageActivityTest",r.$.throttle(1e4,function(r){e&&clearTimeout(e),Math.abs(i-r.clientX)<=2&&Math.abs(n-r.clientY)<=2||(i=r.clientX,n=r.clientY,t.pageActivity=!0,e=setTimeout(function(){t.pageActivity=!1},45e3))}))},onSelectionShow:function(){this.state&&this.state.triggerMethod("selectionShow")},stateChange:function(t,e){var i=new x.default[e](this.options);this.setState(i)},setState:function(t){var e=this.state,i={};null!=this.state&&(i=this.state.status,this.state.triggerMethod("exit"),this.state.destroy()),this.state=t,this.state.status=i,this.state.setChatModel(this.getChatModel()),this.state.setWidgetView(this.widgetLayout),this.state.setWidgetSettings(this.options),this.state.setResources(this.rm),this.state.setDataController(this.getDataController()),this.state.setViewController(this),this.trigger("state:changed",{oldState:e,newState:t}),this.state.triggerMethod("enter"),this.triggerResizedEvent()},bindGobalCommand:function(t){var e=this;t.on("click.delegateEvents","[data-command]",function(t){t.preventDefault();var i=(0,r.$)(this),n=i.data("command"),o=i.data("command-params");e.trigger(n,o)})},showConfirmationDialog:function(){return r.$.Deferred.resolve()},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},onClose:function(){},onDestroy:function(){(0,r.$)(document).off(".setupPageActivityTest");var t=this.getDataController();t.unbindHandlerEvents(),t.chatServerConnection=null,t.destroy(),this.widgetLayout.destroy(),this.state.destroy(),this.state=null,this.widgetLayout=null,this.setDataController(null),this.setChatModel(null),this.resizeTrigger&&(clearTimeout(this.resizeTrigger),this.resizeTrigger=null),this.resizeTrigger2&&(clearTimeout(this.resizeTrigger2),this.resizeTrigger2=null),this.options&&(this.options.attributes.dataController=null,this.options.attributes.renderInto=null,this.options._previousAttributes.dataController=null,this.options._previousAttributes.renderInto=null,this.options=null),this.unbindAppLevelCommands()},roomHostChanged:function(t){var e=this.getChatModel();for(var i in t)e.set(i,t[i],{silent:!0});e.trigger("roomHostChanged")}});e.PureChatController=E},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,
e}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=i(4),a=r(s),l=i(53),c=n(l),u=i(57),h=n(u),d=i(55),p=(n(d),i(56)),g=n(p),f=i(65),m=n(f),v=i(66),b=n(v),y=i(67),_=n(y),w=i(68),C=n(w),x=i(69),k=n(x),M=i(70),S=n(M),I=i(71),A=n(I),T=i(72),E=n(T),R=i(73),P=n(R),N=i(74),D=n(N),j=i(75),O=n(j),B=i(76),U=n(B),V=i(77),W=n(V),F=i(78),$=n(F),L=i(79),z=n(L),H=i(80),q=n(H),Q=i(81),G=n(Q),J=i(82),K=n(J);o.backbone.View.prototype.getResource=function(t,e){return c.default.getOption(this,"rm").getResource(t,a.defaults(e||{},{chatUserNames:""}))},c.default.View.prototype.mixinTemplateHelpers=function(t){t=t||{};var e=this.templateHelpers||{};return a.isFunction(e)&&(e=e.call(this)),t.getResource=a.bind(o.backbone.View.prototype.getResource,this),a.extend(t,e,{Utils:h.default})};var Y=new h.default.Notifier,X={};X.Spinner=c.default.ItemView.extend({template:D.default,className:"purechat-spinner-wrapper"}),X.WidgetLayout=c.default.LayoutView.extend({template:null,className:"purechat",optionsStepShown:!1,maxWidth:700,missedMessageCount:0,_audioNotificationLocalStorageKey:"_purechatVisitorWidgetPlaySound",regions:{content:".purechat-content",personalDetails:".purechat-personal-details-container"},events:{"click [data-trigger]":"executeCommand",mouseenter:"peekWidget",mouseleave:"unpeekWidget","click .purechat-show-personal-details":"showPersonalDetailsOnMobile","click .purechat-toggle-audio-notifications":"updatePlayAudioLocalStorage"},childEvents:{roomHostChanged:function(t,e){this.showRoomHostAvatar(e.get("roomHostAvatarUrl"),e.get("expanded"))}},modelEvents:{"change:operatorsAvailable":"operatorsAvailableChanged","api:change":"apiRoomDetailsChanged"},ui:{content:".purechat-content",purechatCollapsed:".purechat-collapsed",collapsedTabWrapper:".purechat-collapsed .purechat-collapsed-outer",titleWrapper:".purechat-collapsed .purechat-widget-title",title:".purechat-expanded .purechat-widget-title-link",collapsedTitle:".purechat-collapsed .purechat-preview-text",popoutButton:'[data-trigger="popOutChat"]',closeButton:'[data-trigger="closeChat"]',removeWidgetButton:'[data-trigger="removeWidget"]',restartButton:'[data-trigger="restartChat"]',requeueButton:'[data-trigger="requeueChat"]',leaveButton:'[data-trigger="leaveChat"]',widgetCollapsed:".purechat-collapsed",widgetExpanded:".purechat-expanded",collapseImage:".collapsed-image",personalDetails:".purechat-personal-details-container",expandMobileButton:".purechat-expand-mobile-button",menuBar:".purechat-collapsed .purechat-menu",poweredBy:".purechat-content-wrapper div:last-child",poweredByHosted:".purechat-poweredby-container",roomAvatarUrl:".purechat-widget-room-avatar",purechatTitleImage:".purechat-title-image",superMinimizeButton:".purechat-super-minimize-link-button",missedMessageCount:".purechat-missed-message-count"},templateHelpers:function(){var t=this;return o.$.extend({isDesktopDimension:function(){return t.options.viewController.isDesktopDimension()},MobileDisplayTypes:g.default.MobileDisplayTypes},this.settings)},setWidgetShown:function(){window.sessionStorage.setItem("purechat_widgetShown",!0)},widgetShown:function(){return"true"===window.sessionStorage.getItem("purechat_widgetShown")},apiRoomDetailsChanged:function(t,e,i){this.options.viewController.apiRoomDetailsChanged(t,e,i)},updatePlayAudioLocalStorage:function(t){var e=(0,o.$)(t.currentTarget),i=e.find("i");return i.hasClass("pc-icon-unmute")?(localStorage[this._audioNotificationLocalStorageKey]=!1,i.removeClass("pc-icon-unmute").addClass("pc-icon-mute")):(localStorage[this._audioNotificationLocalStorageKey]=!0,i.addClass("pc-icon-unmute").removeClass("pc-icon-mute")),!1},hideRoomHostAvatar:function(){this.ui.roomAvatarUrl.removeAttr("style").hide(),this.ui.title.removeClass("purechat-has-room-avatar"),this.ui.purechatTitleImage.show(),(this.$el.hasClass("purechat-top")||this.settings.get("poppedOut"))&&this.$el.removeClass("purechat-adjust-for-avatar")},showRoomHostAvatar:function(t,e){"undefined"!=typeof e&&(t&&e?(this.ui.roomAvatarUrl.css({"background-image":"url("+t+")"}).show(),this.ui.title.addClass("purechat-has-room-avatar"),this.ui.purechatTitleImage.hide(),(this.$el.hasClass("purechat-top")||this.settings.get("poppedOut"))&&this.$el.addClass("purechat-adjust-for-avatar")):this.hideRoomHostAvatar())},updateRoomHostName:function(t){if(t)this.setExpandedTitle(this.getResource("chat_nowChattingWith",{chatUserNames:[t]}),"chat_nowChattingWith");else{var e=this.settings.useMobile()&&!this.settings.isDesktopDimension(),i=e?"mobile_expandButton":"title_initial";this.setExpandedTitle(this.getResource(i),null,i)}},showPersonalDetailsOnMobile:function(){var t=this;return this.$el.find(".purechat-personal-details-container").removeClass("purechat-hide"),setTimeout(function(){t.$el.find(".purechat-personal-details-container").css({left:0})},10),!1},resetPoweredBy:function(){var t=this.settings.useMobile()&&!this.settings.isDesktopDimension();this.settings.get("RemoveBranding")||this.settings.get("isOperator")||(this.ui.poweredBy.html(this._originalPoweredBy),this.ui.poweredByHosted.html(this._originalPoweredBy),this.settings.get("isPersonalChat")||(this.ui.poweredBy.css({"text-align":t?"left":"right"}),this.ui.poweredByHosted.css({"text-align":"right"})))},updatePoweredBy:function(t){this.settings.useMobile()&&!this.settings.isDesktopDimension();this.settings.get("isOperator")||!t||this.settings.get("RemoveBranding")||(this.ui.poweredBy.html(t),this.ui.poweredByHosted.html(t),this.settings.get("isPersonalChat")||(this.ui.poweredBy.css({"text-align":"center"}),this.ui.poweredByHosted.css({"text-align":"center"})))},showSpinner:function(t){if(!t)throw new Error("No jquery element was specified when trying to create a Pure Chat spinner");t="function"==typeof t.data?t:(0,o.$)(t);var e=new X.Spinner;e.render(),e.$el.appendTo(t),t.data("purechatSpinner",e)},hideSpinner:function(t){if(!t)throw new Error("No jquery element was specified when trying to create a Pure Chat spinner");t="function"==typeof t.data?t:(0,o.$)(t);var e=t.data("purechatSpinner");e&&e.destroy(),t.removeData("purechatSpinner")},bindAppCommands:function(){var t=this;try{m.default.commands.removeHandler("poweredby:update"),m.default.commands.removeHandler("poweredby:reset"),m.default.commands.removeHandler("spinner:show"),m.default.commands.removeHandler("spinner:hide")}catch(t){}finally{m.default.commands.setHandler("poweredby:update",function(){t.updatePoweredBy.apply(t,arguments)}),m.default.commands.setHandler("poweredby:reset",function(){t.resetPoweredBy.apply(t,arguments)}),m.default.commands.setHandler("spinner:show",function(){t.showSpinner.apply(t,arguments)}),m.default.commands.setHandler("spinner:hide",function(){t.hideSpinner.apply(t,arguments)})}},repositionWidget:function(){var t={1:"purechat-bottom purechat-bottom-left",2:"purechat-bottom purechat-bottom-right",3:"purechat-top purechat-top-left",4:"purechat-top purechat-top-right",9999:"purechat-widget-button"};for(var e in t)this.$el.removeClass(t[e]);this.model.get("isPoppedOut")||this.settings.get("isDirectAccess")||(this.settings.get("WidgetType")==g.default.WidgetType.Button?this.$el.addClass(t[9999]):this.$el.addClass(t[this.settings.get("Position")]))},chooseWidgetTemplate:function(){var t=this.settings.useMobile(),e=this.settings.isMobileRequest()&&this.settings.get("isPersonalChat");this.settings.get("isDirectAccess")?(this.template=z.default,this.$el.addClass("purechat-widget purechat-hosted-widget")):t&&this.settings.get("isDemo")?this.template=q.default:this.settings.get("isOperator")?(this.template=G.default,this.$el.addClass("purechat-operator")):this.settings.get("poppedOut")?(this.template=K.default,this.$el.addClass("purechat-window purechat-popped-out-widget")):!t||e||this.settings.isDesktopDimension()?(this.template=$.default,this.$el.addClass("purechat-widget purechat-hide")):(this.template=$.default,this.$el.addClass("purechat-window purechat-popped-out-widget purechat-not-clickable purechat-hide"))},showhideMinimizeButton:function(){this.settings.get("ShowMinimizeWidgetButton")?this.ui.superMinimizeButton.show():this.ui.superMinimizeButton.hide()},bindWidgetSettingsChanges:function(){this.listenTo(this.settings,"change",a.default.bind(this.updateImageTransform,this)),this.listenTo(this.settings,"change:ShowMinimizeWidgetButton",a.default.bind(this.showhideMinimizeButton,this)),this.listenTo(this.settings,"change:CollapsedStyle",a.default.bind(this.updateCollapsedStyle,this)),this.listenTo(this.settings,"change:AvailableCollapsedWidgetImageUrl",a.default.bind(this.updateImageSource,this)),this.listenTo(this.settings,"change:UnavailableCollapsedWidgetImageUrl",a.default.bind(this.updateImageSource,this)),this.listenTo(this.settings,"change:AvailableImageXOffset",a.default.bind(this.updateImageTransform,this)),this.listenTo(this.settings,"change:AvailableImageYOffset",a.default.bind(this.updateImageTransform,this)),this.listenTo(this.settings,"change:UnavailableImageXOffset",a.default.bind(this.updateImageTransform,this)),this.listenTo(this.settings,"change:UnavailableImageYOffset",a.default.bind(this.updateImageTransform,this))},getOperatorsAvailable:function(){return"undefined"==typeof this.model.get("operatorsAvailable")||this.model.get("operatorsAvailable")},updateCollapsedStyle:function(){var t=this.settings.useMobile(),e=this.getOperatorsAvailable()||this.options.widgetSettings.get("UseAvailableImageForBoth"),i=this.settings.absoluteCollapsedImageUrl(e);if(i){var n=' <img class="collapsed-image" src="'+i+'" data-trigger="expand" style="'+this.settings.collapsedImageCss(e)+'" />';this.ui.collapseImage&&(this.ui.collapseImage.remove(),this.ui.collapseImage=null),!this.settings.isDesktopDimension()&&t||!this.settings.showImage()||(n=(0,o.$)(n),e&&this.settings.get("AvailableCollapsedWidgetImageUrl")?this.ui.collapseImage=n:!e&&this.settings.get("UnavailableCollapsedWidgetImageUrl")&&(this.ui.collapseImage=n),this.ui.collapseImage&&(this.settings.isTabTop()?(this.ui.collapseImage=(0,o.$)(n),this.ui.purechatCollapsed.append(this.ui.collapseImage)):(this.ui.collapseImage=(0,o.$)(n),this.ui.purechatCollapsed.prepend(this.ui.collapseImage))))}this.settings.showTab()?this.ui.collapsedTabWrapper.show():this.ui.collapsedTabWrapper.hide(),this.settings.get("CollapsedStyle")==g.default.WidgetType.Button&&(0,o.$)(".purechat-button-expand").css("visibility","visible")},initialize:function(){var t=this;this.model.set("superMinimize",this.isSuperMinimized()),c.default.LayoutView.prototype.initialize.call(this),this.settings=c.default.getOption(this,"widgetSettings"),this.chooseWidgetTemplate(),this.repositionWidget(),this.bindWidgetSettingsChanges(),this.bindAppCommands(),this.settings.showPlaySoundCheckbox=function(){return(!t.settings.get("isOperator")||t.settings.get("isPersonalChat"))&&!t.settings.useMobile()},this.settings.playSoundOnNewMessage=function(){return"true"==(localStorage[t._audioNotificationLocalStorageKey]||"false").toLowerCase()}},isSuperMinimized:function(){var t=this.options.widgetSettings.get("CollapsedStyle");return 3!==t&&"true"===(window.localStorage.superMinimize||"false").toLowerCase()},setTitle:function(t,e){this.setCollapsedTitle(t,e),this.setExpandedTitle(t,e)},setCollapsedTitle:function(t,e){var i=this;this.debounceCollapsedTitleId&&(this.debounceCollapsedTitleId=clearTimeout(this.debounceCollapsedTitleId)),this.debounceCollapsedTitleId=setTimeout(function(){i.ui.collapsedTitle.html(t).attr("title",t).attr("data-resourcekey",e).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){(0,o.$)(this).removeClass("purechat-animate purechat-toast-x purechat-clickable"),i.debounceCollapsedTitleId=null,i.setWidgetShown()}).addClass("purechat-animate purechat-toast-x purechat-clickable")},50)},setExpandedTitle:function(t,e){this.ui.title.text(t).attr("title",t),this.ui.title.attr("data-resourcekey",e),this.options.widgetSettings.get("isPersonalChat")&&this.options.widgetSettings.get("isInEditorMode")?(this.ui.title.data("isTitleEditor",!0),this.ui.collapsedTitle.data("isTitleEditor",!0),window.pcPersonalEditor.execute("editButton:show",[this.ui.title,this.ui.collapsedTitle])):this.model.get("isPoppedOut")&&(window.document.title=t)},updateImageSource:function(){var t=this,e=this.getOperatorsAvailable()||this.options.widgetSettings.get("UseAvailableImageForBoth");if(this.ui.collapseImage){var i=new Image;i.src=e?this.options.widgetSettings.get("AvailableCollapsedWidgetImageUrl"):this.options.widgetSettings.get("UnavailableCollapsedWidgetImageUrl"),i.onload=function(){t.options.widgetSettings.set({ImageHeight:i.naturalHeight,ImageWidth:i.naturalWidth},{silent:!0}),t.ui.collapseImage.attr("src",e?t.options.widgetSettings.get("AvailableCollapsedWidgetImageUrl"):t.options.widgetSettings.get("UnavailableCollapsedWidgetImageUrl")),t.updateImageTransform(),setTimeout(function(){i=null},0)}}},updateImageTransform:function(){var t=this.getOperatorsAvailable()||this.options.widgetSettings.get("UseAvailableImageForBoth");this.options.widgetSettings.set("AvailableImageScale",Math.min(100,this.options.widgetSettings.get("AvailableImageScale")),{silent:!0}),this.options.widgetSettings.set("UnavailableImageScale",Math.min(100,this.options.widgetSettings.get("UnavailableImageScale")),{silent:!0}),this.ui.collapseImage&&this.ui.collapseImage.attr&&this.ui.collapseImage.attr("style",this.options.widgetSettings.collapsedImageCss(t))},hideAdditionalDetails:function(t){this.$el.find(".purechat-widget-sliding-panel").removeClass("expanded").addClass("collapsed"),this.$el.find(".additional-details").removeClass("purechat-hide"),this.$el.find(".purechat-widget-inner").removeClass("expanded"),this.$el.css({width:this.maxWidth-200})},showAdditionalDetails:function(){var t=this,e=t.$el.find(".purechat-widget-sliding-panel"),i=e.find(".spinner");i.removeClass("purechat-hide");var n=t.$el.find(".purechat-widget-inner .purechat-widget-header").outerHeight();t.$el.find(".purechat-widget-inner").addClass("expanded"),e.find(".purechat-widget-header").css({height:n,lineHeight:n+"px"}),e.find(".purechat-additional-content").css({top:n}),e.removeClass("collapsed").addClass("expanded"),i.addClass("purechat-hide")},executeCommand:function(t){if(t.preventDefault(),t.stopPropagation(),!this.settings.get("isInEditorMode")){var e=(0,o.$)(t.currentTarget),i=e.data("trigger"),n=e.data("trigger-params");return this.minimizeOnLoadTimeout&&(this.minimizeOnLoadTimeout=clearTimeout(this.minimizeOnLoadTimeout)),this.triggerMethod(i,n,t)}},getResizedImageDimensions:function(t,e,i){return{height:t*i,width:e*i}},clearAutoExpandTimeout:function(){this._autoExpandTimeout&&(this._autoExpandTimeout=clearTimeout(this._autoExpandTimeout))},normalizeMilliseconds:function(t){return 1e3*t},setAutoExpandTimeout:function(){var t=this;this._autoExpandTimeout=setTimeout(function(){t.expand(),t.clearAutoExpandTimeout()},this.normalizeMilliseconds(this.settings.get("ExpandWidgetTimeout")))},onSuperMinimize:function(t,e,i){var n=this.model.get("poppedOut")||this.model.get("isPoppedOut");if(!n){e&&e.stopPropagation();var r=this,o=function(){r.$el.removeClass("purechat-widget-expanded purechat-widget-collapsed"),r.$el.addClass("purechat-widget-super-collapsed"),r.$el.find(".purechat-btn-toolbar .purechat-btn-expand").show(),r.$el.find(".purechat-btn-toolbar .purechat-btn-collapse, .purechat-widget-content, .collapsed-image").hide(),r.$el.find(".purechat-super-minimize-link-button").css({display:"none"});var t=2*-(r.$el.outerHeight()/4)-4;r.$el.hasClass("purechat-bottom-right")||r.$el.hasClass("purechat-bottom-left")?r.$el.css({bottom:t}):r.$el.css({top:t}),r.model.set("superMinimized",!0),window.localStorage.superMinimize=!0};i?this.minimizeOnLoadTimeout=setTimeout(o,1e3):o(),this.trigger("minimized")}return!1},peekWidget:function(){this.settings.isMobileRequest()||this.$el.removeAttr("style")},unpeekWidget:function(){var t=this;!this.settings.isMobileRequest()&&t.$el.hasClass("purechat-widget-super-collapsed")&&(t.$el.hasClass("purechat-bottom-right")||t.$el.hasClass("purechat-bottom-left")?t.$el.css({bottom:2*-(t.$el.outerHeight()/4)-4}):t.$el.css({top:2*-(t.$el.outerHeight()/4)-4}))},operatorsAvailableChanged:function(){this.settings.get("isWidget")&&(this.model.get("operatorsAvailable")?(this.$el.addClass("purechat-button-available"),this.$el.removeClass("purechat-button-unavailable"),this.$el.removeAttr("disabled","disabled")):(this.$el.removeClass("purechat-button-available"),this.$el.addClass("purechat-button-unavailable"),0===this.options.widgetSettings.get("UnavailableBehavior")&&(this.$el.addClass("purechat-button-hidden"),this.$el.attr("disabled","disabled"))),this.updateCollapsedStyle())},onExpand:function(t,e){var i=e.collapse,n=e.superMinimize,r=this,o=r.options.widgetSettings.get("poppedOut")||r.options.widgetSettings.get("isDirectAccess"),s=!r.settings.get("isDemo")&&(!r.settings.get("isDirectAccess")&&r.settings.get("ForcePopout")&&!r.model.get("isPoppedOut")||r.settings.get("usePrototypeFallback")),a=this.settings.useMobile()&&!this.settings.isDesktopDimension();if(!s||o||r.options.widgetSettings.get("widgetWasPoppedOut"))r.options.widgetSettings.get("dataController").checkChatAvailable().done(function(t){r.model.set("operatorsAvailable",t.available),i||n||(r.$el.addClass("purechat-clickable").removeClass("purechat-not-clickable"),r.expand())});else{var l=r.options.viewController,c=r.options.viewController.getDataController();l.popoutChatOnExpand(c,c.options,l.chatModel,l.state,a),r.options.widgetSettings.set("widgetWasPoppedOut",!0)}this.resetMissedMessageCount()},mobileResize:function(){this.collapseMobile()},expandMobile:function(t,e){var i=this,n=i.$el;n.find(".purechat-widget-content"),n.find(".purechat-poweredby-container"),n.find(".purechat-widget-header");(0,o.$)(window).off("resize.RepositionWidget"),(0,o.$)("html").addClass("purechat-assist"),n.removeClass("slide-out-of-way").css({left:0}),this.ui.expandMobileButton.hide(),i.$el.addClass("purechat-clickable").removeClass("purechat-not-clickable"),(e||function(){}).call(i)},expand:function(t,e,i){var n=this;n.$el.removeClass("purechat-widget-super-collapsed");var r=function(){var t=function(){n.$el.find(".purechat-btn-toolbar .purechat-btn-expand").hide(),n.$el.find(".purechat-btn-toolbar .purechat-btn-collapse").show(),n.$el.find(".purechat-widget-content").show(),n.$el.find(".purechat-widget-content").parent().find("div:last").show(),n.showRoomHostAvatar(n.options.model.get("roomHostAvatarUrl")),n.ui.widgetCollapsed.hide(),n.ui.widgetExpanded.show(),n.$el.removeClass("purechat-widget-collapsed"),n.$el.addClass("purechat-widget-expanded")};e||"PCStateChatting"==n.model.get("state")||"PCStateClosed"==n.model.get("state")||!n.settings.get("StartChatImmediately")||n.settings.get("isInEditorMode"),t(),n.model.set({expanded:!0}),i&&i.expandSource&&(localStorage.expandSource=i.expandSource),n.trigger("expanded"),n.triggerResizedEvent()};window.localStorage.superMinimize=!1,n.settings.get("isDemo")||(localStorage.expanded=!0),n.settings.useMobile()&&!n.settings.isDesktopDimension()?(n.expandMobile(t,r),t&&(r(),n.$el.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"))):r()},collapseMobile:function(t,e){var i=this;(0,o.$)("html").removeClass("purechat-assist");var n=this.options.widgetSettings.get("isPersonalChat");if(!i.settings.get("isDirectAccess")&&!n&&!i.model.get("isPoppedOut")){this.ui.titleWrapper.hide(),this.ui.menuBar.hide(),t||this.ui.expandMobileButton.show();var r=i.$el,s=(0,o.$)(window).width(),a=this.ui.expandMobileButton,l=(a.outerWidth(),this.options.widgetSettings.get("killForPreview")),c=this.settings.isMobileRequest(),u=this.options.widgetSettings.isAllowedOnMobile();l||c||u||n||(r.addClass("slide-out-of-way").css({left:s-a.outerWidth()}),a.removeAttr("style")),i.$el.addClass("purechat-not-clickable").removeClass("purechat-clickable"),i.ui.collapsedTitle.addClass("purechat-clickable"),(e||function(){}).call(i)}},onCollapse:function(t){var e=this;if(!this.settings.get("isPersonalChat")){localStorage.removeItem("expandSource"),e.settings.get("isDemo")||(localStorage.expanded=!1),e.$el.removeClass("purechat-widget-expanded"),e.$el.addClass("purechat-widget-collapsed"),e.$el.find(".purechat-btn-toolbar .purechat-btn-expand, .collapsed-image").show(),e.$el.find(".purechat-super-minimize-link-button").css({display:"inline-block"}),this.showhideMinimizeButton(),e.$el.find(".purechat-btn-toolbar .purechat-btn-collapse, .purechat-widget-content").hide(),e.$el.find(".purechat-widget-content").parent().find("div:last").hide();var i=e.model.get("roomId")||e.settings.get("dataController").checkInRoom();this.hideRoomHostAvatar(),i&&2==e.settings.get("Type")?(e.ui.widgetCollapsed.hide(),e.ui.widgetExpanded.show(),e.settings.useMobile()&&!e.settings.isDesktopDimension()&&(e.$el.find(".purechat-expanded .purechat-menu .purechat-btn-expand").hide(),e.ui.widgetExpanded.off("click.ExpandWidgetForMobile").on("click.ExpandWidgetForMobile",function(){e.ui.widgetExpanded.off("click.ExpandWidgetForMobile"),e.expand()}))):(e.ui.widgetCollapsed.show(),e.ui.widgetExpanded.hide()),e.model.set("expanded",!1),e.trigger("collapsed"),e.triggerResizedEvent(),!e.settings.useMobile()||e.settings.isDesktopDimension()||t?(this.ui.titleWrapper.show(),this.ui.menuBar.show()):e.collapseMobile(t)}},onHide:function(){this.$el.addClass("purechat-button-hidden")},onShow:function(){var t=this;if((0!=t.settings.get("UnavailableBehavior")||t.model.get("isPoppedOut")||t.model.get("operatorsAvailable")||t.model.get("userId"))&&t.$el.removeClass("purechat-button-hidden"),t.ui.collapseImage&&t.ui.collapseImage.toggle(!this.isSuperMinimized()),!t.model.get("superMinimize")){var e=t.settings.get("PageLoadAnimation")||t.settings.get("DisplayWidgetAnimation"),i=this.options.viewController.getDataController().checkInRoom(),n=t.settings.get("isDemo"),r=t.model.get("expanded");!e||r||!n&&(n||i)||t.$el.addClass("purechat-"+e+" purechat-animated")}t.triggerResizedEvent()},triggerResizedEvent:function(){this.options.viewController.triggerResizedEvent()},flashNotification:function(t){Y.notify(t,this.ui.title,this.$el);var e=h.default.parseEmoticons(t);this.setCollapsedTitle(e)},incrementMissedMessageCount:function(){this.missedMessageCount+=1,this.ui.missedMessageCount.text(this.missedMessageCount),this.ui.missedMessageCount.show()},resetMissedMessageCount:function(){this.ui.missedMessageCount.hide(),this.ui.missedMessageCount.text(""),this.missedMessageCount=0},onRender:function(){this.updateCollapsedStyle(),this.ui.expandMobileButton.hide(),this.ui.menuBar.hide(),this.ui.titleWrapper.hide(),this.settings.get("isWidget")?this.ui.content.addClass("purechat-widget-content"):(this.$el.addClass("purechat-window"),this.ui.content.addClass("purechat-window-content")),this.operatorsAvailableChanged(),this.setExpandedTitle(this.settings.get("title")||"");var t=null!==this.settings.get("dataController").checkInRoom()&&"undefined"!=typeof this.settings.get("dataController").checkInRoom();this.settings.get("isDemo")||"true"!=localStorage.expanded||this.settings.get("ForcePopout")||this.settings.get("usePrototypeFallback")||!t&&this.settings.get("StartChatImmediately")?this.model.get("superMinimize")?(this.onCollapse(!0),this.onSuperMinimize(null,null,!0)):this.onCollapse(!0):this.expand(!0,t),this.$el.hasClass("purechat-top")&&this.$el.find(".pc-icon-caret-down").removeClass("pc-icon-caret-down").addClass("pc-icon-caret-up"),this.settings.get("isPersonalChat")&&(1==this.settings.get("UserWidgetSettings").get("BackgroundType")&&this.settings.get("UserWidgetSettings").get("CustomBackgroundImage")&&this.settings.get("UserWidgetSettings").get("CustomBackgroundImage").FileId?(0,o.$)("#background-image").css({"background-image":'url("'+this.settings.get("pureServerUrl")+"/files/download/"+this.settings.get("UserWidgetSettings").get("CustomBackgroundImage").FileId+"."+this.settings.get("UserWidgetSettings").get("CustomBackgroundImage").FileExtension+'")'}):2==this.settings.get("UserWidgetSettings").get("BackgroundType")&&this.settings.get("UserWidgetSettings").get("StockBackgroundImage")&&"none"!=this.settings.get("UserWidgetSettings").get("StockBackgroundImage").Url.toLowerCase()?(0,o.$)("#background-image").css({"background-image":'url("'+this.settings.get("pureServerUrl")+this.settings.get("UserWidgetSettings").get("StockBackgroundImage").Url+'")'}):((0,o.$)("#background-image").addClass("purechat-hide"),(0,o.$)("body").css({backgroundColor:"#"+this.settings.get("UserWidgetSettings").get("BackgroundColor")}))),this._originalPoweredBy=this.ui.poweredBy.html()||this.ui.poweredByHosted.html(),this.showhideMinimizeButton()},onAfterInsertion:function(){var t=this,e=!1;this.model.get("isOperator")||this.settings.useMobile()&&!this.settings.isDesktopDimension()&&(t.$el.hasClass("purechat-widget-expanded")?(t.expandMobile(),e=!0):t.collapseMobile(!0))}}),X.StartChatForm=c.default.ItemView.extend({template:O.default,className:"purechat-start-chat-form",events:{"submit form":"startChatSubmit","keydown textarea":"keyDown"},modelEvents:{change:"render"},ui:{form:".purechat-form",userDisplayName:".purechat-name-input",userDisplayFirstName:".purechat-firstname-input",userDisplayLastName:".purechat-lastname-input",userDisplayCompany:".purechat-company-input",email:".purechat-email-input",question:".purechat-question-input",userDisplayNameError:".please-entername",emailError:".please-enteremail",questionError:".please-enterquestion",phoneNumber:".purechat-phonenumber-input",unavailablePhoneNumber:".purechat-unavailablephone-input",phoneNumberError:".please-enterphonenumber",unavailablePhoneError:".please-enterunavailablephone",userDisplayFirstNameError:".please-enterfirstname",userDisplayLastNameError:".please-enterlastname",userDisplayCompanyError:".please-entercompany"},keyDown:function(t){},startChatSubmit:function(t){t.preventDefault();var e=this;if(!this.submitDelay){this.submitDelay=!0,setTimeout(function(){delete e.submitDelay},500);var i=c.default.getOption(this,"FormType"),n=this.model.get(k.default),r=this.options.settings.get("StartChatImmediately"),s=this.model.get("AskForFirstName")&&(n||!r),a=this.model.get("AskForLastName")&&(n||!r),l=this.model.get("AskForCompany")&&(n||!r),u=this.model.get("AskForEmail")&&(n||!r),d=this.model.get("AskForQuestion")||r,p=this.model.get("AskForPhoneNumber")&&(n||!r),g=null,f=null;s&&(f=o.$.trim(this.ui.userDisplayFirstName.val()));var m=null;a&&(m=o.$.trim(this.ui.userDisplayLastName.val()));var v=null;l&&(v=o.$.trim(this.ui.userDisplayCompany.val()));var b=null;(u||"email"===i)&&(b=this.ui.email.val());var y=this.ui.question.val()||this.model.get("InitialVisitorQuestion");if(this.ui.form.find('[class*="please"]').hide(),"string"==typeof f&&0==f.length)return this.ui.userDisplayFirstNameError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof m&&0==m.length)return this.ui.userDisplayLastNameError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof b&&0==b.length)return this.ui.emailError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof v&&0==v.length)return this.ui.userDisplayCompanyError.show(),e.options.viewController.triggerResizedEvent(),!1;var _=this.ui.phoneNumber.val()||this.ui.unavailablePhoneNumber.val()||this.model.get("InitialVisitorPhoneNumber");if(p){if(0==_.length)return this.ui.phoneNumberError.show(),e.options.viewController.triggerResizedEvent(),!1;this.ui.phoneNumberError.hide(),e.options.viewController.triggerResizedEvent(),this.ui.phoneNumber.val(_)}else if("email"==i&&this.model.get("UnavailableAskForPhone")){if(0==_.length)return this.ui.unavailablePhoneError.show(),e.options.viewController.triggerResizedEvent(),!1;this.ui.unavailablePhoneError.hide(),e.options.viewController.triggerResizedEvent(),this.ui.unavailablePhoneNumber.val(_)}if(d&&(null===y||""==o.$.trim(y)))return this.ui.questionError.show(),e.options.viewController.triggerResizedEvent(),!1;f=f||e.options.viewController.getPublicApi().get("visitor_firstName")||this.model.get("InitialVisitorFirstName"),m=m||e.options.viewController.getPublicApi().get("visitor_lastName")||this.model.get("InitialVisitorLastName"),v=v||e.options.viewController.getPublicApi().get("visitor_company")||this.model.get("InitialVisitorCompany"),b=b||e.options.viewController.getPublicApi().get("visitor_email")||this.model.get("InitialVisitorEmail"),y=y||e.options.viewController.getPublicApi().get("visitor_question"),_=_||e.options.viewController.getPublicApi().get("visitor_phonenumber"),f?(g=f,m&&(g+=m)):m?g=m:(g="Visitor",f="Visitor"),g=f+" "+m,this.model.set({Name:g,FirstName:f,LastName:m,Company:v,Email:b,Question:y,PhoneNumber:_}),this.model.trigger("formSubmit",{visitorName:h.default.escapeHtml(h.default.stripDangerousTags(g||""),!0),visitorFirstName:h.default.escapeHtml(h.default.stripDangerousTags(f||""),!0),visitorLastName:h.default.escapeHtml(h.default.stripDangerousTags(m||""),!0),visitorCompany:h.default.escapeHtml(h.default.stripDangerousTags(v||""),!0),visitorEmail:h.default.escapeHtml(h.default.stripDangerousTags(b||""),!0),visitorQuestion:h.default.escapeHtml(h.default.stripDangerousTags(y||""),!1),visitorPhoneNumber:h.default.escapeHtml(h.default.stripDangerousTags(_||""),!0)})}},isMobile:function(){return this.options.settings.useMobile()&&this.options.settings.isDesktopDimension()},onClose:function(){this.options.settings.get("isPersonalChat")&&this.options.settings.get("isInEditorMode")&&window.pcPersonalEditor&&window.pcPersonalEditor.execute("editButton:hide",this.$el.find("[data-resourcekey]"))},onRender:function(){this.options.settings.get("isPersonalChat")&&(this.$el.find("#purechat-name-submit").addClass("button"),this.options.settings.get("isInEditorMode")&&window.pcPersonalEditor&&(this.$el.find("input, textarea").prop("disabled",!0),window.pcPersonalEditor.execute("editButton:show",this.$el.find("[data-resourcekey]"))))}}),X.StartChatFormAutomatically=X.StartChatForm.extend({template:U.default,templateHelpers:function(){var t=this;return{isMobile:function(){return t.isMobile()},personalAvatarUrl:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){return"undefined"!=typeof personalAvatarUrl?personalAvatarUrl:t.PureServerUrl()+"/content/images/avatars/1avatar-operator-skinny.png"}),isPersonalChat:function(){return t.isPersonalChat()}}},isPersonalChat:function(){return this.options.settings.get("isPersonalChat")},PureServerUrl:function(){return this.options.settings.get("pureServerUrl")},isMobile:function(){return this.options.settings.useMobile()&&!this.options.settings.isDesktopDimension()},format:function(t){return t=t.replace(/\n/g," <br/> "),t=h.default.formatWhitespace(t),t=h.default.linkify(h.default.parseEmoticons(t))},keyDown:function(t){return!(13===t.keyCode&&!t.shiftKey)||(t.ctrlKey?(this.ui.question.val(this.ui.question.val()+"\n"),!0):(this.startChatSubmit(t),!1))},initialize:function(){var t=this;this._originalOnRender=this.onRender,this.onRender=function(){t._originalOnRender()}},onRender:function(){this.isPersonalChat()&&this.$el.addClass("personal"),this.options.settings.get("isPersonalChat")&&this.options.settings.get("isInEditorMode")&&this.$el.find("textarea.purechat-send-form-message").prop("disabled",!0);var t=this.$(".purechat-new-thought").html();this.$(".purechat-new-thought").html(this.format(t))}}),X.EmailSent=c.default.ItemView.extend({template:S.default,className:""}),X.MessageView=c.default.ItemView.extend({template:E.default,className:"purechat-message-wrapper purechat-clearfix",ui:{},modelEvents:{change:"render"},onRender:function(){window.pcPersonalEditorSettings&&window.pcPersonalEditorSettings.get("isPersonalChat")&&window.pcPersonalEditorSettings.get("isInEditorMode")&&window.pcPersonalEditor&&window.pcPersonalEditor.execute("editButton:show",this.$el.find("[data-resourcekey]")),
this.$el.attr({"data-userid":this.model.get("userId")});var t=this.model.get("type")||"";this.$el.addClass("message"!=t.toLowerCase()?t:""),this.$el.addClass(this.model.get("isClosedChat")?"closed":"")}}),X.EmptyView=c.default.ItemView.extend({template:a.default.template(""),className:"empty-item",events:{}}),X.MessageListView=c.default.CompositeView.extend({template:A.default,className:"purechat-message-list-view",cannedResponseCollection:null,initialize:function(){this.chatModel=c.default.getOption(this,"chatModel"),this.chatModel.get("scrollBottom")||this.chatModel.set("scrollBottom",0)},getScrollBottom:function(){return this.chatModel.get("scrollBottom")},setScrollBottom:function(t){this.chatModel.set("scrollBottom",t)},ui:{messageListContainer:".purechat-message-display",textInput:"textarea",disableTextArea:".disableTextArea",form:"form",displayContainer:".purechat-message-display-container",userStatus:".purechat-user-status",showPrevious:".purechat-showPrevious"},childView:X.MessageView,emptyView:X.EmptyView,childViewContainer:".purechat-message-display",templateHelpers:function(){var t=this,e=this.options.settings,i={isPersonalChat:function(){return e.get("isPersonalChat")||!1},isMobile:function(){return t.options.settings.useMobile()&&!t.options.settings.isDesktopDimension()}};return i},collectionEvents:{change:"listChanged",add:"listChanged"},listChanged:function(t,e,i){var n=this;this.showMessages||(this.showMessages=setTimeout(function(){n.ui.messageListContainer.show()},100)),t.get("isClosedChat")||0==n.getScrollBottom()||0!=n.ui.messageListContainer.scrollTop()||n.setScrollBottom(n.ui.messageListContainer[0].scrollHeight-n.ui.messageListContainer.height()),t.get("isClosedChat")||this.model.get("userId")!=t.get("userId")||n.setScrollBottom(0),n.getScrollBottom()<=50&&n.setScrollBottom(0),(0==n.getScrollBottom()||t.get("isClosedChat"))&&(n.scrollTimeout&&(clearTimeout(n.scrollTimeout),n.scrollTimeout=null),n.scrollTimeout=setTimeout(function(){n.scrollTimeout=null,n.updateScroll()},0))},updateScroll:function(){var t=this;t.ui.messageListContainer.scrollTop(t.ui.messageListContainer[0].scrollHeight-t.ui.messageListContainer.height()-t.getScrollBottom())},modelEvents:{change:function(t){this.triggerMethod("roomHostChanged",t)},"change:HasMoreTransactions":"updatePreviousVisibility"},events:{"keydown textarea":"keyDown","keyup textarea":"keyUp","submit form":"postMessage","refreshAutoCompleteSource textarea":function(){var t=this;t.cannedResponseCollection=[],pcDashboard.CannedResponses.ResponseCollection.forEach(function(e){t.cannedResponseCollection.push({label:e.get("Content"),value:(0,o.$)("<div/>").html(e.get("Content")).text()})}),t.ui.textInput.trigger("disableAutoComplete").trigger("enableAutoComplete")},"disableAutoComplete textarea":function(){this.ui.textInput.autocomplete("destroy")},"enableAutoComplete textarea":function(){var t=this;this.ui.textInput.autocomplete({source:function(e,i){var n=(CurrentUser.get("cannedResponseSettings").get("MatchStartOfCannedResponse")?"^":"")+o.$.ui.autocomplete.escapeRegex(e.term),r=new RegExp(n,"im");i(o.$.grep(t.cannedResponseCollection,function(t){return r.test(t.label||t.value)}))},delay:100,position:{my:"bottom",at:"top"},open:function(){var t=(0,o.$)(this).autocomplete("widget");(0,o.$)("<div />").addClass("arrow pure-chat-auto-complete-arrow").appendTo("body").position({my:"center",at:"left+32 bottom+5",of:t}).css({zIndex:parseInt(t.css("z-index"))+1})},close:function(){(0,o.$)(".pure-chat-auto-complete-arrow").remove()}}),this.ui.textInput.autocomplete("widget").addClass("canned-responses-autocomplete")},"click textarea":"expandForm","blur textarea":"collapseForm","click .purechat-showPrevious":"showPrevious"},showPrevious:function(){this.triggerMethod("showPrevious")},getLastMessageWithId:function(t){var e=null;return this.collection.forEach(function(i){i.get("userId")&&i.get("messageId")!=t&&(e=i)}),e},onDestroy:function(){(0,o.$)(window).off("resize.ScrollToTopMobile"),this.$el.find(".purechat-message-display").off("scroll")},updatePreviousVisibility:function(){this.model.get("HasMoreTransactions")?this.ui.showPrevious.show():this.ui.showPrevious.hide()},onRender:function(){var t=this;if(t.ui.messageListContainer.hide(),this.ui.messageListContainer.on("scroll.displayContainer",function(){var e=t.options.viewController;t.setScrollBottom(t.ui.messageListContainer[0].scrollHeight-t.ui.messageListContainer.height()-t.ui.messageListContainer.scrollTop()),t.getScrollBottom()<=80&&e.scrolledToBottom&&e.scrolledToBottom()}),this.options.settings.get("isInvisible")&&(this.ui.textInput.attr("disabled","disabled"),this.ui.disableTextArea.show()),this.options.settings.get("isOperator")){if(this.cannedResponseCollection=pcDashboard.CannedResponses.ResponseCollection,0==this.cannedResponseCollection.length){this.cannedResponseCollection=[];var e=this.options.settings.get("cannedResponses");for(var i in e)if("===separator==="!==e[i].content){var n={label:e[i].content,value:(0,o.$)("<div/>").html(e[i].content).text()};this.cannedResponseCollection.push(n)}}var t=this,r=window.$(this.ui.textInput).autocomplete({source:function(e,i){var n=(CurrentUser.get("cannedResponseSettings").get("MatchStartOfCannedResponse")?"^":"")+window.$.ui.autocomplete.escapeRegex(e.term),r=new RegExp(n,"im"),s=[];if(t.cannedResponseCollection.models&&t.cannedResponseCollection.models.length){var a=[];t.cannedResponseCollection.models.forEach(function(t){a.push({label:t.get("Content"),value:(0,o.$)("<div/>").html(t.get("Content")).text()})}),s=o.$.grep(a,function(t){return r.test(t.label||t.value)})}else s=o.$.grep(t.cannedResponseCollection,function(t){return r.test(t.label||t.value)});i(s)},delay:100,position:{my:"bottom",at:"top"},open:function(){var t=window.$(this).autocomplete("widget");window.$("<div />").addClass("arrow pure-chat-auto-complete-arrow").appendTo("body").position({my:"center",at:"left+32 bottom+5",of:t}).css({zIndex:parseInt(t.css("z-index"))+1})},close:function(){(0,o.$)(".pure-chat-auto-complete-arrow").remove()}});r.autocomplete("widget").addClass("canned-responses-autocomplete")}this.options.settings.get("isPersonalChat")&&(this.$el.find(".purechat-btn-close").css("display","inline-block"),this.options.settings.get("isInEditorMode")&&window.pcPersonalEditor&&(this.$el.find("textarea").prop("disabled",!0),window.pcPersonalEditor.execute("editButton:show",this.$el.find("[data-resourcekey]")))),this.updatePreviousVisibility()},keyDown:function(t){return!(13===t.keyCode&&!t.shiftKey)||(t.ctrlKey?(this.ui.textInput.val(this.ui.textInput.val()+"\n"),!0):(this.triggerMethod("typingChange",!1),this.activity=!1,this.ui.form.submit(),!1))},keyUp:function(){var t=this;t.typingTimeout&&(clearTimeout(t.typingTimeout),t.typingTimeout=null),this.typingTimeout=setTimeout(function(){try{""!=t.ui.textInput.val()?(t.activity=!0,t.triggerMethod("typingChange",!0)):(t.triggerMethod("typingChange",!1),t.activity=!1)}catch(t){}},2e3),""!=t.ui.textInput.val()&&1!=t.activity&&(t.triggerMethod("typingChange",!0),t.activity=!0)},postMessage:function(t){t.stopPropagation(),t.preventDefault();var e=this.ui.textInput.val();this.triggerMethod("newMessage",e),this.ui.textInput.val("");try{this.ui.textInput.autocomplete("close")}catch(t){}},typing:function(t,e,i){this.model.get("participants").set({userId:t,displayName:e,isTyping:i},{remove:!1}),this.ui.userStatus.html(this.model.get("participants").getOperatorTypingText(this)),i&&this.options.settings.get("isPersonalChat")&&this.options.settings.get("isInEditorMode")&&(this.ui.userStatus.find('[data-resourcekey="chat_typing"]').attr("data-username",a.default.escape(e)),window.pcPersonalEditor.execute("editButton:show",this.ui.userStatus.find("[data-resourcekey]")))},appendBuffer:function(t,e){var i=this.getItemViewContainer(t);i.append(e)},appendHtml:function(t,e,i){if(t.isBuffering)t.elBuffer.appendChild(e.el);else{var n=this.getItemViewContainer(t),r=n.find(".purechat-message-wrapper").last();r.length?r.after(e.el):n.append(e.el)}},destroy:function(){this.ui.messageListContainer.off("scroll.displayContainer")}}),X.ClosedOperatorView=X.MessageListView.extend({template:C.default,className:"purechat-message-list-view closed-operator-container",templateHelpers:function(){var t=this;return o.$.extend({getExportParams:function(){var e={chatId:t.options.settings.get("room").id,visitorEmail:t.options.settings.get("room").visitorEmail,visitorIPAddress:t.options.settings.get("room").visitorIPAddress,visitorPhoneNumber:t.options.settings.get("room").visitorPhoneNumber,visitorFirstName:t.options.settings.get("room").visitorFirstName,visitorLastName:t.options.settings.get("room").visitorLastName};return escape(JSON.stringify(e))}},this.options.settings)},events:{"click .email-transcript":"emailTranscript"},onRender:function(){this.ui.messageListContainer.show(),this.updateScroll()},emailTranscript:function(){var t=this.model.get("roomId"),e=new App.EmailPeople.Views.Email({model:new o.backbone.Model({transcriptId:t})}),i=new App.Views.CompositeViewDialog({title:"Email Transcript",view:e,width:500,contentHeight:"auto"});i.show()}}),X.EmailForm=c.default.ItemView.extend({template:k.default,className:"purechat-start-chat-form",ui:{form:".purechat-form",userDisplayName:".purechat-name-input",userDisplayFirstName:".purechat-firstname-input",userDisplayLastName:".purechat-lastname-input",userDisplayCompany:".purechat-company-input",email:".purechat-email-input",question:".purechat-question-input",userDisplayNameError:".please-entername",emailError:".please-enteremail",questionError:".please-enterquestion",phoneNumber:".purechat-phonenumber-input",unavailablePhoneNumber:".purechat-unavailablephone-input",phoneNumberError:".please-enterphonenumber",unavailablePhoneError:".please-enterunavailablephone",userDisplayFirstNameError:".please-enterfirstname",userDisplayLastNameError:".please-enterlastname",userDisplayCompanyError:".please-entercompany"},templateHelpers:function(){return this.options.settings},events:{"submit form":"submitEmailForm"},submitEmailForm:function(t){t.preventDefault();var e=this;if(!this.submitDelay){this.submitDelay=!0,setTimeout(function(){delete e.submitDelay},500);var i=this.options.settings.get("AskForFirstName"),n=this.options.settings.get("AskForLastName"),r=this.options.settings.get("AskForPhoneNumber"),s=this.options.settings.get("AskForCompany"),a=null,l=null;i&&(l=o.$.trim(this.ui.userDisplayFirstName.val()));var c=null;n&&(c=o.$.trim(this.ui.userDisplayLastName.val()));var u=null;s&&(u=o.$.trim(this.ui.userDisplayCompany.val()));var d=this.ui.email.val(),p=this.ui.question.val();if(this.ui.form.find('[class*="please"]').hide(),"string"==typeof l&&0==l.length)return this.ui.userDisplayFirstNameError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof c&&0==c.length)return this.ui.userDisplayLastNameError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof d&&0==d.length)return this.ui.emailError.show(),e.options.viewController.triggerResizedEvent(),!1;if("string"==typeof u&&0==u.length)return this.ui.userDisplayCompanyError.show(),e.options.viewController.triggerResizedEvent(),!1;var g=this.ui.phoneNumber.val();if(r){if(0==g.length)return this.ui.phoneNumberError.show(),e.options.viewController.triggerResizedEvent(),!1;this.ui.phoneNumberError.hide(),e.options.viewController.triggerResizedEvent(),this.ui.phoneNumber.val(g)}if(null===p||""==o.$.trim(p))return this.ui.questionError.show(),e.options.viewController.triggerResizedEvent(),!1;l=l||e.options.viewController.getPublicApi().get("visitor_firstName")||this.model.get("InitialVisitorFirstName")||"Visitor",c=c||e.options.viewController.getPublicApi().get("visitor_lastName")||this.model.get("InitialVisitorLastName"),u=u||e.options.viewController.getPublicApi().get("visitor_company")||this.model.get("InitialVisitorCompany"),d=d||e.options.viewController.getPublicApi().get("visitor_email")||this.model.get("InitialVisitorEmail"),p=p||e.options.viewController.getPublicApi().get("visitor_question")||this.model.get("InitialVisitorQuestion"),g=g||e.options.viewController.getPublicApi().get("visitor_phonenumber")||this.model.get("InitialVisitorPhoneNumber"),l?(a=l,c&&(a+=c)):c?a=c:(a="Visitor",l="Visitor"),this.model.set({Name:a,FirstName:l,LastName:c,Company:u,Email:d,Question:p,PhoneNumber:g}),this.model.trigger("formSubmit",{visitorName:h.default.escapeHtml(h.default.stripDangerousTags(a||""),!0),visitorFirstName:h.default.escapeHtml(h.default.stripDangerousTags(l||""),!0),visitorLastName:h.default.escapeHtml(h.default.stripDangerousTags(c||""),!0),visitorCompany:h.default.escapeHtml(h.default.stripDangerousTags(u||""),!0),visitorEmail:h.default.escapeHtml(h.default.stripDangerousTags(d||""),!0),visitorQuestion:h.default.escapeHtml(h.default.stripDangerousTags(p||""),!1),visitorPhoneNumber:h.default.escapeHtml(h.default.stripDangerousTags(g||""),!0)})}},onRender:function(){}}),X.ClosedMessage=c.default.ItemView.extend({getTemplate:function(){return this.options.settings.get("isOperator")?C.default:_.default},className:"purechat-closedmessage-container",ui:{ratingThanks:".purechat-rating-thanks",displayContainer:".purechat-message-display-container",ratingPrompt:'[data-resourcekey="closed_askForRating"]'},templateHelpers:function(){return this.options.settings},updateScroll:function(){var t=this;t.ui.displayContainer.scrollTop(t.ui.displayContainer[0].scrollHeight-t.ui.displayContainer.height())},events:{"click .purechat-thumbs-up":function(t){this.options.settings.get("isInEditorMode")||((0,o.$)(t.target).addClass("purechat-thumbs-selected"),this.rateChat(!0))},"click .purechat-thumbs-down":function(t){this.options.settings.get("isInEditorMode")||((0,o.$)(t.target).addClass("purechat-thumbs-selected"),this.rateChat(!1))},"click button.ban-ip-operator-button":function(t){var e=(0,o.$)(t.target);(0,o.$)('.operatorBanIPAddress[data-ipaddressid="'+e.attr("data-ipaddressid")+'"]').modal("show"),(0,o.$)("#BanIP-"+e.attr("data-ipaddressid")).off("click.BanIPAddressFromOperator").on("click.BanIPAddressFromOperator",function(){(0,o.$)(document).trigger("ConfirmBanIPAddressFromOperator",[(0,o.$)(this),e])})},"click .purechat-download-container a":function(){return!this.options.settings.get("isInEditorMode")}},rateChat:function(t){this.rating||(this.rating=t?1:0,this.trigger("chat:rated",this.rating)),this.$el.find(".purechat-thumbs-selectable:not(.purechat-thumbs-selected)").remove(),this.ui.ratingThanks.text(this.getResource("closed_ratingThanks")),this.ui.ratingThanks.attr("data-resourcekey","closed_ratingThanks"),this.ui.ratingPrompt.length>0&&this.ui.ratingPrompt.hide()},initialize:function(){this.model.set("isPersonalChat",this.options.settings.get("isPersonalChat"))},onClose:function(){this.options.settings.get("isPersonalChat")&&this.options.settings.get("isInEditorMode")&&window.pcPersonalEditor&&window.pcPersonalEditor.execute("editButton:hide",this.$el.find("[data-resourcekey]"))},onRender:function(){this.options.settings.get("isPersonalChat")&&(this.$el.find("a.purechat-cta-button").attr("href",/http/i.test(this.getResource("button_cta_url"))?this.getResource("button_cta_url"):"http://"+this.getResource("button_cta_url")),this.options.settings.get("isInEditorMode")&&window.pcPersonalEditor&&window.pcPersonalEditor.execute("editButton:show",this.$el.find("[data-resourcekey]")))}}),X.CoolSpinner=c.default.ItemView.extend({template:a.default.template(""),className:"purechat-cool-awesome-spinner spinner"}),X.ChatConnectingView=c.default.ItemView.extend({template:b.default,className:"purechat-enterinfo-container",ui:{spinner:".spinnerContainer",greeting:".greeting",connecting:".connecting"},onRender:function(){var t={length:20,radius:20,width:10,color:"#888"};if(this.options.settings.get("isPersonalChat")){var e=new X.CoolSpinner;e.render(),this.ui.spinner.css("height","auto").append(e.$el),this.ui.greeting.css("display","none"),this.ui.connecting.css("display","none")}else{var e=new purechatSpinner.Spinner(t).spin(),i=(0,o.$)(e.el);i.css({left:"50%",top:"50%"}),this.ui.spinner.append(i)}},showErrorMessage:function(t){this.ui.spinner.hide(),this.ui.greeting.hide(),this.ui.connecting.hide(),this.$el.append("<p>"+t+"</p>")}}),X.PersonalChatTooltip=c.default.ItemView.extend({template:a.default.template('<span class="arrow"></span>'),tagName:"span",className:"personal-tooltip",onRender:function(){this.$el.append(this.model.get("text"))}}),X.PersonalChatDetails=c.default.ItemView.extend({template:P.default,className:"purechat-personal-widget-content",events:{"mouseenter .purechat-social-buttons a[data-tooltiptext]":"displayFixedTooltip","mouseleave .purechat-social-buttons a[data-tooltiptext]":"hideFixedTooltip","click .start-chat":"showWidgetBody"},showWidgetBody:function(){var t=this;this.$el.parent().css({left:-(0,o.$)(window).width()}),setTimeout(function(){t.$el.parent().addClass("purechat-hide")},1001)},displayFixedTooltip:function(t){var e=(0,o.$)(t.currentTarget),i=new X.PersonalChatTooltip({model:new o.backbone.Model({text:e.data("tooltiptext")})});i.render(),i.$el.appendTo("body");var n=e.offset().top+e.outerHeight()-1,r=e.offset().left+e.width()/2-8;i.$el.css({display:"inline-block",top:n,left:r}),e.data("activetooltip",i)},hideFixedTooltip:function(t){var e=(0,o.$)(t.currentTarget),i=e.data("activetooltip");i&&(i.destroy(),e.data("activetooltip",null))},initialize:function(){if("undefined"!=typeof tempPersonalWidgetSettings){var t=this.model.get("UserWidgetSettings");for(var e in tempPersonalWidgetSettings.attributes)t.set(e,tempPersonalWidgetSettings.get(e)||t.get(e));this.model.set("UserWidgetSettings",t)}},onRender:function(){this.options.model.get("RequestFromMobileDevice")&&this.$el.find(".purechat-contact-details a").addClass("button")},onAfterInserted:function(){}}),X.UnsupportedBrowser=c.default.ItemView.extend({template:W.default,className:"purechat-unsupported-browser",onRender:function(){}}),e.default=X},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(53),s=n(o),a=new s.default.Application;r.backbone.Relational.showWarnings=!1,e.default=a},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="spinnerContainer" style="height: 200px;"></div>';return __p}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var ctaUrl=obj.getResource("button_cta_url"),httpRegex=new RegExp("(https|http)://");ctaUrl=0!=ctaUrl.search(httpRegex)?"http://"+ctaUrl:ctaUrl,__p+='\r\n\r\n<p class="purechat-message-note" data-resourcekey="closed_message">'+__e(obj.getResource("closed_message"))+"</p>\r\n",obj.AskForRating&&(__p+='\r\n<div class="purechat-thumbs-container">\r\n\t<p class="purechat-message-note" data-resourcekey="closed_askForRating">'+__e(obj.getResource("closed_askForRating"))+'</p>\r\n\t<div class="purechat-thumbs purechat-thumbs-up purechat-thumbs-selectable pc-icon-thumbs-up"></div>\r\n\t<div class="purechat-thumbs purechat-thumbs-down purechat-thumbs-selectable pc-icon-thumbs-down"></div>\r\n</div>\r\n<p class="purechat-rating-thanks purechat-message-note"></p>\r\n'),__p+="\r\n\r\n",obj.CtaButton&&(__p+='\r\n<form class="purechat-form purechat-ended-form" action="">\r\n\t<a href="'+(null==(__t=ctaUrl)?"":__t)+'" data-resourcekey="button_cta" class="purechat-btn purechat-cta-button '+(null==(__t=obj.isPersonalChat?"button green":"")?"":__t)+'" target="_blank">'+__e(obj.getResource("button_cta"))+"</a>\r\n</form>\r\n"),__p+="\r\n",obj.DownloadTranscript&&(__p+='\r\n<p class="purechat-download-container purechat-message-note">\r\n\t<a data-resourcekey="closed_downloadTrans" target="_blank" href="'+(null==(__t=obj.get("pureServerUrl"))?"":__t)+"/VisitorWidget/Transcript?chatId="+(null==(__t=(obj.get("dataController")||obj.get("oldDataController")).connectionInfo.get("chatId"))?"":__t)+"&authToken="+(null==(__t=(obj.get("dataController")||obj.get("oldDataController")).connectionInfo.get("authToken"))?"":__t)+'">'+__e(obj.getResource("closed_downloadTrans"))+"</a>\r\n</p>\r\n")}return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var isOperatorRoom=obj.get("room").roomType==PureChat.enums.roomType.operator;if(__p+='\r\n<script>\r\n\t!function(d, s, id) {\r\n\t\tvar js, fjs = d.getElementsByTagName(s)[0];\r\n\t\tif (!d.getElementById(id)) {\r\n\t\t\tjs = d.createElement(s);\r\n\t\t\tjs.id = id;\r\n\t\t\tjs.src = "https://platform.twitter.com/widgets.js";\r\n\t\t\tfjs.parentNode.insertBefore(js, fjs);\r\n\t\t}\r\n\t}(document, "script", "twitter-wjs");\r\n</script>\r\n<div class="purechat-message-display-container">\r\n\t<div class="purechat-message-display purechat-clearfix">\r\n\t</div>\r\n</div>\r\n<div class="purechat-user-status"></div>\r\n<div class="purechat-send-form-container">\r\n\t<form class="purechat-send-form" action="">\r\n\t\t<div class="operator-close-actions layout-item layout-item-align-middle">\r\n\t\t\t<div class="text-center">\r\n\t\t\t\t<p><em>\r\n\t\t\t\t\t',__p+=0==obj.closedReasonCode?"\r\n\t\t\t\t\tThis chat was closed by the visitor.\r\n\t\t\t\t\t":1==obj.closedReasonCode?"\r\n\t\t\t\t\tThis chat was closed because the visitor left the page or lost internet connectivity.\r\n\t\t\t\t\t":2==obj.closedReasonCode?"\r\n\t\t\t\t\tThis chat was closed because there was no activity for this conversation in the past hour.\r\n\t\t\t\t\t":3==obj.closedReasonCode?"\r\n\t\t\t\t\tThis chat was closed by an operator.\r\n\t\t\t\t\t":"\r\n\t\t\t\t\t"+__e(obj.getResource("closed_opMessage"))+"\r\n\t\t\t\t\t",__p+='\r\n\t\t\t\t</em></p>\r\n\t\t\t\t<p class="text-extra-small">\r\n\t\t\t\t\t<em>What would you like to do next?</em>\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t<div class="space-top text-center button-bar">\r\n\t\t\t\t',1!=obj.get("room").roomType){__p+="\r\n\t\t\t\t";var name=obj.visitorName&&"Visitor"!=obj.visitorName?"%20with%20"+obj.visitorName+"!":"!";__p+='\r\n\t\t\t\t<a href="https://twitter.com/intent/tweet?original_referer='+(null==(__t=escape(pcDashboard.Settings.get("siteRootUrl")))?"":__t)+"&text=Just%20had%20a%20great%20chat"+(null==(__t=name)?"":__t)+'&tw_p=tweetbutton&url=%20&via=PureChat" target="_blank">\r\n\t\t\t\t\t<i class="pcfont pcfont-twitter-no-border"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\tShare\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a href="#" data-command="exportTranscript" data-command-params="'+(null==(__t=obj.getExportParams())?"":__t)+'">\r\n\t\t\t\t\t<i class="pcfont pcfont-export"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\tExport\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a href="/Chat/Download/'+(null==(__t=obj.roomId)?"":__t)+'" data-chatid="'+(null==(__t=obj.roomId)?"":__t)+'" target="_blank">\r\n\t\t\t\t\t<i class="pcfont pcfont-download"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\tDownload\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<a href="#" data-chatid="'+(null==(__t=obj.roomId)?"":__t)+'" data-command="transcript:email" data-command-params="'+(null==(__t=obj.roomId)?"":__t)+'" class="email-transcript">\r\n\t\t\t\t\t<i class="pcfont pcfont-email"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\tEmail\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t';var banArgs={chatId:obj.roomId,visitorIPAddressId:obj.visitorIPAddressId,visitorIPAddress:obj.visitorIPAddress,performBan:!0},banArgString=window.escape(JSON.stringify(banArgs));__p+="\r\n\t\t\t\t",isOperatorRoom||obj.visitorIPAddressId>-1&&(__p+='\r\n\t\t\t\t<a href="#" data-chatid="'+(null==(__t=obj.roomId)?"":__t)+"\" data-request='ban:ip' data-request-params=\""+__e(banArgString)+'">\r\n\t\t\t\t\t<i class="pcfont pcfont-prohibitory"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\t\t\tBan IP\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t'),__p+="\r\n\t\t\t\t"}__p+='\r\n\t\t\t\t<a href="#" data-command="removeWidget">\r\n\t\t\t\t\t<i class="pcfont pcfont-close-chat"></i>\r\n\t\t\t\t\t<span class="tip">\r\n\t\t\t\t\t\tClose\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</a>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<textarea class="purechat-send-form-message" name="purechat-send-form-message" disabled="disabled"/>\r\n\t</form>\r\n</div>\r\n'}return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-enterinfo-container">\r\n\t<p data-resourcekey="noOperators_email_message">\r\n\t\t',__p+=obj.fromMissed?"\r\n\t\t"+(null==(__t=obj.Utils.linkify(_.escape(obj.getResource("emailForm_missed_response"))))?"":__t)+"\r\n\t\t":"\r\n\t\t"+(null==(__t=obj.Utils.linkify(_.escape(obj.getResource("emailForm_message"))))?"":__t)+"\r\n\t\t",__p+='\r\n\t</p>\r\n</div>\r\n<form class="purechat-form purechat-email-form" action="">\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error general-error" style="display: none;"></p>\r\n\t',obj.get("AskForFirstName")&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enterfirstname" style="display: none;">'+__e(obj.getResource("error_enterFirstName"))+'</p>\r\n\t<input type="text" class="purechat-firstname-input" autocomplete="off" name="purechat-firstname-input" id="purechat-firstname-input" maxlength="40" value="'+__e(obj.InitialVisitorFirstName)+'" placeholder="'+__e(obj.getResource("placeholder_firstName"))+'"/>\r\n\t'),__p+="\r\n\t",obj.get("AskForLastName")&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enterlastname" style="display: none;">'+__e(obj.getResource("error_enterLastName"))+'</p>\r\n\t<input type="text" class="purechat-lastname-input" autocomplete="off" name="purechat-lastname-input" id="purechat-lastname-input" maxlength="40" value="'+__e(obj.InitialVisitorLastName)+'" placeholder="'+__e(obj.getResource("placeholder_lastName"))+'"/>\r\n\t'),__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enteremail" style="display: none;">'+__e(obj.getResource("error_enterEmail"))+'</p>\r\n\t<input type="email" class="purechat-email-input" name="purechat-email-input" id="purechat-email-input" maxlength="100" value="'+__e(obj.InitialVisitorEmail)+'" placeholder="'+__e(obj.getResource("placeholder_email"))+'"/>\r\n\t',obj.get("AskForPhoneNumber")&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enterphonenumber" style="display: none;">'+__e(obj.getResource("error_enterPhoneNumber"))+'</p>\r\n\t<input type="text" class="purechat-phonenumber-input" name="purechat-phonenumber-input" id="purechat-phonenumber-input" maxlength="30" value="'+__e(obj.InitialVisitorPhoneNumber)+'" placeholder="'+__e(obj.getResource("placeholder_phonenumber"))+'"/>\r\n\t'),__p+="\r\n\t",obj.get("AskForPhone")&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enterunavailablephone" style="display: none;">'+__e(obj.getResource("error_enterPhoneNumber"))+'</p>\r\n\t<input type="text" class="purechat-unavailablephone-input" id="purechat-unavailablephone-input" name="purechat-unavailablephone-input" maxlength="30" value="'+__e(obj.InitialVisitorPhoneNumber)+'" placeholder="'+__e(obj.getResource("noOperators_placeholder_phone"))+'"/>\r\n\t'),__p+="\r\n\t",obj.get("AskForCompany")&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-entercompany" style="display: none;">'+__e(obj.getResource("error_enterCompany"))+'</p>\r\n\t<input type="text" class="purechat-company-input" name="purechat-company-input" id="purechat-company-input" maxlength="30" value="'+__e(obj.InitialVisitorCompany)+'" placeholder="'+__e(obj.getResource("placeholder_company"))+'"/>\r\n\t'),__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error please-enterquestion" style="display: none;">'+__e(obj.getResource("error_enterQuestion"))+'</p>\r\n\t<textarea class="purechat-question-input" name="purechat-question-input" id="purechat-question-input" rows="3" placeholder="'+__e(obj.getResource("placeholder_question"))+'">'+__e(obj.InitialVisitorQuestion)+'</textarea>\r\n\t<input type="submit" class="purechat-btn" id="purechat-name-submit" value="'+__e(obj.getResource("button_sendEmail"))+'" style="display: inline;"/>\r\n\t<span class="purechat-email-error">An Error Occurred</span>\r\n</form>\r\n';return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="purechat-enterinfo-container purechat-email-success">\r\n\t<p>Email Sent!</p>\r\n\t<table>\r\n\t\t<tr>\r\n\t\t\t<td>Name: </td>\r\n\t\t\t<td>'+__e(obj.Name)+"</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td>Email: </td>\r\n\t\t\t<td>"+__e(obj.Email)+"</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td>Question: </td>\r\n\t\t\t<td>"+__e(obj.Question)+"</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n";return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-message-display-container">\r\n\t<div class="purechat-message-display purechat-clearfix">\r\n\t\t<div class="purechat-showPrevious">\r\n\t\t\t<a href="#">See Previous Conversation</a>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="purechat-user-status"></div>\r\n<div class="purechat-send-form-container">\r\n\t<form class="purechat-send-form" action="">\r\n\t\t<textarea class="purechat-send-form-message" name="purechat-send-form-message" placeholder="'+__e(obj.getResource("chat_pressEnter"))+'"></textarea>\r\n\t\t<div class="disableTextArea" style=""/>\r\n\t\t',obj.isMobile()&&(__p+='\r\n\t\t<button type="submit" class="button green send-message">\r\n\t\t\tSend\r\n\t\t</button>\r\n\t\t'),__p+='\r\n\t</form>\r\n</div>\r\n<div class="purechat-confirm-close-modal" style="display: none;">\r\n\t<span class="message">Are you sure you want to close the chat?</span>\r\n\t<div class="modal-button-bar">\r\n\t\t<button type="button" class="purechat-btn kill-chat">Yes</button>\r\n\t\t<button type="button" class="purechat-btn cancel">No</button>\r\n\t</div>\r\n</div>\r\n<div class="purchat-confirm-close-modal-overlay" style="display: none;"></div>\r\n';return __p}}).call(exports,__webpack_require__(4))},function(module,exports){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)if("note"==obj.type)__p+='\r\n<p class="purechat-message-note purechat-important" data-username="'+(null==(__t=obj.username)?"":__t)+'" data-resourcekey="'+(null==(__t=obj.resourceKey||"")?"":__t)+'">\r\n\t'+(null==(__t=obj.message)?"":__t)+"\r\n</p>\r\n";else if("separator"==obj.type)__p+='\r\n<p class="purechat-message-note purechat-important separator" data-username="'+(null==(__t=obj.username)?"":__t)+'" data-resourcekey="'+(null==(__t=obj.resourceKey||"")?"":__t)+'">\r\n\t'+(null==(__t=obj.message)?"":__t)+"\r\n\t<hr/>\r\n</p>\r\n";else if("message"==obj.type&&obj.message){var message=obj.Utils.parseEmoticons(obj.message);message=obj.Utils.linkify(message),__p+='\r\n<div data-resourcekey="'+(null==(__t=obj.resourceKey||"")?"":__t)+'" class="purechat-message-container '+(null==(__t=obj.myMessage?"purechat-message-right":"purechat-message-left")?"":__t)+'">\r\n\t<img class="gravitar purechat-operator-gravatar '+(null==(__t=obj.myMessage?"right":"left")?"":__t)+'" height="50" width="50" src="'+(null==(__t=obj.avatarUrl)?"":__t)+'" alt="Operator avatar"/>\r\n\t<div class="purechat-timestamp">\r\n\t\t',
obj.time&&(__p+='\r\n\t\t<span class="purechat-time">'+(null==(__t=obj.time.replace(/(\d{1,2}:\d{1,2}):\d{1,2} ([AP]M)/gi,"$1 $2"))?"":__t)+"</span>\r\n\t\t"),__p+='\r\n\t</div>\r\n\t<div class="purechat-message">\r\n\t\t',obj.userName&&(__p+='\r\n\t\t<span class="purechat-displayname">'+(null==(__t=obj.userName)?"":__t)+'</span><span class="purechat-name-message-separator">:</span>\r\n\t\t'),__p+='\r\n\t\t<span class="purechat-message-actual">\r\n\t\t\t<span class="purechat-new-thought">\r\n\t\t\t\t'+(null==(__t=message)?"":__t)+'\r\n\t\t\t</span>\r\n\t\t</span> \r\n\t\t<span class="message-time-separator">-</span>\r\n\t</div>\r\n</div>\r\n'}return __p}},function(module,exports){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj){__p+='<div class="purechat-personal-avatar-and-details-wrapper">\r\n\t<div class="purechat-personal-avatar">\r\n\t\t<div class="editor-section purechat-hide"></div>\r\n\t\t<div class="content-section">\r\n\t\t\t';var personalAvUrl=obj.pureServerUrl+"/content/images/Avatars/operator-avatar.png";null!==obj.UserWidgetSettings.get("PersonalAvatarImage")&&/[a-zA-Z1-9]/g.test(obj.UserWidgetSettings.get("PersonalAvatarImage").FileId)&&(personalAvUrl=obj.pureServerUrl+"/files/download/"+obj.UserWidgetSettings.get("PersonalAvatarImage").FileId+"."+obj.UserWidgetSettings.get("PersonalAvatarImage").FileExtension),__p+='\r\n\t\t\t<div class="avatar-image" style="background-image: url(\''+(null==(__t=personalAvUrl)?"":__t)+"');\"></div>\r\n\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-personal-avatar">\r\n\t\t\t\tChange Personal Avatar\r\n\t\t\t\t<span class="image-dimensions tooltip">\r\n\t\t\t\t\t<span class="arrow"></span>\r\n\t\t\t\t\t<span class="body">\r\n\t\t\t\t\t\tImage will be resized to 200px x 200px after upload.\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t</a>\r\n\t\t\t'),__p+='\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="purechat-additional-details-container">\r\n\t\t<div class="purechat-person">\r\n\t\t\t<div class="purechat-name">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t'+(null==(__t=obj.UserWidgetSettings.get("DisplayName"))?"":__t)+'\r\n\t\t\t\t\t<div class="purechat-italic">\r\n\t\t\t\t\t\t'+(null==(__t=obj.UserWidgetSettings.get("Company"))?"":__t)+"\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-name">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+='\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="purechat-social-buttons">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t',obj.UserWidgetSettings.get("TwitterId")?__p+='\r\n\t\t\t\t\t<a href="https://twitter.com/'+(null==(__t=obj.UserWidgetSettings.get("TwitterId"))?"":__t)+'" target="_blank" class="purechat-twitter" data-tooltiptext="View '+(null==(__t=obj.UserWidgetSettings.get("DisplayName"))?"":__t)+'\'s Twitter profile">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-twitter-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t':obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a href="https://twitter.com" target="_blank" class="purechat-twitter faded" data-tooltiptext="Add your Twitter username to allow people to tweet you">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-twitter-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t",obj.UserWidgetSettings.get("FacebookId")?__p+='\r\n\t\t\t\t\t<a href="https://'+(null==(__t=obj.UserWidgetSettings.get("FacebookId"))?"":__t)+'" target="_blank" class="purechat-facebook" data-tooltiptext="View '+(null==(__t=obj.UserWidgetSettings.get("DisplayName"))?"":__t)+'\'s Facebook page">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-facebook-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t':obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a href="https://www.facebook.com/" target="_blank" class="purechat-facebook faded" data-tooltiptext="Add your Facebook Id to allow people to post on your wall">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-facebook-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t",obj.UserWidgetSettings.get("LinkedInId")?__p+='\r\n\t\t\t\t\t<a href="https://'+(null==(__t=obj.UserWidgetSettings.get("LinkedInId"))?"":__t)+'" target="_blank" class="purechat-linked-in" data-tooltiptext="View '+(null==(__t=obj.UserWidgetSettings.get("DisplayName"))?"":__t)+'\'s LinkedIn profile">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-linked-in-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t':obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a href="https://www.linkedin.com/" target="_blank" class="purechat-linked-in faded" data-tooltiptext="Add your public LinkedIn url to allow people to view your LinkedIn profile">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-linked-in-no-border"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t",obj.UserWidgetSettings.get("Email")?__p+='\r\n\t\t\t\t\t<a href="mailto:'+(null==(__t=obj.UserWidgetSettings.get("Email"))?"":__t)+'" target="_blank" class="purechat-send-email" data-tooltiptext="Send email to '+(null==(__t=obj.UserWidgetSettings.get("Email"))?"":__t)+'">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-email"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t':obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a href="#" target="_blank" class="purechat-linked-in faded" data-tooltiptext="Add an email address to give people another method of contacting you">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-email"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-social-buttons">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+='\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="purechat-contact-details">\r\n\t\t\t',(obj.isInEditorMode||obj.UserWidgetSettings.get("Website"))&&(__p+='\r\n\t\t\t<div class="purechat-website">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t<a href="'+(null==(__t=obj.UserWidgetSettings.get("Website")?obj.UserWidgetSettings.get("Website").search("http")!=-1?obj.UserWidgetSettings.get("Website"):"http://"+obj.UserWidgetSettings.get("Website"):"#")?"":__t)+'" target="_blank">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-website"></i>\r\n\t\t\t\t\t\t<span class="text">\r\n\t\t\t\t\t\t\t'+(null==(__t=obj.UserWidgetSettings.get("Website")||'<span class="faded">Enter a website</span>')?"":__t)+"\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-website">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t"),__p+="\r\n\t\t\t",(obj.isInEditorMode||obj.UserWidgetSettings.get("PhoneNumber"))&&(__p+='\r\n\t\t\t<div class="purechat-phone personal">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t<a title="Personal" href="tel:'+(null==(__t=obj.UserWidgetSettings.get("PhoneNumber"))?"":__t)+'" target="_blank">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-mobile"></i>\r\n\t\t\t\t\t\t<span class="text">\r\n\t\t\t\t\t\t\t'+(null==(__t=obj.UserWidgetSettings.get("PhoneNumber")||'<span class="faded">Enter a phone number</span>')?"":__t)+"\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-phone">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t"),__p+="\r\n\t\t\t",(obj.isInEditorMode||obj.UserWidgetSettings.get("Location"))&&(__p+='\r\n\t\t\t<div class="purechat-location">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t<!--<div class="purechat-personal-google-map-container" style="width: 100%; height: 200px;">\r\n\t\t\t\t\t</div>-->\r\n\t\t\t\t\t<a title="Work" href="https://maps.google.com?q='+(null==(__t=obj.UserWidgetSettings.get("Location"))?"":__t)+'&zoom=12" target="_blank">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-location"></i>\r\n\t\t\t\t\t\t<span class="text">\r\n\t\t\t\t\t\t\t'+(null==(__t=obj.UserWidgetSettings.get("Location")||'<span class="faded">Enter a location</span>')?"":__t)+"\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-location">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t"),__p+='\r\n\t\t</div>\r\n\t\t<div class="purechat-bio">\r\n\t\t\t',(obj.isInEditorMode||obj.UserWidgetSettings.get("Bio"))&&(__p+='\r\n\t\t\t<div class="purechat-bio-text">\r\n\t\t\t\t<div class="editor-section"></div>\r\n\t\t\t\t<div class="content-section">\r\n\t\t\t\t\t'+(null==(__t=(obj.UserWidgetSettings.get("Bio")||'<span class="faded">Add additional information</span>').replace(/\n/g,"<br/>"))?"":__t)+"\r\n\t\t\t\t\t",obj.isInEditorMode&&(__p+='\r\n\t\t\t\t\t<a class="purechat-edit-button" data-editorfor=".purechat-bio">\r\n\t\t\t\t\t\t<i class="pcfont pcfont-edit"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t"),__p+="\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n",obj.RequestFromMobileDevice&&(__p+='\r\n<div class="purechat-start-chat-button-container">\r\n\t<button type="button" class="button green start-chat">\r\n\t\tStart Chat\r\n\t</button>\r\n</div>\r\n'),__p+="\r\n"}return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="purechat-spinner"></div>';return __p}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)obj.EmailForm?__p+='\r\n<div class="purechat-enterinfo-container">\r\n\t<p data-resourcekey="emailForm_message">'+(null==(__t=obj.Utils.linkify(_.escape(obj.getResource("emailForm_message"))))?"":__t)+"</p>\r\n</div>\r\n":(__p+="\r\n",(obj.AskForPhoneNumber||obj.AskForFirstName||obj.AskForLastName||obj.AskForCompany||obj.AskForEmail||obj.AskForQuestion)&&(__p+='\r\n<div class="purechat-enterinfo-container">\r\n\t<p data-resourcekey="label_initial">'+(null==(__t=obj.Utils.linkify(obj.getResource("label_initial")))?"":__t)+"</p>\r\n</div>\r\n"),__p+="\r\n"),__p+='\r\n\r\n<form class="purechat-form '+(null==(__t=obj.EmailForm?"purechat-email-form":"purechat-init-form")?"":__t)+'" action="">\r\n\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline general-error" style="display: none;"></p>\r\n\t',obj.AskForFirstName&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enterfirstname" style="display: none;">'+__e(obj.getResource("error_enterFirstName"))+'</p>\r\n\t<input type="text" class="purechat-firstname-input" autocomplete="off" name="purechat-firstname-input" id="purechat-firstname-input" maxlength="40" value="'+__e(obj.InitialVisitorFirstName)+'" placeholder="'+__e(obj.getResource("placeholder_firstName"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.AskForLastName&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enterlastname" style="display: none;">'+__e(obj.getResource("error_enterLastName"))+'</p>\r\n\t<input type="text" class="purechat-lastname-input" autocomplete="off" name="purechat-lastname-input" id="purechat-lastname-input" maxlength="40" value="'+__e(obj.InitialVisitorLastName)+'" placeholder="'+__e(obj.getResource("placeholder_lastName"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.AskForEmail&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enteremail" style="display: none;">'+__e(obj.getResource("error_enterEmail"))+'</p>\r\n\t<input type="email" class="purechat-email-input" name="purechat-email-input" id="purechat-email-input" maxlength="100" value="'+__e(obj.InitialVisitorEmail)+'" placeholder="'+__e(obj.getResource("placeholder_email"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.AskForPhoneNumber&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enterphonenumber" style="display: none;">'+__e(obj.getResource("error_enterPhoneNumber"))+'</p>\r\n\t<input type="text" class="purechat-phonenumber-input" name="purechat-phonenumber-input" id="purechat-phonenumber-input" maxlength="30" value="'+__e(obj.InitialVisitorPhoneNumber)+'" placeholder="'+__e(obj.getResource("placeholder_phonenumber"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.EmailForm&&obj.UnavailableAskForPhone&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enterunavailablephone" style="display: none;">'+__e(obj.getResource("error_enterPhoneNumber"))+'</p>\r\n\t<input type="text" class="purechat-unavailablephone-input" id="purechat-unavailablephone-input" name="purechat-unavailablephone-input" maxlength="30" value="'+__e(obj.InitialVisitorPhoneNumber)+'" placeholder="'+__e(obj.getResource("noOperators_placeholder_phone"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.AskForCompany&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-entercompany" style="display: none;">'+__e(obj.getResource("error_enterCompany"))+'</p>\r\n\t<input type="text" class="purechat-company-input" name="purechat-company-input" id="purechat-company-input" maxlength="100" value="'+__e(obj.InitialVisitorCompany)+'" placeholder="'+__e(obj.getResource("placeholder_company"))+'" required/>\r\n\t'),__p+="\r\n\t",obj.AskForQuestion&&(__p+='\r\n\t<p class="purechat-alert purechat-alert-error purechat-init-error purechat-init-error-inline please-enterquestion" style="display: none;">'+__e(obj.getResource("error_enterQuestion"))+'</p>\r\n\t<textarea class="purechat-question-input" name="purechat-question-input" id="purechat-question-input" rows="3" placeholder="'+__e(obj.getResource("placeholder_question"))+'" required>'+__e(obj.InitialVisitorQuestion)+"</textarea>\r\n\t"),__p+="\r\n\r\n\t",__p+=obj.EmailForm?'\r\n\t<input type="submit" class="purechat-btn" id="purechat-name-submit" value="'+__e(obj.getResource("button_sendEmail"))+'" style="'+(null==(__t=obj.AskForFirstName||obj.AskForLastName||obj.AskForCompany||obj.AskForQuestion||obj.AskForEmail?"":"margin-top: 20px !important;")?"":__t)+'display: inline">\r\n\t<span class="purechat-email-error">An Error Occurred</span>\r\n\t':'\r\n\t<input type="submit" class="purechat-btn" id="purechat-name-submit" value="'+__e(obj.getResource("button_startChat"))+'" style="'+(null==(__t=obj.AskForFirstName||obj.AskForLastName||obj.AskForCompany||obj.AskForQuestion||obj.AskForEmail?"":"margin-top: 20px !important;")?"":__t)+'">\r\n\t',__p+="\r\n</form>";return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-widget-content '+(null==(__t=obj.isMobile()?"purechat-mobile fake-chat":"")?"":__t)+'" style="">\r\n\t<div class="purechat-message-list-view">\r\n\t\t<div class="purechat-message-display-container">\r\n\t\t\t<div class="purechat-message-display purechat-clearfix">\r\n\t\t\t\t<div class="purechat-message-wrapper purechat-clearfix">\r\n\t\t\t\t\t<div data-resourcekey="" class="purechat-message-container purechat-message-left">\r\n\t\t\t\t\t\t',(obj.isPersonalChat()||obj.isMobile())&&(__p+='\r\n\t\t\t\t\t\t<img class="gravitar purechat-operator-gravatar left" height="50" width="50" src="'+(null==(__t=obj.personalAvatarUrl())?"":__t)+'" alt="Operator avatar"/>\r\n\t\t\t\t\t\t'),__p+='\r\n\r\n\t\t\t\t\t\t<div class="purechat-timestamp">\r\n\t\t\t\t\t\t\t<span class="purechat-time">&nbsp;</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="purechat-message" style="margin-right: 0;">\r\n\t\t\t\t\t\t\t<span class="purechat-name-message-separator">:</span>\r\n\t\t\t\t\t\t\t<span class="purechat-message-actual">\r\n\t\t\t\t\t\t\t\t<span class="purechat-new-thought">'+__e(obj.getResource("chat_startedMessage"))+'</span>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span class="message-time-separator" style="display: none;">-</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="purechat-user-status"></div>\r\n\t\t<div class="purechat-send-form-container">\r\n\t\t\t<form class="purechat-send-form purechat-form" action="">\r\n\t\t\t\t<p class="purechat-alert purechat-alert-error purechat-init-error general-error" style="display: none;"></p>\r\n\t\t\t\t<textarea class="purechat-send-form-message purechat-question-input" name="purechat-question-input" id="purechat-question-input" ',obj.isMobile()||(__p+='placeholder="'+__e(obj.getResource("chat_pressEnter"))+'" '),__p+='rows="3">'+(null==(__t=obj.InitialVisitorQuestion)?"":__t)+"</textarea>\r\n\t\t\t\t",obj.isMobile()&&(__p+='\r\n\t\t\t\t<button type="submit" class="button green send-message">\r\n\t\t\t\t\tSend\r\n\t\t\t\t</button>\r\n\t\t\t\t'),__p+='\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div class="purechat-confirm-close-modal" style="display: none;">\r\n\t\t\t<span class="message">Are you sure you want to close the chat?</span><div class="modal-button-bar">\r\n\t\t\t\t<button type="button" class="purechat-btn kill-chat">Yes</button><button type="button" class="purechat-btn cancel">No</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n';return __p}}).call(exports,__webpack_require__(4))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<p class="purechat-message-note purechat-unitalic">\r\n\tSorry, but it appears that you are using a browser that is incompatible with Pure Chat\'s technology. <i class="emoticon emote-sad"></i>\r\n</p>\r\n<p class="purechat-message-note purechat-unitalic">\r\n\tIn order to use Pure Chat\'s live chat capabilities, please upgrade your browser to a newer version, or use one of these recommended alternative browsers:\r\n\t<ul>\r\n\t\t<li>\r\n\t\t\t<a href="https://www.google.com/chrome" target="_blank">\r\n\t\t\t\tGoogle Chrome\r\n\t\t\t</a>\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<a href="https://www.mozilla.org/firefox/new" target="_blank">\r\n\t\t\t\tMozilla Firefox\r\n\t\t\t</a>\r\n\t\t</li>\r\n\t</ul>\r\n</p>';return __p}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){var mobile=obj.get("RequestFromMobileDevice")&&obj.get("MobileDisplayType")===obj.MobileDisplayTypes.MobileOptimized&&!obj.isDesktopDimension(),mobileRequest=obj.get("RequestFromMobileDevice"),isPersonalChat=obj.get("isPersonalChat");__p+='\r\n<div class="purechat-expanded">\r\n\t<div class="purechat-collapsed-outer">\r\n\t\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t\t',obj.get("isPersonalChat")&&(__p+='\r\n\t\t\t<div class="purechat-personal-details-container '+(null==(__t=obj.get("isInEditorMode")?"personal-editor-active":"")?"":__t)+'"></div>\r\n\t\t\t'),__p+='\r\n\t\t\t<div class="'+(null==(__t=obj.get("isPersonalChat")?"purechat-personal-widget-content-wrapper":"purechat-widget-content-wrapper")?"":__t)+'">\r\n\t\t\t\t<div class="purechat-widget-header" data-trigger="collapse">\r\n\t\t\t\t\t',__p+=isPersonalChat?'\r\n\t\t\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t\t\t<button data-trigger="restartChat" class="purechat-btn purechat-btn-mini purechat-btn-restart" title="Start a new chat" style="display: none;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-repeat" title="Start a new chat"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="closeChat" class="purechat-btn purechat-btn-mini purechat-btn-close" title="Close chat session" style="display: none;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-remove"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t':'\r\n\t\t\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t\t\t<button data-trigger="restartChat" class="purechat-btn purechat-btn-mini purechat-btn-restart" title="Start a new chat" style="display: inline-block;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-repeat" title="Start a new chat"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="popOutChat" class="purechat-btn purechat-btn-mini purechat-btn-pop-out" title="Pop out" style="display: inline-block;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-share"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="expand" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-expand" title="Expand Widget" style="display: inline-block;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-plus"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="collapse" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-collapse" title="Collapse Widget" style="display: inline-block;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-minus"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="closeChat" class="purechat-btn purechat-btn-mini purechat-btn-close" title="Close chat session" style="display: inline-block;">\r\n\t\t\t\t\t\t\t<i class="pc-icon-remove"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t',__p+='\r\n\t\t\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t\t\t',isPersonalChat&&mobile&&(__p+='\r\n\t\t\t\t\t\t<a class="purechat-show-personal-details" href="#">\r\n\t\t\t\t\t\t\t<i class="fa fa-chevron-left"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t'),__p+='\r\n\t\t\t\t\t\t&nbsp;<span class="purechat-widget-room-avatar" style="display: none;"></span><span class="purechat-widget-title-link"></span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="purechat-content-wrapper purechat-clearfix">\r\n\t\t\t\t\t<div class="purechat-content"></div>\r\n\t\t\t\t\t',obj.get("RemoveBranding")?(__p+="\r\n\t\t\t\t\t",obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t\t\t<a href="#" class="purechat-toggle-audio-notifications">\r\n\t\t\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t"):(__p+="\r\n\t\t\t\t\t",isPersonalChat?(__p+='\r\n\t\t\t\t\t<div class="purechat-poweredby-container">\r\n\t\t\t\t\t\t<div class="purechat-poweredby">\r\n\t\t\t\t\t\t\t<span>'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'">Pure Chat</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t',obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left">\r\n\t\t\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t"):(__p+="\r\n\t\t\t\t\t",mobile?(__p+='\r\n\t\t\t\t\t<div style="top: 100%; margin-top: -5em; display: block; width: 100% !important; font-size: .75em !important; margin-bottom: 10px !important; position: absolute !important; bottom: 0 !important; left: 10px !important;">\r\n\t\t\t\t\t\t<span style="font-size: 1em !important;">'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'" style="font-size: 1em !important; padding-right: 10px !important; margin-right: 0px;">Pure Chat</a>\r\n\t\t\t\t\t\t',obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left">\r\n\t\t\t\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t"):(__p+='\r\n\t\t\t\t\t<div style="display: block; font-size: .75em !important; margin-bottom: 10px !important; padding-right: 10px !important;">\r\n\t\t\t\t\t\t<span style="font-size: 1em !important;">'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'" style="font-size: 1em !important; text-decoration: underline !important;">Pure Chat</a>\r\n\t\t\t\t\t\t',obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left">\r\n\t\t\t\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t"),__p+="\r\n\t\t\t\t\t"),__p+="\r\n\t\t\t\t\t"),__p+='\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="',mobile||(__p+="purechat-button-expand"),__p+=" purechat-collapsed "+(null==(__t=obj.get("CollapsedWidgetImageUrl")?"purechat-collapsed-image":"purechat-collapsed-default")?"":__t)+'">\r\n\t<div class="purechat-collapsed-outer" ',mobile||(__p+='data-trigger="expand"'),__p+=' style="display: none;">\r\n\t\t',mobile?__p+='\r\n\t\t<div class="purechat-widget-preview">\r\n\t\t\t<div class="purechat-preview-text purechat-clickable" data-trigger="expand">\r\n\t\t\t\t'+__e(obj.getResource("mobile_expandButton"))+'\r\n\t\t\t</div>\r\n\t\t\t<span class="purechat-missed-message-count" style="display:none"></span>\r\n\t\t\t<button data-trigger="expand" class="purechat-preview-icon purechat-clickable" title="Expand Widget" style="display: inline-block;">\r\n\t\t\t\t<svg width="65px" height="65px" viewBox="0 0 148 130" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\r\n\t\t\t\t\t<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r\n\t\t\t\t\t<g transform="translate(-590.000000, -1174.000000)">\r\n\t\t\t\t\t\t<g transform="translate(590.000000, 1174.000000)">\r\n\t\t\t\t\t\t<path d="M35.4846338,127.705905 L0.757683117,67.3469436 C-0.0319064935,65.9744214 -0.0319064935,64.2836499 0.757683117,62.9111276 L35.4846338,2.55216617 C36.2742234,1.17964392 37.7334649,0.334065282 39.3130286,0.334065282 L108.767314,0.334065282 C110.346494,0.334065282 111.806119,1.17964392 112.595709,2.55216617 L147.32266,62.9111276 C148.112249,64.2836499 148.112249,65.9744214 147.32266,67.3469436 L112.595709,127.705905 C111.806119,129.078427 110.346878,129.924006 108.767314,129.924006 L39.3130286,129.924006 C37.7338494,129.92362 36.2742234,129.078427 35.4846338,127.705905 L35.4846338,127.705905 Z" id="purechat-svg-hexagon" fill="#3B404C"></path>\r\n\t\t\t\t\t\t<path d="M106.988239,52.8583086 C101.04479,34.029911 81.0159688,23.601365 62.2530286,29.5659347 C43.4900883,35.5305045 33.0977974,55.6288131 39.0416312,74.4572107 C44.9093506,93.0448961 64.5037818,103.444125 83.0564468,97.9686944 C89.0098909,102.188487 93.4433558,101.322849 94.9033662,101.158516 C95.712561,101.067478 96.3802909,100.614599 95.8982338,99.8006528 C95.450774,99.0453412 94.6081351,98.6021068 93.9507844,98.0022552 C93.1096831,97.2349852 92.7218078,96.3049258 92.390826,95.2251929 C91.8841662,93.5737685 92.8967169,93.381276 94.0468883,92.5380119 C95.050213,91.8023739 96.0150961,91.0135015 96.9357714,90.1764095 C98.7579013,88.5191988 100.407429,86.6718101 101.850909,84.6739763 C104.725184,80.6964392 106.773351,76.1290801 107.828187,71.3306528 C109.170182,65.2260534 108.8688,58.8159347 106.988239,52.8583086 L106.988239,52.8583086 Z" id="purechat-svg-chat-bubble" fill="#FFFFFF"></path>\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t</g>\r\n\t\t\t\t\t</g>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t':(__p+='\r\n\t\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t\t<div class="purechat-widget-header">\r\n\t\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t\t',!obj.get("isDirectAccess")&&obj.get("ShowMinimizeWidgetButton")&&(__p+='\r\n\t\t\t\t\t<button type="button" data-trigger="superMinimize" class="purechat-btn purechat-btn-mini purechat-actions purechat-super-minimize-link-button" style="display: none;">\r\n\t\t\t\t\t\t<i class="pc-icon-caret-down"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t'),__p+='\r\n\t\t\t\t\t<button data-trigger="expand" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-expand" title="Expand Widget" style="display: inline-block;">\r\n\t\t\t\t\t\t<i class="pc-icon-plus"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button data-trigger="collapse" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-collapse" title="Collapse Widget" style="display: inline-block;">\r\n\t\t\t\t\t\t<i class="pc-icon-minus"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t\t',isPersonalChat&&(__p+='\r\n\t\t\t\t\t<a class="purechat-show-personal-details" href="#">\r\n\t\t\t\t\t\t<i class="fa fa-chevron-left"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+='\r\n\t\t\t\t\t&nbsp;<span class="purechat-widget-room-avatar" style="display: none;"></span><span class="purechat-widget-title-link">'+__e(obj.getResource("title_initial"))+"</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t"),__p+='\r\n\t</div>\r\n</div>\r\n<div class="purechat-mobile-overlay purechat-hide"></div>\r\n'}return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-expanded">\r\n\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t<div class="purechat-widget-header">\r\n\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t<button data-trigger="restartChat" class="purechat-btn purechat-btn-mini purechat-btn-restart" title="Start a new chat">\r\n\t\t\t\t\t<i class="pc-icon-repeat" title="Start a new chat"></i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button data-trigger="closeChat" class="purechat-btn purechat-btn-mini purechat-btn-close" title="Close chat session">\r\n\t\t\t\t\t<i class="pc-icon-remove"></i>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t<span class="purechat-widget-room-avatar" style="display: none;"></span><span class="purechat-widget-title-link"></span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class="purechat-content-wrapper purechat-clearfix">\r\n\t\t\t<div class="purechat-content"></div>\r\n\t\t\t',obj.get("RemoveBranding")||(__p+='\r\n\t\t\t<div class="purechat-poweredby-container">\r\n\t\t\t\t<span class="purechat-poweredby">'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'">Pure Chat</a>\r\n\t\t\t</div>\r\n\t\t\t'),__p+="\r\n\t\t\t",obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left '+(null==(__t=obj.get("RemoveBranding")?"purechat-kill-positioning":"")?"":__t)+'">\r\n\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t</a>\r\n\t\t\t'),__p+="\r\n\t\t</div>\r\n\t</div>\r\n</div>";return __p}}).call(exports,__webpack_require__(4))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-expanded">\r\n\t<div class="purechat-collapsed-outer">\r\n\t\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t\t<div class="purechat-widget-content-wrapper">\r\n\t\t\t\t<div class="purechat-widget-header">\r\n\t\t\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t\t\t<button data-trigger="restartChat" class="purechat-btn purechat-btn-mini purechat-btn-restart" title="Start a new chat">\r\n\t\t\t\t\t\t\t<i class="pc-icon-repeat" title="Start a new chat"></i>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button data-trigger="closeChat" class="purechat-btn purechat-btn-mini purechat-btn-close" title="Close chat session">\r\n\t\t\t\t\t\t\t<i class="pc-icon-remove"></i>\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t\t\t<span class="purechat-widget-room-avatar" style="display: none;"></span><span class="purechat-widget-title-link"></span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="purechat-content-wrapper">\r\n\t\t\t\t\t<div class="purechat-content"></div>\r\n\t\t\t\t\t',
obj.get("RemoveBranding")||(__p+='\r\n\t\t\t\t\t<div class="purechat-poweredby-container">\r\n\t\t\t\t\t\t<span class="purechat-poweredby">'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'">PureChat</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t\t",obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left">\r\n\t\t\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t'),__p+="\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>";return __p}}).call(exports,__webpack_require__(4))},function(module,exports){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="purechat-widget-inner purechat-clearfix">\r\n\t<div class="purechat-widget-header">\r\n\t\t<div class="menu purechat-btn-toolbar">\r\n\t\t\t<span data-trigger="cannedResponses" class="purechat-canned-responses purechat-btn-group"><a class="dropdown-toggle purechat-btn" data-toggle="dropdown" data-ajax="false">&nbsp;<i class="icon-ellipsis-horizontal icon-white"></i>&nbsp;</a><ul class="dropdown-menu bottom-up"></ul></span>\r\n\t\t\t',__p+=obj.attributes.isInvisible?'\r\n\t\t\t<button data-trigger="requeueChat" class="purechat-btn purechat-btn-mini requeue-button">\r\n\t\t\t\t<i class="fa fa-reply"></i><span class="text">Leave</span></button>\r\n\t\t\t<button data-trigger="removeWidget" class="purechat-btn purechat-btn-mini closewidget-button">\r\n\t\t\t\t<span class="text">Done</span></button>\r\n\t\t\t':'\r\n\t\t\t<button data-trigger="exportToOntime" class="purechat-btn purechat-btn-mini leave-button">\r\n\t\t\t\t<span class="text">Export</span></button>\r\n\t\t\t<button data-trigger="requeueChat" class="purechat-btn purechat-btn-mini requeue-button">\r\n\t\t\t\t<i class="fa fa-reply"></i><span class="text">Requeue</span></button>\r\n\t\t\t<button data-trigger="removeWidget" class="purechat-btn purechat-btn-mini closewidget-button">\r\n\t\t\t\t<span class="text">Done</span></button>\r\n\t\t\t<button data-trigger="closeChat" data-trigger-params=\'{"confirmation": "Are you sure you want to close this chat?"}\' class="purechat-btn purechat-btn-mini requeue close-button">\r\n\t\t\t\t<span class="text">End Chat</span></button>\r\n\t\t\t',__p+='\r\n\t\t</div>\r\n\t\t<div class="purechat-widget-title">\r\n\t\t\t<a class="purechat-widget-title-link"></a>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="purechat-chat-info"></div>\r\n\t<div class="purechat-content"></div>\r\n\t<div class="purechat-poweredby-container">\r\n\t</div>\r\n</div>';return __p}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="purechat-window purechat-expanded">\r\n\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t<div class="purechat-widget-header">\r\n\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t<button data-trigger="restartChat" class="purechat-btn purechat-btn-mini purechat-btn-restart" title="Start a new chat">\r\n\t\t\t\t\t<i class="pc-icon-repeat" title="Start a new chat"></i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button data-trigger="closeChat" class="purechat-btn purechat-btn-mini purechat-btn-close" title="Close chat session">\r\n\t\t\t\t\t<i class="pc-icon-remove"></i>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t',__p+=obj.get("RequestFromMobileDevice")&&obj.get("AllowWidgetOnMobile")?'\r\n\t\t\t\t<span class="purechat-widget-title-link">PureChat</span>\r\n\t\t\t\t':'\r\n\t\t\t\t<span class="purechat-widget-title-link">PureChat</span>\r\n\t\t\t\t&nbsp;<span class="purechat-widget-room-avatar" style="display: none;"></span>\r\n\t\t\t\t',__p+='\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class="purechat-content-wrapper">\r\n\t\t\t<div class="purechat-content"></div>\r\n\t\t\t',obj.get("RemoveBranding")||(__p+='\r\n\t\t\t<div class="purechat-poweredby-container">\r\n\t\t\t\t<span class="purechat-poweredby">'+__e(obj.getResource("poweredby"))+' </span>\r\n\t\t\t\t<a target="_blank" href="'+(null==(__t=obj.poweredByUrl())?"":__t)+'">Pure Chat</a>\r\n\t\t\t</div>\r\n\t\t\t'),__p+="\r\n\t\t\t",obj.showPlaySoundCheckbox()&&(__p+='\r\n\t\t\t<a href="#" class="purechat-toggle-audio-notifications purechat-bottom-left">\r\n\t\t\t\t<i class="fa '+(null==(__t=obj.playSoundOnNewMessage()?"pc-icon-unmute":"pc-icon-mute")?"":__t)+'"></i>\r\n\t\t\t</a>\r\n\t\t\t'),__p+='\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class="purechat-widget purechat-collapsed">\r\n\t',__p+=obj.get("CollapsedWidgetImageUrl")?'\r\n\t<img src="'+(null==(__t=obj.get("CollapsedWidgetImageUrl"))?"":__t)+'" data-trigger="expand"/>\r\n\t':'\r\n\t<div class="purechat-widget-inner purechat-clearfix">\r\n\t\t<div class="purechat-widget-header">\r\n\t\t\t<div class="purechat-menu purechat-btn-toolbar">\r\n\t\t\t\t<button data-trigger="expand" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-expand" title="Expand Widget">\r\n\t\t\t\t\t<i class="pc-icon-plus"></i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button data-trigger="collapse" class="purechat-btn purechat-btn-mini purechat-actions purechat-btn-collapse" title="Collapse Widget">\r\n\t\t\t\t\t<i class="pc-icon-minus"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="purechat-widget-title">\r\n\t\t\t\t<span class="purechat-widget-title-link">PureChat</span>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t',__p+="\r\n</div>";return __p}}).call(exports,__webpack_require__(4))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=(n(o),i(53)),a=n(s),l=i(84),c=n(l),u=a.default.Controller.extend({_publicApi:null,changeableRoomDetails:["visitorName","visitorFirstName","visitorLastName","visitorEmail","visitorReferer","visitorPhoneNumber","additionalDetails"],getPublicApi:function(){return this._publicApi},getBaseApiEventObject:function(){return{chatboxId:this.options.get("Id")}},extendBaseApiEventObject:function(t){return r.$.extend(this.getBaseApiEventObject(),t||{})},bindWidgetLayoutPublicApiEvents:function(){var t=this;t.widgetLayout.on("widget:resized",function(e){t.getPublicApi().trigger("resized",{widgetId:t.getChatModel().id}),t.getPublicApi().trigger("chatbox:resize",t.extendBaseApiEventObject({width:e.width,height:e.height}))}),t.widgetLayout.on("expanded",function(){t.getPublicApi().trigger("chatbox:expand",t.extendBaseApiEventObject())}),t.widgetLayout.on("collapsed",function(){t.getPublicApi().trigger("chatbox:collapse",t.extendBaseApiEventObject())}),t.widgetLayout.on("minimized",function(){t.getPublicApi().trigger("chatbox:minimize",t.extendBaseApiEventObject())})},bindOptionsPublicApiEvents:function(){var t=this;t.options.on("change:Position",function(){t.widgetLayout.repositionWidget()})},bindChatModelPublicApiEvents:function(){var t=this;t.getChatModel().on("widget:available widget:unavailable",function(){t.getPublicApi().trigger("chatbox.available:change",t.extendBaseApiEventObject({available:t.getChatModel().get("operatorsAvailable")}))}),t.getChatModel().on("operator:join",function(e){t.getPublicApi().trigger("chat:operatorJoin",t.extendBaseApiEventObject({operatorName:e.get("userDisplayName")}))}),t.getChatModel().on("operator:leave",function(e){t.getPublicApi().trigger("chat:operatorLeave",t.extendBaseApiEventObject({operatorName:e.get("userDisplayName")}))}),t.getChatModel().on("change:visitorName",function(t,e){}),t.getChatModel().on("change:visitorFirstName",function(e,i){t.getPublicApi().trigger("visitor.firstName:change",t.extendBaseApiEventObject({firstName:i})),t.getPublicApi().trigger("visitor.name:change",t.extendBaseApiEventObject({name:e.getFullName()}))}),t.getChatModel().on("change:visitorLastName",function(e,i){t.getPublicApi().trigger("visitor.lastName:change",t.extendBaseApiEventObject({lastName:i})),t.getPublicApi().trigger("visitor.name:change",t.extendBaseApiEventObject({name:e.getFullName()}))}),t.getChatModel().on("change:visitorCompany",function(e,i){t.getPublicApi().trigger("visitor.company:change",t.extendBaseApiEventObject({company:i}))}),t.getChatModel().on("change:visitorEmail",function(e,i){t.getPublicApi().trigger("visitor.email:change",t.extendBaseApiEventObject({email:i}))}),t.getChatModel().on("change:visitorPhoneNumber",function(e,i){t.getPublicApi().trigger("visitor.phoneNumber:change",t.extendBaseApiEventObject({phoneNumber:i}))}),t.getChatModel().on("change:visitorQuestion",function(e,i){t.getPublicApi().trigger("visitor.question:change",t.extendBaseApiEventObject({question:i}))}),t.getChatModel().on("chat:restart",function(){t.getPublicApi().trigger("chatbox:restart",t.extendBaseApiEventObject())})},bindViewControllerPublicApiEvents:function(){var t=this;this.on("chat:start",function(e){t.getPublicApi().trigger("chat:start",t.extendBaseApiEventObject(t.getPublicApi().reverseMapVisitorDetails(e)))}),this.on("chat:end",function(e){t.getPublicApi().trigger("chat:end",t.extendBaseApiEventObject(t.getPublicApi().reverseMapVisitorDetails(e)))}),this.on("chat:rate",function(e){t.getPublicApi().trigger("chat:rate",t.extendBaseApiEventObject(e))}),this.on("widget:poppedOut",function(){t.getPublicApi().trigger("chatbox:poppedOut",t.extendBaseApiEventObject())}),this.on("email:send",function(e){t.getPublicApi().trigger("email:send",t.extendBaseApiEventObject(t.getPublicApi().reverseMapVisitorDetails(e)))})},registerPublicApiEvents:function(){var t=this;this._publicApi||(this._publicApi=new c.default.ApiModel,this._publicApi.setViewController(this)),t.on("state:changed",function(e){var i={widgetId:t.getChatModel().id,state:e.newState.name};e.oldState&&(i.previousState=e.oldState.name),t.getPublicApi().trigger("widget:state-changed",t.extendBaseApiEventObject(i)),t.getPublicApi().trigger("chatbox:state-changed",t.extendBaseApiEventObject(i))}),this.on("widget:ready",function(){t.bindWidgetLayoutPublicApiEvents(),t.bindOptionsPublicApiEvents(),t.bindChatModelPublicApiEvents();try{t.getPublicApi().trigger("ready",t.extendBaseApiEventObject())}catch(t){console.error(t)}try{t.getPublicApi().trigger("chatbox:ready",t.extendBaseApiEventObject())}catch(t){console.error(t)}}),this.bindViewControllerPublicApiEvents()},apiRoomDetailsChanged:function(t,e,i){this.getDataController().chatServerConnection&&this.getDataController().chatServerConnection.setVisitorDetails(this.getDataController().connectionInfo.get("chatId"),t.pick(this.changeableRoomDetails))},triggerRoomChangedForApi:function(){this.getPublicApi().trigger("chat:change",this.extendBaseApiEventObject(this.getPublicApi().reverseMapVisitorDetails(this.getChatModel().pick(this.changeableRoomDetails))))}});e.default=u},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(2),l=i(4),c=n(l),u=i(53),h=(n(u),{});h.ApiModel=a.backbone.Model.extend((o={viewController:null,widgetSettings:function(){return this.viewController?this.viewController.options:null},chatModel:function(){return this.viewController?this.viewController.getChatModel():null},dataController:function(){return this.viewController?this.viewController.getDataController():null},setWidgetSetting:function(t,e){this.widgetSettings().set(t,e)},setChatModel:function(t,e){this.chatModel().set(t,e)},getWidgetSetting:function(t,e){this.widgetSettings().get(t)},getChatModel:function(t){this.chatModel().get(t)},regexs:{propAccess:{chatBox:/^chatbox\./i,strings:/^string\./i,visitor:/^visitor\./i},events:{chatBox:/^chatbox:/i,chatBoxPropChange:/^chatbox\.\w(\w|\d)*:/i,chat:/^chat:/i,email:/^email:/i,visitor:/^visitor\.\w(\w|\d)*/i}},mappings:{chatBox:{keys:{available:"available",position:"Position",layoutType:"CollapsedStyle",unavailableBehavior:"UnavailableBehavior",askForRating:"AskForRating",askForFirstName:"AskForFirstName",askForLastName:"AskForLastName",askForEmail:"AskForEmail",askForCompany:"AskForCompany",askForQuestion:"AskForQuestion",askForPhoneNumber:"AskForPhoneNumber",unavailableAskForPhone:"UnavailableAskForPhone",enableTranscriptDownload:"DownloadTranscript",forcePopout:"ForcePopout",enableGoogleAnalytics:"UsingGa",loadingAnimation:"DisplayWidgetAnimation",availableImageXOffset:"AvailableImageXOffset",availableImageYOffset:"AvailableImageYOffset",availableImageScale:"AvailableImageScale",availableImageOnTop:"AvailableImageTop",availableCollapsedImageUrl:"AvailableCollapsedWidgetImageUrl",availableImageHeight:"AvailableImageHeight",availableImageWidth:"AvailableImageWidth",useAvailableImageForBoth:"UseAvailableImageForBoth",unavailableImageXOffset:"UnavailableImageXOffset",unavailableImageYOffset:"UnavailableImageYOffset",unavailableImageScale:"UnavailableImageScale",unavailableImageOnTop:"UnavailableImageTop",unavailableCollapsedImageUrl:"UnavailableCollapsedWidgetImageUrl",unavailableImageHeight:"UnavailableImageHeight",unavailableImageWidth:"UnavailableImageWidth",showMinimizeButton:"ShowMinimizeWidgetButton",expanded:{propertyName:"expanded",setter:function(t,e,i){i=i||{},e?this.viewController.widgetLayout.expand(!1,!1,{expandSource:i.expandSource}):this.viewController.widgetLayout.onCollapse(!1)}},initialState:"initialState",currentState:"state",enableAvailabilityPolling:"enableAvailabilityPolling"},values:{position:{bottomLeft:1,bottomRight:2,topLeft:3,topRight:4},layoutType:{tab:1,button:2,image:3,tabWithImage:4},unavailableBehavior:{hide:0,message:1,email:2},loadingAnimation:{none:"none",flipInX:"flipInX",flipInY:"flipInY",fadeIn:"fadeIn",fadeInUp:"fadeInUp",fadeInDown:"fadeInDown",fadeInLeft:"fadeInLeft",fadeInRight:"fadeInRight",fadeInUpBig:"fadeInUpBig",fadeInDownBig:"fadeInDownBig",fadeInLeftBig:"fadeInLeftBig",fadeInRightBig:"fadeInRightBig",slideInUp:"slideInUp",slideInDown:"slideInDown",slideInLeft:"slideInLeft",slideInRight:"slideInRight",bounceIn:"bounceIn",bounceInUp:"bounceInUp",bounceInDown:"bounceInDown",bounceInLeft:"bounceInLeft",bounceInRight:"bounceInRight",rotateIn:"rotateIn",rotateInDownLeft:"rotateInDownLeft",rotateInDownRight:"rotateInDownRight",rotateInUpLeft:"rotateInUpLeft",rotateInUpRight:"rotateInUpRight"}}},visitor:{keys:{firstName:"visitorFirstName",lastName:"visitorLastName",email:"visitorEmail",avatarUrl:"visitorAvatarUrl",phoneNumber:"visitorPhoneNumber",question:"visitorQuestion",company:"visitorCompany",name:function(t){var e,i,n=t.value.indexOf(" ");n>0?(e=t.value.substring(0,n),i=t.value.substring(n+1)):e=t.value,this.chatModel().set("visitorFirstName",e),this.chatModel().set("visitorLastName",i)}},values:{}}},reverseMapVisitorDetails:function(t){var e={};for(var i in this.mappings.visitor.keys)e[i]=t[this.mappings.visitor.keys[i]];return e},getMappedWidgetValue:function(t,e){if("string"==typeof e&&this.mappings.chatBox.values[t])for(var i in this.mappings.chatBox.values[t])if(i.toLowerCase()==e.toLowerCase())return this.mappings.chatBox.values[t][i];return e},canSetChatBoxProp:function(t){switch(t){case"available":return!1;default:return!0}},set:function(t,e){if(a.backbone.Model.prototype.set.apply(this,arguments),"object"===("undefined"==typeof t?"undefined":s(t)))for(var i in t)this.set(i,t[i]);else{var n;if(this.regexs.propAccess.chatBox.test(t)){n=t.split(this.regexs.propAccess.chatBox),n=n.length>1?n[1]:null;var r=this.mappings.chatBox.keys;if(n&&r[n]){var o=this.setWidgetSetting,l=r[n];c.default.isObject(l)&&(o=l.setter||o,l=l.propertyName),e=this.getMappedWidgetValue(n,e),o.call(this,r[n],e),this.widgetSettings().trigger("api:change",this.widgetSettings,r[n],e)}}else if(this.regexs.propAccess.visitor.test(t)){n=t.split(this.regexs.propAccess.visitor),n=n.length>1?n[1]:null;var u=this.mappings.visitor.keys[n];if(n&&this.mappings.visitor.keys[n]){var h=this.chatModel().get("roomId")||this.viewController.getDataController().checkInRoom();(this.mappings.visitor.keys.question==u&&!h||this.mappings.visitor.keys.question!=u)&&("function"==typeof u?u.call(this,{value:e}):(this.chatModel().set(u,e,{silent:!1}),this.chatModel().trigger("api:change",this.chatModel(),this.mappings.visitor.keys[n],e)))}}}},getRequestedPropName:function(t,e){var i=t.split(e);return i.length>1?i[1]:null},get:function(t){var e=null;if(this.regexs.propAccess.chatBox.test(t)){if(e=this.getRequestedPropName(t,this.regexs.propAccess.chatBox),e&&this.mappings.chatBox.keys[e])switch(e){case"available":return this.chatModel()?this.chatModel().get("operatorsAvailable"):null;default:return this.widgetSettings()?this.widgetSettings().get(this.mappings.chatBox.keys[e]):null}}else if(this.regexs.propAccess.visitor.test(t)&&(e=this.getRequestedPropName(t,this.regexs.propAccess.visitor),e&&this.mappings.visitor.keys[e]&&this.chatModel))return this.chatModel().get(this.mappings.visitor.keys[e]);return null},on:function(t){var e=this.regexs.events.chat.test(t)||this.regexs.events.chatBox.test(t)||this.regexs.events.email.test(t)||this.regexs.events.visitor.test(t)||this.regexs.events.chatBoxPropChange.test(t);if(e)return void a.backbone.Model.prototype.on.apply(this,arguments);throw new Error('"'+t+'" is not a valid purechatApi event')},off:function(t){(this.regexs.events.chat.test(t)||this.regexs.events.chatBox.test(t))&&a.backbone.Model.prototype.off.apply(this,arguments)},clearViewController:function(){this.viewController=null},setViewController:function(t){this.viewController=t},clearWidgetSettings:function(){this.widgetSettings=null},setWidgetSettings:function(t){this.widgetSettings=t},clearChatModel:function(){this.chatModel=null}},r(o,"setChatModel",function(t){this.chatModel=t}),r(o,"unbindEvents",function(){for(var t in this.events)a.backbone.Model.prototype.off.apply(this,t,this.events[t])}),r(o,"bindEvents",function(){for(var t in this.events)a.backbone.Model.prototype.on.apply(this,t,this.events[t])}),r(o,"initialize",function(){this.bindEvents()}),r(o,"onDestroy",function(){this.unbindEvents(),a.backbone.Model.prototype.off.apply(this)}),o)),e.default=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(86),o=n(r),s=o.default.BaseControllerSettings.extend({expandSource:"time-trigger",enabledWidgetSettingKey:"ExpandWidgetTimeoutEnabled",initialize:function(t){o.default.BaseControllerSettings.prototype.initialize.apply(this,arguments)},onStart:function(){var t=this,e=this.widgetSettings.get("ExpandWidgetTimeoutType"),i=1==e?"_purechatSessionStart":"_purechatPageStart",n=new Date-o.default.BaseControllerSettings.dismissSettings.get(i),r=this.widgetSettings.get("ExpandWidgetTimeout")*o.default.MILLISECONDS_IN_SECOND,s=r-n;this.timeout=setTimeout(function(){t.triggerEvent()},s)},onStop:function(){clearTimeout(this.timeout),delete this.timeout}});e.default=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=n(o),a=i(53),l=n(a),c={};c.MILLISECONDS_IN_SECOND=1e3,c.SECONDS_IN_MINUTE=60,c.MINUTES_IN_HOUR=60,c.HOURS_IN_DAY=24,c.MILLISECONDS_IN_DAY=c.HOURS_IN_DAY*c.MINUTES_IN_HOUR*c.SECONDS_IN_MINUTE*c.MILLISECONDS_IN_SECOND,c.DISMISS_DELAYS_DAYS=[0,1,3,7,30,365],c.CHECKIN_INTERVAL_SECONDS=5,c.MAX_CHECKIN_INTERVAL_SECOND=60;var u=r.backbone.Model.extend({storageKeys:["_purechatSessionStart","_purechatLastCheckin","_purechatDismissTime","_pureChatTimeSettingsVersion","_purechatDismissCount"],defaults:{_purechatSessionStart:new Date,_purechatPageStart:new Date,_purechatLastCheckin:new Date,_purechatDismissCount:0},fetchDate:function(t){var e=window.localStorage.getItem(this.formatPropName(t));s.default.isUndefined(e)||s.default.isNaN(e)||s.default.isNull(e)||this.set(t,new Date(window.localStorage.getItem(this.formatPropName(t))))},fetchInt:function(t){var e=window.localStorage.getItem(this.formatPropName(t));s.default.isUndefined(e)||s.default.isNaN(e)||s.default.isNull(e)||this.set(t,parseInt(window.localStorage.getItem(this.formatPropName(t))),10)},formatPropName:function(t){return this.widgetId+"_"+t},fetch:function(){this.fetchDate("_purechatSessionStart"),this.fetchDate("_purechatLastCheckin"),this.fetchDate("_purechatDismissTime"),this.fetchInt("_pureChatTimeSettingsVersion"),this.fetchInt("_purechatDismissCount")},save:function(){var t=this;this.storageKeys.forEach(function(e,i){var n=t.get(e);s.default.isUndefined(n)||s.default.isNaN(n)||s.default.isNull(n)?window.localStorage.removeItem(t.formatPropName(e)):window.localStorage.setItem(t.formatPropName(e),t.get(e))})},resetTimeCounters:function(){this.set({_purechatDismissTime:null})},updateEventLoop:function(){this.set("_purechatLastCheckin",new Date),window.localStorage.setItem(this.formatPropName("_purechatLastCheckin"),this.get("_purechatLastCheckin"))},initialize:function(){s.default.bindAll(this,"updateEventLoop"),setInterval(this.updateEventLoop,c.CHECKIN_INTERVAL_SECONDS*c.MILLISECONDS_IN_SECOND)}}),h=l.default.Controller.extend({isPoppedOut:function(){return this.widgetSettings.get("isPoppedOut")},isHosted:function(){return this.widgetSettings.get("isDirectAccess")},isPersonalChat:function(){return this.widgetSettings.get("isPersonalChat")},isDemoChat:function(){return this.widgetSettings.get("isDemo")},isMobile:function(){return this.widgetSettings.get("RequestFromMobileDevice")},isWidgetAvailable:function(){return this.purechatController.chatModel.get("operatorsAvailable")},popOutAutomatically:function(){return this.widgetSettings.get("ForcePopout")||!1},initialize:function(t){var e=this;if(this.purechatController=t,this.widgetSettings=t.options,this.enabled=this.widgetSettings.get(this.enabledWidgetSettingKey)&&!this.isPoppedOut()&&!this.isHosted()&&!this.isPersonalChat()&&!this.isDemoChat()&&!this.isMobile()&&!this.popOutAutomatically(),this.enabled){s.default.bindAll(this,"onCollapse"),h.dismissSettings||(h.dismissSettings=new u,h.dismissSettings.widgetId=this.widgetSettings.get("Id"),h.dismissSettings.fetch());var i=h.dismissSettings.get("_pureChatTimeSettingsVersion"),n=this.widgetSettings.get("WidgetSettingsVersion");i&&i==n||(h.dismissSettings.resetTimeCounters(),h.dismissSettings.set("_pureChatTimeSettingsVersion",n)),this.isNewSession()&&h.dismissSettings.set("_purechatSessionStart",new Date),this.purechatController.getPublicApi().on("chatbox:collapse",this.onCollapse),e.startTesting(),h.dismissSettings.save()}},onCollapse:function(){h.dismissSettings.set("_purechatDismissCount",h.dismissSettings.get("_purechatDismissCount")+1),this.stopTesting(),h.dismissSettings.set("_purechatDismissTime",new Date),h.dismissSettings.save(),this.purechatController.getPublicApi().off("chatbox:collapse",this.onCollapse)},getDismissDelay:function(){return c.DISMISS_DELAYS_DAYS[Math.min(h.dismissSettings.get("_purechatDismissCount"),c.DISMISS_DELAYS_DAYS.length-1)]*c.MILLISECONDS_IN_DAY},isNewSession:function(){return new Date-h.dismissSettings.get("_purechatLastCheckin")>c.MAX_CHECKIN_INTERVAL_SECOND*c.MILLISECONDS_IN_SECOND},startTesting:function(){var t=h.dismissSettings.get("_purechatDismissTime"),e=this.getDismissDelay();(!t||new Date-t>e)&&(h.dismissSettings.on("change:_purechatLastCheckin",this.eventCheckChange),this.onStart&&this.onStart())},removeEventListeners:function(){h.dismissSettings.off("change:_purechatLastCheckin",this.eventCheckChange)},stopTesting:function(){this.removeEventListeners(),h.dismissSettings.resetTimeCounters(),h.dismissSettings.set("_purechatDismissTime",new Date),h.dismissSettings.save(),this.onStop&&this.onStop()},triggerEvent:function(t){var e=this;this.purechatController.getDataController().checkChatAvailable().done(function(i){i.available&&(e.removeEventListeners(),setTimeout(function(){e.purechatController.chatModel.get("expanded")||(e.stopTesting(),e.purechatController.getPublicApi().set("chatbox.expanded",!0,{expandSource:l.default.getOption(e,"expandSource")}))},t||1e3))}).fail(function(){})}});c.BaseControllerSettings=h,e.default=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(86),o=n(r),s=o.default.BaseControllerSettings.extend({expandSource:"url-trigger",enabledWidgetSettingKey:"EnableTriggerPageSpecific",initialize:function(t){o.default.BaseControllerSettings.prototype.initialize.apply(this,arguments)},onStart:function(){var t=this,e=this.widgetSettings.get("TriggerUrls"),i=this.widgetSettings.get("TriggerPageExpandTimeout"),n=window.location.href.replace("http://","").replace("https://","");e.forEach(function(e){t.testUrl(n,e)&&t.triggerEvent(i*o.default.MILLISECONDS_IN_SECOND)})},testUrl:function(t,e){return t.toLowerCase().indexOf(e.Url.toLowerCase())>=0}});e.default=s},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(89),o=n(r),s=i(91),a=n(s),l=i(92),c=n(l),u=i(93),h=n(u),d=i(94),p=n(d),g=i(95),f=n(g),m=i(96),v=n(m),b=i(97),y=n(b);e.default={PCStateActivating:o.default,PCStateChatting:a.default,PCStateClosed:c.default,PCStateEmailForm:h.default,PCStateInactive:p.default,PCStateInitializing:f.default,PCStateUnavailable:v.default,PCStateUnsupported:y.default}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=(n(o),i(53)),a=(n(s),i(90)),l=n(a),c=i(64),u=n(c),h=i(56),d=n(h),p=l.default.extend({name:"activating",stateSettings:{UiVisiblity:{}},onEnter:function(){var t=this;l.default.prototype.onEnter.apply(this,arguments);new r.backbone.Model({userName:t.getChatModel().get("visitorName")});t.options.get("isPersonalChat")&&!t.getPersonalDetailsView()&&(t.personalDetails=new u.default.PersonalChatDetails({model:t.options}),t.getWidgetView().personalDetails.show(t.personalDetails),t.setPersonalDetailsView(t.personalDetails),t.personalDetails.triggerMethod("afterInserted")),t.showConnectingWithTimeout(),t.clearConnectingTimeout(),t.getChatModel().set("state",d.default.WidgetStates.Chatting)}});e.default=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=i(4),a=r(s),l=i(53),c=n(l),u=i(56),h=n(u),d={popoutButton:!1,closeButton:!1,restartButton:!1,removeWidgetButton:!1,requeueButton:!1,leaveButton:!1,cannedResponsesButton:!1},p=2e4,g=6e5,f=[],m=c.default.Controller.extend({initialize:function(){this.stateSettings=this.stateSettings||{},this.stateSettings.UiVisiblity=this.stateSettings.UiVisiblity||{},a.defaults(this.stateSettings.UiVisiblity,d)},setChatModel:function(t){this.chatModel=t},getChatModel:function(){return this.chatModel},setWidgetView:function(t){this.widgetView=t,this.listenTo(this.widgetView,"all")},setPersonalDetailsView:function(t){this.personalDetailsView=t},getPersonalDetailsView:function(){return this.personalDetailsView},getWidgetView:function(){return this.widgetView},setWidgetSettings:function(t){this.settings=t},getWidgetSettings:function(){return this.settings},setResources:function(t){this.resources=t},getResources:function(){return this.resources},setDataController:function(t){this.dc=t},getDataController:function(){return this.dc},setViewController:function(t){this.vc=t},getViewController:function(){return this.vc},getResource:function(t,e){return this.resources.getResource(t,e)},disable:function(){this.getDataController().connectionInfo.set("disabled",!0),this.getDataController().connectionInfo.set("chatActiveInOtherWindow",!0),this.getWidgetView().$el.hide()},enable:function(){this.getDataController().connectionInfo.set("disabled",!1),this.getDataController().connectionInfo.set("chatActiveInOtherWindow",!1),this.getWidgetView().$el.show()},syncWithContact:function(){var t=o.$.Deferred(),e=this;return this.getDataController().getContactInfo().done(function(i){!i||window.pcPersonalEditorSettings&&window.pcPersonalEditorSettings.get("isInEditorMode")||(e.getChatModel().set("visitorFirstName",i.firstName),e.getChatModel().set("visitorLastName",i.lastName),e.getChatModel().set("visitorCompany",i.company),e.getChatModel().set("visitorEmail",i.email),e.getChatModel().set("visitorPhoneNumber",i.phone)),t.resolve()}),t.promise()},showConnectingWithTimeout:function(){function t(){if(this.connectingTimeout){var t=new Views.ChatConnectingView({rm:e.getResources(),model:new o.backbone.Model({}),settings:e.options});e.getWidgetView().content.show(t)}}var e=this;this.clearConnectingTimeout(),this.connectingTimeout=setTimeout(t,500);this.connectingTimeout},clearConnectingTimeout:function(){this.connectingTimeout&&(clearTimeout(this.connectingTimeout),delete this.connectingTimeout)},onEnter:function(){this.listenTo(this.getWidgetView(),"all",function(t,e){var i=this;e&&e.confirmation?i.getViewController().showConfirmationDialog(e.confirmation,e.title).done(function(){i.triggerMethod.call(i,t,e)}):this.triggerMethod.apply(this,arguments)});var t=this;if(this.stateSettings){if(this.stateSettings.UiVisiblity){var e=this.getWidgetView();for(var i in this.stateSettings.UiVisiblity)e.ui[i]&&e.ui[i].toggle(this.stateSettings.UiVisiblity[i])}var n=t.getDataController(),r=n.connectionInfo,o=this.stateSettings.shouldBeInRoom;this.chatModel.get("isOperator")||a.isUndefined(o)||(o?this.listenTo(r,"change:isInChat",function(e,i){i||t.chatModel.set("state",h.default.WidgetStates.Closed)}):this.listenTo(r,"change:isInChat",function(e,i){if(i){var n=this.getWidgetSettings(),r=n.useMobile()&&!n.isDesktopDimension();r||t.widgetView.expand(),t.chatModel.set("state",h.default.WidgetStates.Chatting)}}))}this.listenTo(this.options,"change:enableAvailabilityPolling",function(e,i){if(i)switch(t.name){case"inactive":t.startAvailabilityPolling(!0)}else!t.getChatModel().get("expanded")&&t.TestingStartedFromApi&&t.stopAvailabilityPolling()})},onExit:function(){this.clearConnectingTimeout(),this.stopListening(this.widgetView,"all"),this.stopAvailabilityPolling(!0)},clearPolling:function(){f.forEach(function(t){clearInterval(t)}),f=[]},testAvailability:function(){var t=this;t.getViewController().pageActivity||t.lastCheck&&new Date-t.lastCheck>12e4?(t.lastCheck=new Date,t.getDataController().checkChatAvailable().done(function(e){t.clearPolling(),t.checkAvailTimeout=e.available?p:g,e.available?f.push(setTimeout(function(){t.testAvailability()},t.checkAvailTimeout)):"AccountActivity"!==e.reason?f.push(setTimeout(function(){t.testAvailability()},t.checkAvailTimeout)):t.stopAvailabilityPolling(),t.getChatModel().set("operatorsAvailable",e.available)})):(t.checkAvailTimeout=p,t.clearPolling(),f.push(setTimeout(function(){t.testAvailability()},1500)))},startAvailabilityPolling:function(t){var e=this;e.clearPolling(),e.checkAvailTimeout=p,e.testAvailability(),this.TestingStatus||f.push(setTimeout(function(){e.testAvailability()},e.checkAvailTimeout)),this.TestingStatus=!0,this.TestingStartedFromApi=t||!1},stopAvailabilityPolling:function(t){this.options.get("enableAvailabilityPolling")&&"chatting"!=this.name&&"activating"!=this.name&&!t||(this.TestingStatus=!1,this.clearPolling())},onPopOutChat:function(){var t=this.getWidgetSettings(),e=this.getChatModel(),i=this.getDataController();this.getChatModel().set("poppedOut",!0),
this.disable(),i.connectionInfo.persistLocalStorage(),window.openedWindow=window.open(this.settings.get("pureServerUrl")+"/VisitorWidget/ChatWindow?widgetId="+t.get("widgetId")+"&userId="+i.connectionInfo.get("userId")+"&displayName="+i.connectionInfo.get("visitorName")+"&authToken="+i.connectionInfo.get("authToken")+"&roomId="+i.connectionInfo.get("roomId")+"&chatId="+i.connectionInfo.get("chatId")+"&origin="+encodeURIComponent(e.get("origin")),"purechatwindow","menubar=no, location=no, resizable=yes, scrollbars=no, status=no, width=480, height=640"),this.getViewController().trigger("widget:poppedOut")}});e.default=m},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){return(0,o.$)("<div/>").html(t).text()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=i(4),a=n(s),l=i(53),c=(n(l),i(90)),u=n(c),h=i(55),d=n(h),p=i(64),g=n(p),f=i(56),m=n(f),v=i(65),b=n(v),y=u.default.extend({name:"chatting",stateSettings:{shouldBeInRoom:!0,UiVisiblity:{popoutButton:!0,closeButton:!0,requeueButton:!0,cannedResponsesButton:!0}},initialize:function(){u.default.prototype.initialize.apply(this,arguments),this.typing={},this.isUserAlone=!0,this.mobileAnimationInterval=null},onEnter:function(){u.default.prototype.onEnter.apply(this,arguments);var t=this;t.getWidgetView().$el.removeClass("purechat-button-hidden"),t.options.get("isPersonalChat")&&!t.getPersonalDetailsView()&&(t.personalDetails=new g.default.PersonalChatDetails({model:t.options}),t.getWidgetView().personalDetails.show(t.personalDetails),t.setPersonalDetailsView(t.personalDetails),t.personalDetails.triggerMethod("afterInserted"));var e=(new o.backbone.Model({userName:t.getChatModel().get("visitorName")}),this.options.get("StartChatImmediately")),i=t.getChatModel();i.set({isPersonalChat:this.options.get("isPersonalChat"),RequestFromMobileDevice:this.options.get("RequestFromMobileDevice")}),t.messageView=new g.default.MessageListView({rm:this.getResources(),model:i,collection:new d.default.MessageCollectionMessagesGrouped(null,{collection:t.getChatModel().get("messages")}),settings:t.getWidgetSettings(),viewController:t.getViewController(),chatModel:t.getChatModel()}),t.getWidgetView().content.show(t.messageView),t.listenTo(t.messageView,"showPrevious",function(){if(t.chatModel.get("PreviousTranscriptId")){var e=t.getDataController().getPreviousChat({chatId:t.chatModel.get("PreviousTranscriptId")});e.done(function(e){t.appendPreviousChatResults(e)})}}),t.showConnectingWithTimeout();var n=t.options.get("RequestFromMobileDevice")&&(t.options.get("poppedOut")||t.options.get("isDirectAccess")),r=[t.getDataController().connectToChatServer(this)];if(this.options.get("room")&&1!=this.options.get("room").roomType&&!this.options.get("room").isDemo){var s=t.getDataController().getPreviousChat({chatId:this.options.get("room")?this.options.get("room").id:-1});r.push(s)}o.$.when.apply(o.$,r).done(function(r,s){s&&t.appendPreviousChatResults(s),t.clearConnectingTimeout();try{if(!t.chatModel.get("isOperator")&&("undefined"==typeof t.chatModel.get("operators")||0==t.chatModel.get("operators").length)){var l=new Date;l.setTime(0),t.chatModel.get("messages").add({date:l,type:e?"message":"note",message:t.status&&t.status.initialData&&t.status.initialData.initiator&&1==t.status.initialData.initiator?"":t.getResource("chat_startedMessage"),resourceKey:"chat_startedMessage",avatarUrl:t.options.get("isPersonalChat")?personalAvatarUrl||"/content/images/avatars/1avatar-operator-skinny.png":n?"/content/images/avatars/1avatar-operator-skinny.png":null})}a.default.isFunction(t.getDataController().setCurrentPage)&&!t.options.get("isOperator")&&t.getDataController().setCurrentPage(document.location.href),t.messageView.on("newMessage",function(e){t.getDataController().newMessage(e)}),t.listenTo(t.messageView,"typingChange",function(e){t.getDataController().setTypingIndicator(e)}),t.getWidgetView().$el.find(".purechat-start-chat-button-container button").html('Back to Chat<i style="margin-left: .5em;" class="fa fa-chevron-right"></i>'),t.getWidgetView().onShow(),t.getDataController().sendRoomHistory(),t.getViewController().trigger("stateChanged",m.default.WidgetStates.Chatting),t.settings.get("RequestFromMobileDevice")&&this.get("MobileDisplayType")===m.default.MobileDisplayTypes.MobileOptimized&&((0,o.$)(window).trigger("resize.ResizeChatContent"),t.getWidgetView().$el.find(".purechat-send-form-message").off("blur.ResizeWindow").on("blur.ResizeWindow",function(){(0,o.$)(window).trigger("resize.ResizeChatContent")}),t.options.get("isDirectAccess")&&((0,o.$)(".direct-container-header").css("display","none"),"function"==typeof resizeDirectAccessContainer&&resizeDirectAccessContainer())),t.getWidgetView().trigger("resized"),b.default.execute("poweredby:reset"),t.getViewController().trigger("chat:start",i.pick(["visitorEmail","visitorName","visitorPhoneNumber","visitorQuestion","visitorFirstName","visitorLastName","visitorCompany"]))}catch(t){console.log(t)}}).fail(function(){t.clearConnectingTimeout(),t.getDataController().connectionInfo.clearLocalStorage(),t.getChatModel().set("state",m.default.WidgetStates.Inactive)}),i.on("roomHostChanged",function(){var e=i.get("roomHostAvatarUrl"),n=i.get("roomHostName");t.getWidgetView().showRoomHostAvatar(e),t.getWidgetView().updateRoomHostName(n)})},onSelectionShow:function(){this.messageView.updateScroll()},appendPreviousChatResults:function(t,e){var i=this;t&&t.forEach(function(t){var n=null,r=null,o=0;if(t.Records.forEach(function(t){function s(){1==t.Type?i.onJoined(t.UserId,t.Name,-1,t.Name,t.DateCreatedJsTicks/1e3,!0,!0):2==t.Type?i.onLeft(t.UserId,t.Name,-1,t.Name,t.DateCreatedJsTicks/1e3,!0,!0):i.onMessage(t.UserId,t.Name,-1,t.Name,t.DateCreatedJsTicks/1e3,t.Message,!0,0,0,t.AvatarUrl,t.UserId>0,0,0,!0)}e?(setTimeout(s,o),o+=e):s(),n=t.DateCreatedString+" at "+t.TimeCreatedString,r=t}),null!=n){var s=function(){a=i.convertToUserTime(a),i.chatModel.get("messages").add({date:a,type:"separator",message:n,isClosedChat:!0})},a=new Date;a.setTime(r.DateCreatedJsTicks),e?(setTimeout(s,o),o+=e):s()}i.chatModel.set("PreviousTranscriptId",t.Id),t.PreviousTranscriptId?i.chatModel.set("HasMoreTransactions",!0):i.chatModel.set("HasMoreTransactions",!1)})},onExit:function(){u.default.prototype.onExit.apply(this,arguments),this.chatModel.get("operators").reset(),this.chatModel.get("participants").reset(),this.unbindEvents&&this.unbindEvents(),this.getDataController().unbindHandlerEvents()},onRoomChanged:function(t){this.onRoomDetailsChanged(t.room)},onCloseChat:a.default.throttle(function(t){var e=this,i=function(t){t.getDataController().closeChat().done(function(){t.getChatModel().set("state",m.default.WidgetStates.Closed)}).fail(function(){alert("fail")})},n=this.getWidgetSettings(),r=n.useMobile()&&!n.isDesktopDimension(),o="Are you sure you want to end this chat?",s=function(){setTimeout(function(){confirm(o)&&i(e)},500)};r?s():i(e)},800,{trailing:!1}),onExpanded:function(){},flashMobileNotificationIcon:function(){var t=this;if(this.settings.get("RequestFromMobileDevice")&&this.settings.get("MobileDisplayType")===m.default.MobileDisplayTypes.MobileOptimized&&"number"!=typeof this.mobileAnimationInterval){var e=this.getWidgetView().$el,i=e.hasClass("purechat-widget-collapsed")&&e.find(".purechat-expanded").is(":visible")?e:[];if(i.length>0){var n=e.find(".purechat-title-image-out-of-way-hilight").filter(":visible");n.addClass("flash");var r=!0;this.mobileAnimationInterval=setInterval(function(){r?(n.removeClass("flash"),r=!1):(n.addClass("flash"),r=!0)},1e3),i.off("click.StopNotification").on("click.StopNotification",function(e){var r=(0,o.$)(e.currentTarget);t.mobileAnimationInterval=clearInterval(t.mobileAnimationInterval),n.removeClass("flash"),i.off("click.StopNotification"),r.trigger("click")})}}},convertToUserTime:function(t){if("undefined"!=typeof CurrentUser&&null!==CurrentUser){var e=CurrentUser.get("isInDaylightSavings"),i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds());t=new Date(i.getTime()+6e4*(CurrentUser.get("accountUtcOffset")+(e?60:0)))}return t},onMessage:function(t,e,i,n,r,s,l,c,u,h,d,p,g,f){this.settings.get("avatarUrl");if(this.chatModel.get("isOperator")&&t!=this.chatModel.get("userId")&&notifier.notify("New message!"),null!==s&&"string"==typeof s){var m=new Date;m.setTime(1e3*r),m=this.convertToUserTime(m),this.chatModel.get("messages").add({date:m,type:"message",message:s,userName:e,myMessage:t==this.chatModel.get("userId"),time:m.toHourMinuteString(),avatarUrl:h,fromOperator:d,visitorAvatarUrl:this.settings.get("room")&&this.settings.get("room").visitorAvatarUrl?this.settings.get("room").visitorGravatarHash:"",rootUrl:this.chatModel.get("cdnServerUrl"),userId:t,messageId:g,isClosedChat:f}),t==this.chatModel.get("userId")||l||b.default.execute("notifications:newMessage")}var v=this.getWidgetSettings(),y=v.useMobile()&&!v.isDesktopDimension(),_=this.chatModel.get("expanded");if(this.chatModel.get("userId")==t||0!=this.chatModel.get("isOperator")||1!=this.chatModel.get("isWidget")||(_||y)&&!y||0!=l||this.getWidgetView().flashNotification(s),_||this.getWidgetView().incrementMissedMessageCount(),this.isUserAlone&&!this.chatModel.get("isOperator")&&!l&&s!=this.chatModel.get("Question")&&!this.chatModel.get("noOperatorMessageSeen")){var m=new Date;m.setTime(1e3*r+1),m=this.convertToUserTime(m),this.chatModel.get("messages").add({date:m,type:"note",message:a.default.escape(this.getResource("chat_noOperatorMessage")),resourceKey:"chat_noOperatorMessage",isClosedChat:f}),this.chatModel.set("noOperatorMessageSeen",!0)}(0,o.$)("body").trigger("ChatMessageAdded"),this.flashMobileNotificationIcon()},onTyping:function(t,e,i,n,r,o){this.messageView.typing(t,e,r)},onRoomClosed:function(t){this.options.get("isOperator")||localStorage.roomId||this.getDataController().connectionInfo.get("roomId")!=t||this.onCloseChat(!0)},onRoomDestroyed:function(t,e,i,n){this.chatModel.set("closedReasonCode",n),4==n?this.chatModel.set("state",m.default.WidgetStates.EmailForm):this.chatModel.set("state",m.default.WidgetStates.Closed)},onUserDestroyed:function(){this.chatModel.set("state",m.default.WidgetStates.Closed)},onRoomDetailsChanged:function(t){this.chatModel.set({roomHostAvatarUrl:t.roomHostAvatarUrl||null,roomHostName:t.roomHostName||null,visitorEmail:t.visitorEmail||this.chatModel.get("visitorEmail"),visitorName:t.visitorName||this.chatModel.get("visitorName"),visitorPhoneNumber:t.visitorPhoneNumber||this.chatModel.get("visitorPhoneNumber"),visitorFirstName:t.visitorFirstName||this.chatModel.get("visitorFirstName"),visitorLastName:t.visitorLastName||this.chatModel.get("visitorLastName"),visitorCompany:t.visitorCompany||this.chatModel.get("visitorCompany")}),this.getViewController().triggerRoomChangedForApi()},onJoined:function(t,e,i,n,s,l,c){if(this.chatModel.get("isOperator")||t!=this.chatModel.get("userId")){var u=new Date;u.setTime(1e3*s),u=this.convertToUserTime(u),this.chatModel.get("messages").add({date:u,type:"note",important:!0,message:r(a.default.escape(this.getResource("chat_joinMessage",{displayName:o.$.trim(e)}))),username:e,resourceKey:"chat_joinMessage",time:u.toHourMinuteString(),isClosedChat:c})}t!=this.chatModel.get("userId")&&(this.isUserAlone=!1,this.chatModel.get("operators").add({userDisplayName:e,userId:t}),this.chatModel.get("operators").length>0?this.chatModel.get("isOperator")||(this.getWidgetView().setExpandedTitle(r(this.getResource("chat_nowChattingWith",{chatUserNames:this.chatModel.chatUserNames()})),"chat_nowChattingWith"),this.getWidgetView().setCollapsedTitle(r(this.getResource("mobile_expandButton")),"mobile_expandButton")):this.isUserAlone=!0)},onLeft:function(t,e,i,n,s,a,l){if(this.chatModel.get("isOperator")||t!=this.chatModel.get("userId")){var c=new Date;c.setTime(1e3*s),c=this.convertToUserTime(c),this.chatModel.get("messages").add({date:c,type:"note",message:this.getResource("chat_leftMessage",{displayName:o.$.trim(e)}),resourceKey:"chat_leftMessage",time:c.toHourMinuteString(),isClosedChat:l})}if(t!=this.chatModel.get("userId"))if(this.chatModel.get("operators").remove(t),!this.chatModel.get("isOperator")&&this.chatModel.chatUserNames().length>0)this.getWidgetView().setTitle(r(this.getResource("chat_nowChattingWith",{chatUserNames:this.chatModel.chatUserNames()})),"chat_nowChattingWith");else{var u=this.getWidgetSettings(),h=u.useMobile()&&!u.isDesktopDimension(),d=h?"mobile_expandButton":"title_initial";this.getWidgetView().setTitle(r(this.getResource(d)),d)}}});b.default.commands.setHandler("roomclosed",function(t){"undefined"!=typeof window._pcwi&&window._pcwi.state.triggerMethod("roomClosed",t)}),e.default=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=n(o),a=i(53),l=n(a),c=i(90),u=n(c),h=i(55),d=n(h),p=i(64),g=n(p),f=i(57),m=n(f),v=i(56),b=n(v),y=i(65),_=n(y),w=u.default.extend({name:"closed",stateSettings:{shouldBeInRoom:!1,UiVisiblity:{restartButton:!0,removeWidgetButton:!0}},handleRoomClose:function(t,e){var i=this,n="undefined"!=typeof t&&null!==t&&"string"==typeof t.visitorIPAddress?t.visitorIPAddress:"",o="undefined"!=typeof t&&null!==t&&t.Id?t.Id:-1,a="undefined"!=typeof e&&null!==e&&"string"==typeof e.name?e.name:"",c="undefined"!=typeof e&&null!==e&&"string"===e.visitorReferer?e.visitorReferer:"",u="undefined"!=typeof e&&null!==e&&"undefined"!=typeof e.id?e.id:"";i.options.get("isOperator")&&e.roomType&&e.roomType==PureChat.enums.roomType.visitor&&r.$.ajax({url:"/ExternalApps",type:"GET",data:{chatId:i.getDataController().connectionInfo.get("roomId")}}).done(function(t){var e=(0,r.$)(i.getWidgetView().el);s.default.each(t,function(t,i){e.find("#export-"+i).toggle(t)})}),i.getWidgetView().$el.removeClass("purechat-button-hidden"),localStorage.expanded=!1,i.getDataController().connectionInfo.set("chatClosed",!0),i.getDataController().connectionInfo.persistLocalStorage(),i.getWidgetView().setExpandedTitle(i.getResource("title_chatClosed"),"title_chatClosed"),i.getWidgetView().setCollapsedTitle(i.getResource("mobile_expandButton"),"mobile_expandButton"),i.getWidgetView().onShow();var h=new r.backbone.Model({isOperator:i.chatModel.get("isOperator"),roomId:u,visitorIPAddress:n,visitorIPAddressId:o,visitorName:a,visitorReferrer:c,closedReasonCode:i.chatModel.get("closedReasonCode")});i.chatModel.get("isOperator")?h.set({GoogId:"",GaTrackingTab:!1,GaTrackingChat:!1,GaTrackingThumbs:!1,GAUpThumbEvent:!1,GADownThumbEvent:!1,GAEventCategory:!1,UsingGa:!1}):h.set({GoogId:i.getWidgetSettings().get("GoogId"),GaTrackingTab:i.getWidgetSettings().get("GaTrackingTab"),GaTrackingChat:i.getWidgetSettings().get("GaTrackingChat"),GaTrackingThumbs:i.getWidgetSettings().get("GaTrackingThumbs"),GAUpThumbEvent:i.getWidgetSettings().get("GAUpThumbEvent"),GADownThumbEvent:i.getWidgetSettings().get("GADownThumbEvent"),GAEventCategory:i.getWidgetSettings().get("GAEventCategory"),UsingGa:i.getWidgetSettings().get("UsingGa"),AskForRating:i.getWidgetSettings().get("AskForRating"),CtaButton:i.getWidgetSettings().get("CtaButton"),DownloadTranscript:i.getWidgetSettings().get("DownloadTranscript")});var p={rm:i.getResources(),model:h,settings:i.options,chatModel:i.chatModel};this._initialCollection=l.default.getOption(i,"chatModel").get("messages"),this._proxyCollection=new r.backbone.Collection,this.collection=new d.default.MessageCollectionMessagesGrouped(null,{collection:this._proxyCollection}),p.collection=this.collection;var f=i.options.get("isOperator");this.closeMessage=f?new g.default.ClosedOperatorView(p):new g.default.ClosedMessage(p),i.listenTo(this.closeMessage,"chat:rated",function(t){i.getDataController().rateChat(t),t?m.default.GaEvent(i.getWidgetSettings(),"GaTrackingThumbs","GAUpThumbEvent"):m.default.GaEvent(i.getWidgetSettings(),"GaTrackingThumbs","GADownThumbEvent"),i.getViewController().triggerResizedEvent(),i.getViewController().trigger("chat:rate",{rating:t})}),i.getWidgetView().content.show(this.closeMessage),f&&this._initialCollection.forEach(function(t){i._proxyCollection.add(t)}),i.getWidgetView().hideRoomHostAvatar(),i.chatModel.set({roomHostAvatarUrl:null,roomHostName:null}),i.options.get("isDirectAccess")&&((0,r.$)(".direct-container-header").css("display","block"),"function"==typeof resizeDirectAccessContainer&&resizeDirectAccessContainer()),_.default.execute("poweredby:update","Love chatting? Add <a "+(i.options.get("isPersonalChat")?"":'style="font-size: 1em !important;"')+' href="https://purechat.com" target="_blank">Pure Chat</a> to your site for free!'),s.default.isFunction(i.getDataController().unbindHandlerEvents)&&i.getDataController().unbindHandlerEvents(),i.getViewController().trigger("chat:end",i.chatModel.pick(["visitorEmail","visitorName","visitorPhoneNumber","visitorQuestion","visitorFirstName","visitorLastName","visitorCompany"]))},onSelectionShow:function(){this.closeMessage.updateScroll()},onEnter:function(){u.default.prototype.onEnter.apply(this,arguments);var t=this,e=this.options.get("room")||{};t.getWidgetView().chatAutoStarted=!1,t.options.get("isPersonalChat")&&!t.getPersonalDetailsView()&&(t.getWidgetView().$el.find(".purechat-start-chat-button-container button").html('Back to Chat<i style="margin-left: .5em;" class="fa fa-chevron-right"></i>'),t.personalDetails=new g.default.PersonalChatDetails({model:t.options}),t.getWidgetView().personalDetails.show(t.personalDetails),t.setPersonalDetailsView(t.personalDetails),t.personalDetails.triggerMethod("afterInserted")),t.chatModel.get("isOperator")?isNaN(parseInt(e.id))?t.handleRoomClose(null,e):r.$.ajax({type:"get",dataType:"json",url:"/api/Widgets/GetVisitorIPAddress/"+(e.id||-1)}).done(function(i){t.handleRoomClose(i,e)}):t.handleRoomClose(null,null)},onExport:function(t){var e={};e.chatId=this.options.get("room").id,e.visitorEmail=this.options.get("room").visitorEmail,e.visitorName=this.options.get("room").visitorName,pcDashboard.execute("export:"+t.app,e)},onRestartChat:function(){var t=this,e=this.getDataController().checkInRoom();localStorage.expanded=!0,this.syncWithContact().done(function(){e?this.getChatModel().set("state",b.default.WidgetStates.Activating):t.getDataController().restartChat().done(function(){t.getChatModel().restartChat(),t.getViewController().resetVisitorQuestion(),t.getViewController().trigger("widget:restart")}).fail(function(){})})}});e.default=w},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=(n(o),i(53)),a=(n(s),i(90)),l=n(a),c=i(55),u=(n(c),i(64)),h=n(u),d=i(56),p=(n(d),i(65)),g=n(p),f=l.default.extend({name:"emailForm",initialize:function(){l.default.prototype.initialize.apply(this,arguments)},UiVisibility:{popoutButton:!0,closeButton:!0,requeueButton:!0},buildInitialQuestionFromMessageList:function(){var t=this.chatModel.get("userId"),e=this.chatModel.get("messages").filter(function(e){return e.get("userId")==t}),i="";return e.forEach(function(t){0==i.length?i=t.get("message"):i+=" "+t.get("message")}),i},onEnter:function(){var t=this.buildInitialQuestionFromMessageList();l.default.prototype.onEnter.apply(this,arguments);var e=this,i=this.getWidgetView();e.getDataController().connectionInfo.set("chatClosed",!0),e.getDataController().connectionInfo.persistLocalStorage(),e.getWidgetView().setTitle(e.getResource("title_emailForm"),"title_emailForm");var n=new r.backbone.Model({UnavailableAskForPhone:e.settings.get("UnavailableAskForPhone"),EmailForm:!0,InitialVisitorName:e.getViewController().getChatModel().get("visitorName")||"",InitialVisitorFirstName:e.getViewController().getChatModel().get("visitorFirstName")||"",InitialVisitorLastName:e.getViewController().getChatModel().get("visitorLastName")||"",InitialVisitorCompany:e.getViewController().getChatModel().get("visitorCompany")||"",InitialVisitorEmail:e.getViewController().getChatModel().get("visitorEmail")||"",InitialVisitorQuestion:t||e.getViewController().getChatModel().get("visitorQuestion")||"",InitialVisitorPhoneNumber:e.getViewController().getChatModel().get("visitorPhoneNumber")||""});n.on("formSubmit",function(t){var i=(0,r.$)(e.getWidgetView().el).find(".purechat-form.purechat-email-form");g.default.execute("spinner:show",i),e.getDataController().submitEmailForm(t).done(function(r){if(r.success){var o=new h.default.EmailSent({rm:e.getResources(),model:n});e.getWidgetView().content.show(o),e.getWidgetView().ui.restartButton.show(),e.getWidgetView().$el.find(".purechat-btn-restart").on("click.RestartChat",function(t){e.restartChat.call(e,t)}),e.getViewController().trigger("email:send",t)}else i.find(".purechat-email-error").css({display:"block"})}).fail(function(){}).always(function(){g.default.execute("spinner:hide",i)})});var o=e.options.get("isDemo"),s="PCStateEmailForm"!==e.options.get("requestedState");e.options.fromMissed=s&&!o;var a=new h.default.EmailForm({viewController:e.getViewController(),rm:e.getResources(),settings:e.options,chatModel:e.chatModel,model:n});i.content.show(a),i.onShow()},onExpanded:function(){this.getWidgetView().setTitle(this.getResource("title_emailForm"),"title_emailForm")},onCollapsed:function(){var t=this.getWidgetSettings(),e=t.useMobile()&&!t.isDesktopDimension(),i=e?"mobile_expandButton":"title_initial";this.getWidgetView().setTitle(this.getResource(i))},restartChat:function(t){t.stopPropagation();var e=(0,r.$)(t.currentTarget),i=this;e.off("click.RestartChat"),i.getDataController().restartChat().done(function(){i.getChatModel().restartChat(),i.getViewController().resetVisitorQuestion(),i.getViewController().trigger("widget:restart")}).fail(function(){throw new Error("Failed to send email. Please try again!")})},onExit:function(){l.default.prototype.onExit.apply(this,arguments),this.unbindEvents&&this.unbindEvents()}});e.default=f},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=(n(o),i(53)),a=(n(s),i(90)),l=n(a),c=i(55),u=(n(c),i(64)),h=n(u),d=i(56),p=n(d),g=i(65),f=n(g),m=null,v=l.default.extend({name:"inactive",stateSettings:{shouldBeInRoom:!1,UiVisiblity:{}},onEnter:function(){l.default.prototype.onEnter.apply(this,arguments);var t=m=this,e=(t.getWidgetSettings(),function(e){var i=t.getViewController().getChatModel();t.getWidgetView().$el.find(".purechat-start-chat-button-container button").html("Start Chat"),e.available||"WidgetDisabled"!=e.reason&&"ChatQuotaExceeded"!=e.reason&&"IpIsbanned"!=e.reason||t.getWidgetSettings().set("UnavailableBehavior",1),t.options.get("isPersonalChat")&&!t.getPersonalDetailsView()&&(t.personalDetails=new h.default.PersonalChatDetails({model:t.options}),t.getWidgetView().personalDetails.show(t.personalDetails),t.setPersonalDetailsView(t.personalDetails),t.personalDetails.triggerMethod("afterInserted")),i.set("operatorsAvailable",e.available);var n=t.options.get("isDemo"),o=n&&t.options.get("requestedState")==p.default.WidgetStates.EmailForm;if(e.available){t.getWidgetView().onShow();var s=t.getWidgetSettings(),a=s.useMobile()&&!s.isDesktopDimension(),l=a?"mobile_expandButton":"title_initial";a&&!t.getWidgetView().widgetShown()?t.getWidgetView().setTitle(t.getResource(l),l):t.getWidgetView().setExpandedTitle(t.getResource(l),l);var c=new r.backbone.Model({AskForFirstName:t.getWidgetSettings().get("AskForFirstName"),AskForLastName:t.getWidgetSettings().get("AskForLastName"),AskForEmail:t.getWidgetSettings().get("AskForEmail"),AskForCompany:t.getWidgetSettings().get("AskForCompany"),AskForQuestion:t.getWidgetSettings().get("AskForQuestion"),AskForPhoneNumber:t.getWidgetSettings().get("AskForPhoneNumber"),InitialVisitorFirstName:i.get("visitorFirstName")||"",InitialVisitorLastName:i.get("visitorLastName")||"",InitialVisitorEmail:i.get("visitorEmail")||"",InitialVisitorCompany:i.get("visitorCompany")||"",InitialVisitorQuestion:i.get("visitorQuestion")||"",InitialVisitorPhoneNumber:i.get("visitorPhoneNumber")||""}),u=t.getWidgetSettings().get("StartChatImmediately")?h.default.StartChatFormAutomatically:h.default.StartChatForm;t.chatForm=new u({viewController:t.getViewController(),rm:t.getResources(),model:c,settings:t.options}),c.on("formSubmit",function(e){t.getViewController().onFormSubmitted(e)}),t.settings.browserIsUnsupported()?i.set("state",p.default.WidgetStates.Unsupported):o?i.set("state",p.default.WidgetStates.EmailForm):(t.getWidgetView().content.show(t.chatForm),t.listenTo(i,"change:operatorsAvailable",function(t,e){e||i.set("state",p.default.WidgetStates.Unavailable)}),t.listenTo(i,"change",function(t){c.set({InitialVisitorName:t.get("visitorName")||"",InitialVisitorFirstName:t.get("visitorFirstName")||"",InitialVisitorLastName:t.get("visitorLastName")||"",InitialVisitorEmail:t.get("visitorEmail")||"",InitialVisitorCompany:t.get("visitorCompany")||"",InitialVisitorQuestion:t.get("visitorQuestion")||"",InitialVisitorPhoneNumber:t.get("visitorPhoneNumber")||""})}),(t.widgetView.model.get("expanded")||0==t.getWidgetSettings().get("UnavailableBehavior"))&&(t.widgetView.model.get("expanded")&&t.getWidgetView().setTitle(t.getResource("title_initial_open"),"title_initial_open"),window._pcDisableAvailabilityPings||t.startAvailabilityPolling()),t.options.get("enableAvailabilityPolling")&&t.startAvailabilityPolling())}else o?i.set("state",p.default.WidgetStates.EmailForm):i.set("state",p.default.WidgetStates.Unavailable);f.default.execute("poweredby:reset")});t.getDataController().checkChatAvailable().done(e)},onExit:function(){l.default.prototype.onExit.apply(this,arguments),this.stopListening(this.getViewController().getChatModel())},onExpanded:function(){var t=this.getDataController().checkInRoom();t?this.getChatModel().set("state",p.default.WidgetStates.Activating):(this.getWidgetView().setExpandedTitle(this.getResource("title_initial_open"),"title_initial_open"),window._pcDisableAvailabilityPings||this.startAvailabilityPolling())},onCollapsed:function(){var t=this.getWidgetSettings(),e=t.useMobile()&&!t.isDesktopDimension(),i=e?"mobile_expandButton":"title_initial";this.getWidgetView().setTitle(this.getResource(i),i),0!=this.getWidgetSettings().get("UnavailableBehavior")&&this.stopAvailabilityPolling()},startChatAutomatically:function(){var t=r.$.Deferred(),e=this,i={visitorName:"Visitor"},n=e.getWidgetSettings();return e.getDataController().checkChatAvailable().done(function(r){e.getChatModel().set("operatorsAvailable",r.available),r.available?e.getDataController().startChat(i).done(function(r){Utils.GaEvent(n,"GaTrackingChat","GAChatEvent"),e.getWidgetView().$el.find(".purechat-init-form").find(".general-error").text("").hide(),e.status.chatInfo=r,e.status.initialData=i,e.getChatModel().set("visitorName",i.visitorName),e.getChatModel().set("visitorEmail",i.visitorEmail),e.getChatModel().set("visitorQuestion",i.visitorQuestion),e.getChatModel().set("roomId",r.get("roomId")),e.getChatModel().set("userId",r.get("userId")),e.getChatModel().set("authToken",r.get("authToken")),e.getChatModel().set("chatId",r.get("chatId")),e.getChatModel().set("state",p.default.WidgetStates.Chatting),e.getDataController().connectionInfo.persistLocalStorage(),t.resolve()}).fail(function(i){var n=e.getWidgetView();n.$el.find(".purechat-init-form").find(".general-error").text("Unable to start chat. Please try again").show(),t.reject()}).always(function(){e.submittingChat=!1}):(e.getChatModel().set("state",p.default.WidgetStates.Unavailable),t.resolve())}),t.promise()}});e.default=v},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=(i(2),i(4)),o=(n(r),i(53)),s=(n(o),i(90)),a=n(s),l=i(55),c=(n(l),i(64)),u=(n(c),i(56)),h=n(u),d=i(65),p=(n(d),a.default.extend({name:"initializing",stateSettings:{UiVisiblity:{}},onEnter:function(){var t=this;a.default.prototype.onEnter.apply(this,arguments),this.getWidgetView().setExpandedTitle(this.getResource("title_initial_open"),"title_initial_open");var e=this.getDataController().checkInRoom(),i=new RegExp("^https?://"+document.location.hostname,"i");document.referrer.match(i)||(localStorage.acquisitionSource=document.referrer),this.syncWithContact().done(function(){e?t.getChatModel().set("state",h.default.WidgetStates.Activating):t.getChatModel().set("state",h.default.WidgetStates.Inactive)})}}));e.default=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(2),o=i(4),s=(n(o),i(53)),a=(n(s),i(90)),l=n(a),c=i(55),u=(n(c),i(64)),h=n(u),d=i(56),p=n(d),g=i(57),f=n(g),m=i(65),v=n(m),b=l.default.extend({name:"unavailable",stateSettings:{shouldBeInRoom:!1},onEnter:function(){l.default.prototype.onEnter.apply(this,arguments);var t=this,e=this.settings.get("IPIsBanned")?1:t.options.get("UnavailableBehavior");t.getWidgetView().$el.find(".purechat-start-chat-button-container button").html("Start Chat");var i=this.getWidgetSettings(),n=i.useMobile()&&!i.isDesktopDimension(),o=n?"mobile_expandButton":"title_initial";if(0==e)t.getWidgetView().onHide();else if(1==e)t.getWidgetView().onShow(),t.widgetView.model.get("expanded")?t.getWidgetView().setTitle(this.getResource("title_noOperators"),"title_noOperators"):this.getWidgetView().setTitle(this.getResource(o),o),(0,r.$)(t.getWidgetView().content.el).html('<div data-resourcekey="error_noOperators" class="purechat-closedmessage-container purechat-no-operators">'+f.default.linkify(this.getResource("error_noOperators"))+"</div>"),this.options.get("isPersonalChat")&&this.options.get("isInEditorMode")&&window.pcPersonalEditor&&window.pcPersonalEditor.execute("editButton:show",(0,r.$)(t.getWidgetView().content.el).find("[data-resourcekey]"));else{t.getWidgetView().onShow(),t.widgetView.model.get("expanded")?t.settings.get("isPersonalChat")?t.getWidgetView().setTitle(this.getResource("title_noOperators"),"title_noOperators"):t.getWidgetView().setExpandedTitle(this.getResource("title_emailForm"),"title_emailForm"):n&&!t.getWidgetView().widgetShown()?this.getWidgetView().setTitle(this.getResource(o),o):this.getWidgetView().setExpandedTitle(this.getResource(o),o);var s=new r.backbone.Model({AskForFirstName:t.settings.get("AskForFirstName"),AskForLastName:t.settings.get("AskForLastName"),AskForEmail:!0,AskForCompany:t.settings.get("AskForCompany"),AskForQuestion:!0,AskForPhoneNumber:t.settings.get("AskForPhoneNumber"),EmailForm:!0,InitialVisitorFirstName:t.getViewController().getChatModel().get("visitorFirstName")||"",InitialVisitorLastName:t.getViewController().getChatModel().get("visitorLastName")||"",InitialVisitorEmail:t.getViewController().getChatModel().get("visitorEmail")||"",InitialVisitorCompany:t.getViewController().getChatModel().get("visitorCompany")||"",InitialVisitorQuestion:t.getViewController().getChatModel().get("visitorQuestion")||"",InitialVisitorPhoneNumber:t.getViewController().getChatModel().get("visitorPhoneNumber")||""});s.on("formSubmit",function(e){var i=(0,r.$)(t.getWidgetView().el).find(".purechat-form.purechat-email-form");v.default.execute("spinner:show",i),t.getDataController().submitEmailForm(e).done(function(n){if(n.success){var r=new h.default.EmailSent({rm:t.getResources(),model:s});t.getWidgetView().content.show(r),t.getWidgetView().ui.restartButton.show(),t.getWidgetView().$el.find(".purechat-btn-restart").on("click.RestartChat",function(e){t.restartChat.call(t,e)}),t.getViewController().trigger("email:send",e)}else i.find(".purechat-email-error").css({display:"block"})}).fail(function(){}).always(function(){v.default.execute("spinner:show",i)})});var a=new h.default.StartChatForm({viewController:t.getViewController(),rm:t.getResources(),model:s,settings:this.options,FormType:"email"});t.getWidgetView().content.show(a)}t.listenTo(t.getChatModel(),"change:operatorsAvailable",function(e,i){i&&t.getChatModel().set("state",p.default.WidgetStates.Inactive);
});var c=0==t.getWidgetSettings().get("UnavailableBehavior");(t.widgetView.model.get("expanded")&&!c||c&&t.getChatModel().get("operatorsAvailable")||t.options.get("enableAvailabilityPolling"))&&(window._pcDisableAvailabilityPings||t.startAvailabilityPolling())},onExpanded:function(){var t=this,e=this.getDataController().checkInRoom();if(e)this.getChatModel().set("state",p.default.WidgetStates.Activating);else{var i=this.settings.get("IPIsBanned")?1:t.options.get("UnavailableBehavior");1==i?t.getWidgetView().setTitle(this.getResource("title_noOperators"),"title_noOperators"):t.getWidgetView().setExpandedTitle(this.getResource("title_emailForm"),"title_emailForm"),window._pcDisableAvailabilityPings||this.startAvailabilityPolling()}},onCollapsed:function(){var t=this.getWidgetSettings(),e=t.useMobile()&&!t.isDesktopDimension(),i=e?"mobile_expandButton":"title_initial";this.getWidgetView().setTitle(this.getResource(i)),0!=this.getWidgetSettings().get("UnavailableBehavior")&&this.stopAvailabilityPolling()},restartChat:function(t){t.stopPropagation();var e=(0,r.$)(t.currentTarget),i=this;e.off("click.RestartChat"),i.getDataController().restartChat().done(function(){i.getChatModel().restartChat(),i.getViewController().resetVisitorQuestion(),i.getViewController().trigger("widget:restart")}).fail(function(){throw new Error("Failed to send email. Please try again!")})}});e.default=b},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=(i(2),i(4)),o=(n(r),i(53)),s=(n(o),i(90)),a=n(s),l=i(55),c=(n(l),i(64)),u=(n(c),i(56)),h=(n(u),i(65)),d=n(h),p=a.default.extend({name:"unsupported",stateSettings:{UiVisiblity:{}},onEnter:function(){var t=this;a.default.prototype.onEnter.apply(this,arguments),t.getWidgetView().content.show(new d.default.Views.UnsupportedBrowser)}});e.default=p},function(t,e,i){"use strict";function n(t,e){this.eventName=t,this.callbackFnc=e||function(){},this.applyCallback=function(t){this.callbackFnc.apply(window.vtftw,[t])}}function r(t,e,i){function r(){m.userActive(),k=clearTimeout(k),x||(k=setTimeout(s,3e5))}function s(){C=!1,m.userInactive()}function a(){document.addEventListener("keypress",r),document.addEventListener("mousemove",r),r()}function l(){v=(new Date).getTime()}function c(t){return"null"==t?void 0:null==t?void 0:t}function u(){return"lastCheckin_"+e}function h(){return"s_"+e}function d(){var t,e=Date.now();u();return t=c(localStorage.getItem(u())),!(t&&e-t>=b.sessionTimeout)}function p(){localStorage.removeItem(h())}function g(){if(C){var t,i;try{t=c(localStorage.getItem("i")),d()?i=c(localStorage.getItem(h())):p()}catch(t){}o.$.ajax({url:b.pingQueueUrl,method:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({i:t,s:i,f:m.firstLoad.toString(),pid:v,sid:e,url:y,ref:_,c:S,ai:JSON.stringify(M)}),xhrFields:{withCredentials:!0},success:function(t){if(m.firstLoad=!1,t.i){S++;var e=t.e;m.pingInterval=setTimeout(g,b.pingInterval),e&&e.length&&e.forEach(function(t){m.trigger(t.eventName,t)});try{return t.i&&localStorage.setItem("i",t.i),t.s&&localStorage.setItem(h(),t.s),localStorage.setItem(u(),Date.now()),!0}catch(t){return!1}}},error:function(){console.log("error")}})}}function f(){(w||[]).forEach(function(t){m.on.apply(m,t)})}var m=this;m.firstLoad=!0;var v,b=t,e=e,y=document.location.href,_=document.referrer||"Direct",w=i,C=!0,x=!1,k=null,M={},S=1;this.events=[],this.initialized=!1,this.userActive=function(){C=!0,m.pingInterval||(m.pingInterval=setTimeout(g,0))},this.userInactive=function(){m.pingInterval&&(m.pingInterval=clearTimeout(m.pingInterval))},this.setUserAlwaysActive=function(){x=!0,r(),m.pingInterval||setTimeout(g,0)},this.unsetUserAlwaysActive=function(){x=!1,r(),m.pingInterval||setTimeout(g,0)},this.setAdditionalInfo=function(t){for(var e in t)M[e]=t[e]},this.trigger=function(t,e){for(var i=0;i<this.events.length;i++)this.events[i].eventName==t&&this.events[i].applyCallback(e)},this.on=function(t,e){this.events.push(new n(t,e))},this.off=function(t){this.events.forEach(function(e){e.eventName==t&&(e.remove=!0)});var e=[];this.events.forEach(function(t){t.remove||e.push(t)}),this.events=e},this.init=function(){l(),f(),m.userActive(),this.initialized=!0},a()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2);e.default=r},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={dashboardRootUrl:"https://app.purechat.com",apiRootUrl:"https://api.purechat.com",pingQueueUrl:"https://checkin.purechat.com/api/checkin",pidCookieName:"prodvtftwPID",pingInterval:5e3,sessionTimeout:12e5}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=(i(2),i(4)),o=(n(r),i(53)),s=n(o),a=i(65),l=n(a),c=s.default.Controller.extend({notificationSoundTimeout:null,soundIsPlaying:!1,_soundsFolder:"/content/audio/",_localStorageKey:"_purechatVisitorWidgetPlaySound",_playSound:function(t){var e=this,i=new Audio(t);i.onerror=function(){console.log(arguments)},i.onended=function(){e.soundIsPlaying=!1,i=null},this.soundIsPlaying=!0,i.play()},_playWave:function(t){this._playSound(t+this._soundsFolder+"Correct-short.wav")},_playMp3:function(t){this._playSound(t+this._soundsFolder+"Correct-short.mp3")},newMessage:function(){var t=s.default.getOption(this,"settings");if(!t.get("RequestFromMobileDevice")&&!t.get("isInEditorMode")){var e=t.get("pureServerUrl")||"https://app.purechat.com",i="true"==localStorage._purechatVisitorWidgetPlaySound.toString().toLowerCase();if(!t.get("isOperator")&&i&&"undefined"!=typeof Audio&&!this.soundIsPlaying){var n=new Audio,r=n.canPlayType("audio/wav")||n.canPlayType("audio/wave");r?this._playWave(e):this._playMp3(e)}}},initialize:function(){var t=this;localStorage[this._localStorageKey]="undefined"==typeof localStorage[this._localStorageKey]||"true"==localStorage[this._localStorageKey].toString().toLowerCase(),l.default.commands.setHandler("notifications:newMessage",function(){t.newMessage()})},onDestroy:function(){l.default.commands.removeHandler("notifications:newMessage")}});e.default=c}]);